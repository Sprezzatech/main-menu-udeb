subarch="$(archdetect)"
subarch="${subarch#*/}"
case $subarch in
	chrp|chrp_pegasos|chrp_rs6k|prep)
		kver=`uname -r | cut -d. -f1,2` # Kernel version (e.g. 2.6)

		if [ "$kver" = 2.6 ]; then
			echo "Loading AT keyboard modules..."
			modprobe -q i8042 >/dev/null 2>&1 || true
			modprobe -q atkbd >/dev/null 2>&1 || true
		fi
		
		# Always register in case the user installs 2.4 and
		# upgrades to 2.6.
		register-module i8042
		register-module atkbd
	;;
esac
