#!/bin/sh

# run for 2.2.x kernels only unless devfs and udev are not started yet
if [ "`uname -r | grep '^2.2.'`" != "" ] || \
   ( [ ! -e /.dev ] && [ ! -e /dev/.udev ] && [ ! -e /dev/.devfsd ] ); then

	echo 'Setting up Userspace DevFS: '

	if [ ! -d /proc/self ]; then
		echo '  Mounting /proc ... '
		mount /proc
	fi

	/lib/userdevfs/init-dev 

	echo '  Hard disk and partitions ... '
	/lib/userdevfs/update-dev

	echo '  Userdevfs sub-arch specific handling ...'
	/lib/userdevfs/subarch-dev

	echo 'Userdevfs done.'
fi
