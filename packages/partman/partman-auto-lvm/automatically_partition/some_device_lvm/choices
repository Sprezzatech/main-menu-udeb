#!/bin/sh

. /lib/partman/definitions.sh
. /lib/partman/auto-shared.sh
. /lib/partman/recipes.sh

# Skip if no disks detected
if [ -z "$(get_auto_disks)" ]; then
	exit 0
fi

# If there are no recipies that support LVM then don't offer auto-lvm
recipedir=$(get_recipedir)
if ! grep -q "\$lvmok" $recipedir/*; then
	exit 0
fi

db_metaget partman-auto-lvm/text/choice description
printf "lvm\t$RET\n"
