#!/bin/sh -e

# Ubuntu (all releases): casper
# Debian (squeeze): live-boot and live-config
# Debian (lenny): live-initramfs

for package in casper live-boot live-config live-initramfs; do
	if [ -f /target/var/lib/dpkg/$package.list ]; then
		in-target apt-get --yes remove --purge $package
		do_initrd=true
	fi
done

if [ $do_initrd ]; then
	in-target update-initramfs -k all -u
fi

if [ -f /target/var/lib/dpkg/debian-installer-launcher.list ]; then
	in-target apt-get --yes remove --purge debian-installer-launcher
fi

in-target apt-get --yes autoremove
