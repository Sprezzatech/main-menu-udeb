#!/bin/sh
set -e

. /usr/share/debconf/confmodule

error () {
	ERROR="$1"
	FILE="$2"
	db_subst preseed/$ERROR LOCATION "$FILE"
	db_input critical preseed/$ERROR || true
	db_go || true
	exit 1
}

db_get preseed/file
FILE="$RET"
if [ ! -e "$FILE" ] || ! cp "$FILE" /var/log/debconf-seed; then
	error retrieve_error "$FILE"
fi

if ! debconf-set-selections "/var/log/debconf-seed"; then
	error load_error "$FILE"
fi
