#!/bin/sh
set -e

. /usr/share/debconf/confmodule
. /lib/preseed/preseed.sh

usedfloppy=

# Used by preseed function.
preseed_fetch () {
	if [ "${1%/*}" = "/floppy" ]; then
		mountfloppy || true
		usedfloppy=1
	fi
	
	if [ ! -e "$1" ] || ! cp "$1" $2; then
		return 1
	else
		return 0
	fi
}
preseed_relative () {
	if [ -z "${1##/*}" ]; then
		return 1
	else	
		return 0
	fi
}

preseed preseed/file
preseed_command preseed/early_command

if [ "$usedfloppy" ]; then
	umount /floppy || true
fi
