#!/bin/sh
set -e

partitions () {
	find /dev/discs/ -follow -type b | grep /part
}

for partition in $(partitions); do
	if ! grep -q "^$partition " /proc/mounts; then
		for test in /usr/share/os-prober/*; do
			if [ -x $test ] && [ -f $test ] && \
			   $test $partition; then
			   	break
			fi
		done
	fi
done
