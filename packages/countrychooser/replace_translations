#!/bin/sh
# Edit the templates files AFTER it has been created by dh_installdebconf
# and put the short coutrny list translations there, for each language

set -e

TEMPLATES=debian/countrychooser/DEBIAN/templates
SHORTLIST=debian/short-tmp/

for i in debian/po/*po ; do
  lang=`basename $i .po`
  SHORTLIST_TRANSLATED=""
  if [ -f $SHORTLIST/$lang.short.tsl ] ; then
    for i in `cat $SHORTLIST/$lang.short.tsl | sed 's/ /_/g' | cut -f2 -d"	"` ; do
      j=`echo "${i}" | sed 's/_/ /g' | sed 's/,/\\\\\\\\,/g'`
      if [ -z "${SHORTLIST_TRANSLATED}" ] ; then
        SHORTLIST_TRANSLATED="$j"
      else
        SHORTLIST_TRANSLATED="${SHORTLIST_TRANSLATED}, ${j}"
      fi
    done
  fi
  if [ -n "${SHORTLIST_TRANSLATED}" ] ; then
    cat $TEMPLATES | sed "/^Choices-${lang}/s/\${SHORTLIST_TRANSLATED}/${SHORTLIST_TRANSLATED}/g" >$TEMPLATES.tmp
  else
    cat $TEMPLATES | sed "/^Choices-${lang}/s/\${SHORTLIST_TRANSLATED}/\${SHORTLIST}/g" >$TEMPLATES.tmp
  fi
  mv $TEMPLATES.tmp $TEMPLATES
done
