#! /bin/sh -e

HANDLERS=handlers
SPOOL="$(mktemp -d)"

trap 'rm -rf "$SPOOL"' EXIT HUP INT QUIT TERM

. kickseed.sh

ks_preseed () {
	echo "$@" >> "$SPOOL/test-output"
}

ks_run_script () {
	echo "Would run $1 script $3 using interpreter $2:"
	cat "$3"
	echo
}

RET=0
(kickseed "$1") || RET=$?

sort "$SPOOL/test-output"

echo
# TODO: sort numerically
for script in "$SPOOL/post"/*.script; do
	ks_run_script post /bin/sh "$script"
done

exit $RET
