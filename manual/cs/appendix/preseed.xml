<?xml version="1.0" encoding="ISO-8859-2"?>
<!-- $Id$ -->
<!-- original version: 36269 -->

<!--
Be carefull with the format of this file as it is parsed to generate
the example preconfiguration file.
In that file all text between <informalexample> tags that have the
attribute 'role="example"' set is included, except if a 'condition'
attribute is in force that does not match the specified release or if an
'arch' attribute is in force that does not match the specified architecture.

Currently only a single variant of the example file is generated (for i386).
-->

<appendix id="appendix-preseed">
<title>Automatizování instalací pomocí pøednastavení</title>

<para>

Tento dodatek vysvìtluje taje a záludnosti pøednastavení odpovìdí na
otázky &d-i;u za úèelem zautomatizování instalaèního procesu.

</para><para>

Útr¾ky konfigurace pou¾ité v této èásti jsou také dostupné jako
samostatný soubor na &urlset-example-preseed;.

</para>

 <sect1 id="preseed-intro">
 <title>Úvod</title>
<para>

Pøednastavení nabízí mo¾nost pøedem odpovìdìt na otázky, které se ptá
instalaèní program. Díky tomu pak nemusíte do vìt¹iny instalací
zasahovat a dokonce mù¾ete vyu¾ít nìkterých vlastností, které jinak
nejsou dostupné.

</para>

  <sect2 id="preseed-methods">
  <title>Zpùsoby pøednastavení</title>
<para>

Pøednastavení existuje ve tøech variantách:
<firstterm>initrd</firstterm>, <firstterm>soubor</firstterm>
a <firstterm>sí»</firstterm>. Initrd funguje s ka¾dým typem instalace,
podporuje pøednastavení více odpovìdí, ov¹em vy¾aduje nejvíce pøíprav.
Pøednastavení pøes lokální soubor nebo pøes sí» se pou¾ívají pro rùzné
typy instalací a oproti initrd neumí pøednastavit nìkolik prvních
otázek, proto¾e ty jsou zobrazeny døíve, ne¾ je pøednastavení naèteno.

</para><para>

Následující tabulka ukazuje, které zpùsoby pøednastavení fungují
s kterými zpùsoby instalací.

<informaltable>
<tgroup cols="4">
<thead>
<row>
  <entry>Zpùsob instalace</entry>
  <entry>initrd</entry>
  <entry>soubor</entry>
  <entry>sí»</entry>
</row>
</thead>

<tbody>
<row>
  <entry>CD/DVD</entry>
  <entry>ano</entry>
  <entry>ano</entry>
  <entry>ne</entry>
</row><row>
  <entry>zavedení ze sítì</entry>
  <entry>ano</entry>
  <entry>ne</entry>
  <entry>ano</entry>
</row><row>
  <entry>z pevného disku <phrase condition="bootable-usb">(vèetnì usb klíèenky)</phrase></entry>
  <entry>ano</entry>
  <entry>ano</entry>
  <entry>ne</entry>
</row><row condition="supports-floppy-boot">
  <entry>z disket (cd ovladaèe)</entry>
  <entry>ano</entry>
  <entry>ano</entry>
  <entry>ne</entry>
</row><row condition="supports-floppy-boot">
  <entry>z disket (sí»ové ovladaèe)</entry>
  <entry>ano</entry>
  <entry>ne</entry>
  <entry>ano</entry>
</row><row arch="s390">
  <entry>obecná/páska</entry>
  <entry>ano</entry>
  <entry>ne</entry>
  <entry>ano</entry>
</row>
</tbody>

</tgroup></informaltable>

</para><para>

U jednotlivých zpùsobù pøednastavení je významný okam¾ik, kdy je
soubor nahrán a zpracován. Pro initrd to je okam¾itì po startu
instalace, je¹tì pøed první otázkou. Pøednastavení v lokálním souboru
se naète po pøipojení CD nebo jeho obrazu. Pøednastavení ze sítì je
evidentnì dostupné a¾ po nastavení sítì.

</para><para>

Prakticky to znamená, ¾e pøednastavení pomocí souboru a sítì se
nahraje zobrazí a¾ po zodpovìzení otázek ohlednì jazyka, zemì
a klávesnice. (V pøípadì pøednastavení ze sítì navíc a¾ po v¹ech
otázkách týkajících se sí»ového nastavení.) Instalujete-li se støední
nebo nízkou prioritou, do cesty se vám pøipletou je¹tì otázky ohlednì
rozpoznávání hardwaru.

</para><para>

Abyste mohli pøednastavit i otázky, které se zobrazují pøed nahráním
souboru s pøednastavením, mù¾ete vyu¾ít zavádìcí parametry jádra, viz
èást <xref linkend="preseed-bootparms"/>.

</para>
  </sect2>

  <sect2 id="preseed-limitations">
  <title>Omezení</title>
<para>

Pøesto¾e takto mù¾ete pøednastavit vìt¹inu otázek &d-i;u, existuje
nìkolik výjimek. Pøi dìlení disku musíte rozdìlit buï celý disk, nebo
pou¾ít stávající volné místo &mdash; není mo¾né pou¾ít existující
oblasti. Také nemù¾ete pøednastavit vytváøení RAID polí.

</para>
  </sect2>

<!-- Joeyh feels this is too technical, so leave it out for now
  <sect2 id="preseed-debconf">
  <title>Základy debconfu</title>
<para>

Pøednastavení vyu¾ívá mo¾ností <classname>debconf</classname>u, co¾ je
v Debianu preferovaný zpùsob interakce balíkù s u¾ivatelem a tvoøí
jádro instalaèního systému. V <classname>debconf</classname>u jsou
otázky a dialogy zalo¾eny na <firstterm>¹ablonách</firstterm>. Pro
rùzné typu otázek existují rùzné typy ¹ablon. Samotné otázky se
<quote>generují</quote> z ¹ablon pøímo za bìhu a nìkolik otázek mù¾e
sdílet stejnou ¹ablonu.

</para><para>

Pro pøednastavení jsou relevantní následující typy ¹ablon.

</para>

<itemizedlist>
<listitem><para>
  string: umo¾òuje u¾ivateli zadat libovolnou hodnotu
</para></listitem>
<listitem><para>
  password: podobné jako string, ov¹em zadaná hodnota se nezobrazuje
</para></listitem>
<listitem><para>
  boolean: pro typ otázek ano/ne nebo pravda/nepravda
</para></listitem>
<listitem><para>
  select: umo¾òuje u¾ivateli vybrat hodnotu ze seznamu
</para></listitem>
<listitem><para>
  multiselect: umo¾òuje u¾ivateli vybrat ze seznamu více hodnot
</para></listitem>
<listitem><para>
  note: pou¾ívá se pro zobrazení nìjaké zprávy
</para></listitem>
</itemizedlist>

<para>

V &d-i;u jsou ¹ablony ulo¾eny v èitelném souboru
<filename>/var/cache/debconf/templates.dat</filename>. Tento soubor
obsahuje pùvodní text a v¹echny pøeklady. Volitelnì té¾ mù¾e obsahovat
výchozí hodnotu ¹ablony. Text mù¾e obsahovat promìnné, které se za
bìhu nahradí pøíslu¹nou hodnotou.

</para><para>

Dal¹ím èitelným souborem je
<filename>/var/cache/debconf/questions.dat</filename>, který se
pou¾ívá pro ulo¾ení hodnot promìnných a zadaných odpovìdí. Otázka se
v¾dy odkazuje na ¹ablonu, která se pou¾ívá pro dotaz. Ze zøejmých
bezpeènostních dùvodù se odpovìdi na ¹ablony typu
<quote>password</quote> ukládají do samostatného souboru (ve stejném
adresáøi), který ov¹em mù¾e èíst pouze u¾ivatel root.

</para>
  </sect2>
-->

  <sect2 id="preseed-hooks">
  <title>Spou¹tìní vlastních pøíkazù bìhem instalace</title>
<para>

Nástroje pro pøednastavení nabízí velice mocnou vlastnost, kterou je
mo¾nost spou¹tìní libovolných pøíkazù nebo skriptù v urèitých bodech
instalace. Podrobnosti naleznete v <xref linkend="preseed-shell"/>.

</para>

<itemizedlist>
<listitem><para>
  <userinput>preseed/early_command</userinput>: spustí se okam¾itì po
  naètení souboru s pøednastavením
</para></listitem>
<listitem><para>
  <userinput>preseed/late_command</userinput>: spustí se na závìr
  instalace tìsnì pøed restartem, ale je¹tì pøed odpojením souborového
  systému <filename>/target</filename>
</para></listitem>
</itemizedlist>

  </sect2>

  <sect2 id="preseed-seenflag">
  <title>Pou¾ití pøednastavení pro zmìnu výchozích hodnot</title>
<para>

Pomocí pøednastavení mù¾ete dosáhnout i toho, ¾e se otázka normálnì
zobrazí, ale zmìní se její výchozí odpovìï. (Napøíklad na úvodní
otázce ohlednì jazyka mù¾ete pøednastavit místo angliètiny èe¹tinu,
tak¾e u¾ivateli staèí stisknout &enterkey;, ale stále mu necháváte
mo¾nost volby jiného jazyka.) Dosáhnete toho tak, ¾e po nastavení
promìnné zmìníte pøíznak <firstterm>seen</firstterm> na hodnotu
<quote>false</quote>.

</para>

<informalexample><screen>
d-i foo/bar string hodnota
d-i foo/bar seen false
</screen></informalexample>

  </sect2>
 </sect1>

 <sect1 id="preseed-using">
 <title>Pou¾ití</title>
<para>

Nejprve samozøejmì musíte vytvoøit soubor s pøednastavením a umístit
jej na vhodné místo, odkud jej budete pou¾ívat. O vytvoøení souboru se
doètete dále v této pøíruèce. Umístìní souboru na vhodné místo je
rùznì slo¾ité podle pou¾itého zpùsobu. V pøípadì, ¾e budete soubor
s pøednastavením naèítat ze sítì, z diskety nebo usb klíèenky, je jeho
umístìní zøejmé. Chcete-li soubor umístit na CD nebo DVD, budete muset
znovu sestavit celý ISO obraz. Umístìní souboru s pøednastavením pøímo
do initrd je mimo rozsah tohoto dokumentu a musíme vás odkázat na
vývojáøskou dokumentaci k &d-i;

</para><para>

Ukázkový soubor s pøednastavením, je¾ mù¾ete vyu¾ít jako základ pro
své pokusy, naleznete na &urlset-example-preseed;. Tento soubor je
poskládán z ukázek prezentovaných v tomto dodatku.

</para>

  <sect2 id="preseed-loading">
  <title>Nahrání souboru s pøednastavením</title>
<para>

Pou¾íváte-li pøednastavení z initrd, musíte zajistit, aby se soubor
jmenoval <filename>preseed.cfg</filename> a aby se nacházel
v koøenovém adresáøi initrd. O v¹e ostatní se postará instalaèní
program. Ten se podívá, zda je soubor pøítomen, a pokud ano, tak jej
nahraje.

</para><para>

U zbývajících zpùsobù pøednastavení musíte instalátoru øíci, který
soubor má pou¾ít. Toho dosáhnete parametrem, který pøedáte jádru buï
ruènì pøi zavádìní, nebo skrze soubor zavadìèe
(napø. <filename>syslinux.cfg</filename>), kde na konec øádku append
pøidáte pøíslu¹né parametry.

</para><para>

Pokud to vá¹ zavadìè umo¾òuje, nemusí být od vìci jej nastavit tak,
aby neèekal se zavedením instalaèního systému na stisk klávesy
&enterkey;, ale aby dále pokraèoval automaticky. V pøípadì syslinuxu to
znamená nastavit v souboru <filename>syslinux.cfg</filename> parametr
<userinput>timeout</userinput> na hodnotu <userinput>1</userinput>.

</para><para>

Abyste mìli jistotu, ¾e instalátor dostane správný soubor, mù¾ete
zadat jeho kontrolní souèet. V souèasnosti to musí být md5 souèet.
Pokud zadaný souèet a vypoèítaný souèet souboru nebudou souhlasit,
instalátor odmítne tento soubor pou¾ít.

</para>

<informalexample><screen>
Zavádìcí parametry:
- pro zavádìní ze sítì:
  preseed/url=http://host/path/to/preseed.cfg
  preseed/url/checksum=5da499872becccfeda2c4872f9171c3d

- pro zavádìní z upraveného CD:
  preseed/file=/cdrom/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d

- pro zavádìní z USB média (soubor s pøednastavením je
  v koøenovém adresáøi USB média):
  preseed/file=/hd-media/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d
</screen></informalexample>

<para>

Kdy¾ u¾ upravujete soubor zavadìèe, pøidejte na stejné místo
i parametr <userinput>debconf/priority=critical</userinput>, který
odchytí vìt¹inu pøípadných otázek, které zde zapomenete nastavit.

</para>
  </sect2>

  <sect2 id="preseed-dhcp">
  <title>Pou¾ití DHCP serveru pro urèení souboru s pøednastavením</title>
<para>

Jeliko¾ DHCP umí pøedávat jméno souboru, je mo¾né toho zneu¾ít pro
urèení souboru s pøednastavením. Obvykle se toti¾ tato mo¾nost pou¾ívá
pro urèení souboru, kterým se zavede systém ze sítì. Pokud ale bude
soubor ve formì URL, instalace to rozpozná a pokusí se soubor stáhnout
a pou¾ít jako soubor s pøednastavením. Následující pøíkaz ukazuje, jak
upravit konfiguraèní soubor <filename>dhcpd.conf</filename> serveru
ISC DHCP verze 3 (balík dhcp3-server).

</para>

<informalexample><screen>
if substring (option vendor-class-identifier, 0, 3) = "d-i" {
    filename "http://pocitac/preseed.cfg";
}
</screen></informalexample>

<para>

V¹imnìte si, ¾e pøedchozí pøíklad omezuje pou¾ití na DHCP klienty,
kteøí se identifikují jako <quote>d-i</quote>, tak¾e by to nemìlo
ovlivnit bì¾né DHCP klienty, ale pouze instalace. Direktivu
<userinput>filename</userinput> mù¾ete zadat napøíklad i do sekce pro
jediný poèítaè, tak¾e neovlivníte ostatní instalace na síti.

</para><para>

K dobrým zvykùm pøi pøednastavování pøes DHCP patøí pøednastavení
pouze hodnot, které jsou specifické pro va¹i sí», jako je
napø. lokální zrcadlo. Tím se pøi instalaci automaticky vybere správné
zrcadlo, ale zbytek instalace probíhá interaktivnì. Kompletní
pøednastavení pøes DHCP byste mìli provádìt pouze s nejvy¹¹í
opatrností.

</para>
  </sect2>

  <sect2 id="preseed-bootparms">
  <title>Pou¾ití zavádìcích parametrù jako formu pøednastavení</title>
<para>

Ne v¹echny èásti instalaèního procesu jdou automatizovat pomocí
v¹ech typù pøednastavení, proto¾e se obèas zobrazí otázky je¹tì pøed
nahráním souboru s pøednastavením. Napøíklad aby se mohl stáhnout
soubor s pøednastavením ze sítì, musí se sí» nejprve nastavit. (Tento
problém øe¹í mj. pøednastavení rovnou v initrd.)

</para><para>

I kdy¾ nemù¾ete pøednastavit nìkteré kroky, stále mù¾ete dosáhnout
plnì automatické instalace, proto¾e mù¾ete zadat hodnoty pro
pøednastavení jako zavádìcí parametry jádra. Pro libovolnou promìnnou
staèí zadat <userinput>cesta/k/promenne=hodnota</userinput>.

</para><note><para>

Jádro 2.4 akceptuje nejvý¹e 8 parametrù a 8 promìnných prostøedí
(vèetnì standardních voleb pro instalaèní program). Pokud tento limit
pøekroèíte, jádra øady 2.4 pøebývající parametry zahodí, jádra 2.6
zpanikaøí. S jádry 2.6.9 a novìj¹ími mù¾ete pou¾ít a¾ 32 parametrù
a 32 promìnných prostøedí.

</para></note><para>

Pro vìt¹inu instalací mù¾ete celkem bez problémù odstranit implicitní
volby jako <userinput>vga=normal</userinput>, co¾ vám umo¾ní pøidat
dal¹í volby pro pøednastavení.

</para><note><para>

V nìkterých pøípadech není mo¾né zadat hodnotu obsahující mezeru, a to
i v pøípadì, kdy hodnotu obklopíte uvozovkami.

</para></note>
  </sect2>
 </sect1>

 <sect1 id="preseed-creating">
 <title>Vytvoøení souboru s pøednastavením</title>
<para>

Soubor s pøednastavením soubor má stejný formát jako pou¾ívá pøíkaz
<command>debconf-set-selections</command>. Bì¾ný øádek pak má tvar

<informalexample><screen>
&lt;vlastník&gt; &lt;jméno ¹ablony&gt; &lt;typ ¹ablony&gt; &lt;hodnota&gt;
</screen></informalexample>

</para><para>

Pøi vytváøení souboru s pøednastavením byste mìli mít na pamìti
nìkolik pravidel.

</para>

<itemizedlist>
<listitem><para>
  Mezi typ a hodnotu vkládejte pouze jednu mezeru nebu tabulátor
  &mdash; pøípadné dal¹í bílé znaky budou pova¾ovány za souèást
  hodnoty.
</para></listitem>
<listitem><para>
  Dlouhý øádek mù¾ete pro lep¹í èitelnost rozdìlit na nìkolik øádkù
  tak, ¾e na konec øádku pøidáte znak pro pokraèování øádku
  <quote><literal>\</literal></quote> (zpìtné lomítko). Je vhodné
  rozdìlit øádek mezi názvem a typem ¹ablony, ne mezi typem
  a hodnotou.
</para></listitem>
<listitem><para>
  Vìt¹ina ¹ablon vy¾aduje zadání hodnot v angliètinì, av¹ak existují
  výjimky jako tøeba <classname>partman</classname>, kde musíte pou¾ít
  pøelo¾ené hodnoty.
</para></listitem>
<listitem><para>
  Dále pak nìkteré ¹ablony vy¾adují hodnotu formou kódu (a ne text,
  který se zobrazuje bìhem instalace).
</para></listitem>
</itemizedlist>

<para>

Nejjednodu¹¹í zpùsob vytvoøení souboru s pøednastavením je pou¾ít
ukázkový soubor z <xref linkend="preseed-contents"/> jako základ
a upravit si jej dle potøeb.

</para><para>

Jiná mo¾nost je provést ruèní instalaci a po restartu do nového
systému pou¾ít pøíkaz <command>debconf-get-selections</command> (z
balíku <classname>debconf-utils</classname>) a ulo¾it databázi
debconfu i cdebconfu do jediného souboru:

<informalexample><screen>
$ debconf-get-selections --installer &gt; <replaceable>soubor</replaceable>
$ debconf-get-selections &gt;&gt; <replaceable>soubor</replaceable>
</screen></informalexample>

</para><para>

Tento pøístup má tu nevýhodu, ¾e vytvoøený soubor bude obsahovat
i polo¾ky, které by se nemìly pøednastavovat. Z tohoto pohledu je pro
vìt¹inu u¾ivatelù vhodnìj¹í pou¾ití ukázkového souboru.

</para><note><para>

Tento zpùsob se spoléhá na fakt, ¾e se na konci instalace ulo¾í
databáze cdebconfu do instalovaného systému do souboru
<filename>/var/log/installer/cdebconf</filename>. Proto¾e tato
databáze mù¾e obsahovat dùvìrné informace, jsou tyto soubory èitelné
pouze pro u¾ivatele root.

</para><para>

Pokud ze systému vyèistíte balík
<classname>installation-report</classname>, bude smazán také adresáø
<filename>/var/log/installer</filename>.

</para></note><para>

Seznam mo¾ných hodnot pro ¹ablony mù¾ete zjistit bìhem instalace ze
souborù umístìných v adresáøi <filename>/var/lib/cdebconf</filename>
(napø. pomocí editoru <command>nano</command>). Samotné ¹ablony se
nachází v souboru <filename>templates.dat</filename>, aktuální hodnoty
naleznete v souboru <filename>questions.dat</filename>.

</para><para>

Je¹tì pøed instalací je vhodné zkontrolovat formát pøedkonfiguraèního
souboru pøíkazem <command>debconf-set-selections -c
<replaceable>preseed.cfg</replaceable></command>.

</para>
 </sect1>

 <sect1 id="preseed-contents">
 <title>Obsah souboru s pøednastavením</title>
<para>

Útr¾ky konfigurace pou¾ité v této èásti jsou také dostupné jako
samostatný soubor na &urlset-example-preseed;.

</para><para>

Tento pøíklad je zalo¾en na instalaci pro architekturu Intel
x86. Jestli¾e instalujete na jinou architekturu, nemusí nìkterá
nastavení odpovídat tìm uvedeným (výbìr klávesnice, instalace
zavadìèe) a budete je muset nahradit adekvátními hodnotami.

</para>

  <sect2 id="preseed-l10n">
  <title>Lokalizace</title>
<para>

Nastavení lokalizaèních promìnných bude fungovat pouze v pøípadì,
kdy¾ pou¾íváte pøednastavení pøes initrd. U ostatních zpùsobù se toti¾
soubor s pøednastavením nahraje a¾ po zobrazení tìchto otázek.

</para><para>

Místní prostøení (locale) slou¾í k souèasnému zadání jazyka
i zemì. Napøíklad pomocí zavádìcího parametru jádra mù¾ete zadat
<userinput>debian-installer/locale=<replaceable>cs_CZ</replaceable></userinput>.

<informalexample role="example"><screen>
# Locale nastaví jazyk i zemi.
d-i debian-installer/locale string cs_CZ
</screen></informalexample>

</para><para>

Nastavení klávesnice se skládá z výbìru typu klávesnice a z výbìru
klávesové mapy. Ve vìt¹inì pøípadù je typ klávesnice rozpoznán
automaticky, tak¾e není potøeba jej pøednastavovat. Klávesová mapa
musí být platná v rámci daného typu.

<informalexample role="example"><screen>
# Výbìr klávesnice.
#d-i console-tools/archs select at
d-i console-keymaps-at/keymap select cz-lat2
# Pøíklad pro jiný typ klávesnice
#d-i console-keymaps-usb/keymap select mac-usb-us
</screen></informalexample>

</para><para>

Nastavení klávesnice mù¾ete pøeskoèit nastavením promìnné
<classname>console-tools/archs</classname> na hodnotu
<userinput>skip-config</userinput>. Tím se zachová výchozí klávesová
mapa jádra.

</para>

<note><para>

Zmìny ve vstupní vrstvì jader 2.6 v podstatì smazaly význam typù
klávesnic, tak¾e by vìt¹inou mìl staèit typ <quote>PC</quote>
(<userinput>at</userinput>).

</para></note>
  </sect2>

  <sect2 id="preseed-network">
  <title>Nastavení sítì</title>
<para>

Pokud nahráváte soubor s pøednastavením ze sítì, pak následující
samozøejmì nebude fungovat! V takovém pøípadì zadejte potøebné
parametry sítì zavadìèi jádra. Zavádíte-li z CD nebo USB, bude
nastavení fungovat bez problémù.

</para><para>

Potøebujete-li pøi zavádìní ze sítì vybrat konkrétní sí»ové rozhraní
je¹tì pøed nahráním souboru s pøednastavením, pou¾ijte zavádìcí
parametr
<userinput>netcfg/choose_interface=<replaceable>eth1</replaceable></userinput>.

</para>

<informalexample role="example"><screen>
# netcfg zkusí pou¾ít rozhraní, jeho¾ druhý konec je aktivní
# a tím pádem pøeskoèí výbìr ze seznamu nalezených rozhraní.
d-i netcfg/choose_interface select auto

# Výbìr konkrétního sí»ového rozhraní:
#d-i netcfg/choose_interface select eth1

# Máte-li pomalej¹í dhcp server a instalaènímu systému vypr¹í èas pøi
# èekání na odpovìï, bude u¾iteèné následující.
#d-i netcfg/dhcp_timeout string 60

# Pokud dáváte pøednost ruènímu nastavení sítì:
#d-i netcfg/disable_dhcp boolean true

# Má-li tento soubor s pøednastavením fungovat na systémech s i bez
# dhcp serveru, odkomentujte následující øádky a také statické
# nastavení sítì ní¾e.
#d-i netcfg/dhcp_failed note
#d-i netcfg/dhcp_options select Configure network manually

# Statické nastavení sítì.
#d-i netcfg/get_nameservers string 192.168.1.1
#d-i netcfg/get_ipaddress string 192.168.1.42
#d-i netcfg/get_netmask string 255.255.255.0
#d-i netcfg/get_gateway string 192.168.1.1
#d-i netcfg/confirm_static boolean true

# Název poèítaèe a domény pøiøazené pøes DHCP mají vìt¹í prioritu ne¾
# hodnoty nastavené zde, nicménì takto máte jistotu, ¾e tato otázka
# nezobrazí (a» u¾ nastavení z DHCP obdr¾íme nebo ne).
d-i netcfg/get_hostname string nenastavene-jmeno
d-i netcfg/get_domain string nenastavena-domena

# Zaká¾e otravný dialog o WEP klíèi.
d-i netcfg/wireless_wep string
# Pra¹tìné DHCP jméno poèítaèe, které pou¾ívají nìkteøí ISP jako heslo.
#d-i netcfg/dhcp_hostname string radish
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-mirror">
  <title>Nastavení zrcadla</title>
<para>

V závislosti na zpùsobu instalace mù¾ete zrcadlo pou¾ít pro sta¾ení
dodateèných komponent instalaèního systému, sta¾ení základního systému
a pro nastavení souboru <filename>/etc/apt/sources.list</filename>.

</para><para>

Parametr <classname>mirror/suite</classname> urèuje verzi
instalovaného systému.

</para><para>

Parametr <classname>mirror/udeb/suite</classname> urèuje verzi
Debianu, ze které se stáhnou dodateèné komponenty instalaèního
systému. Nastavení této promìnné má smysl pouze v pøípadì, ¾e
komponenty stahujete ze sítì a potøebujete, aby odpovídaly verzi
initrd, který se pou¾ívá pro instalaci.
Výchozí hodnota <classname>mirror/udeb/suite</classname> je stejná
jako <classname>mirror/suite</classname>.

</para>

<informalexample role="example"><screen>
d-i mirror/country string enter information manually
d-i mirror/http/hostname string http.cz.debian.org
d-i mirror/http/directory string /debian
d-i mirror/http/proxy string

# Verze pro instalaci.
#d-i mirror/suite string testing
# Verze, ze které nahrát komponenty instalátoru (volitelné).
#d-i mirror/udeb/suite string testing
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-partman">
  <title>Rozdìlení disku</title>
<para>

Dìlení disku je víceménì omezeno mo¾nostmi, které nabízí
<classname>partman-auto</classname>. Mù¾ete zvolit rozdìlení buï
stávajícího volného místa, nebo celého disku. Rozvr¾ení oblastí mù¾ete
nadefinovat pomocí pøeddefinovaného schematu, vlastního schematu ze
souboru nebo schematu obsa¾eném v souboru s pøednastavením. Momentálnì
není mo¾né pøednastavit rozdìlení více diskù nebo nastavení RAIDu.

</para><warning><para>

Oznaèení diskù závisí na poøadí, ve kterém jsou nahrány jejich
ovladaèe. Jestli¾e se v systému nachází více diskù, tak se ubezpeète,
¾e jste vybrali ten správný.

</para></warning>

<informalexample role="example"><screen>
# Pokud má systém volné místo, mù¾ete je vybrat k automatickému rozdìlení.
# Pozn: hodnota této ¹ablony musí být lokalizována (pøelo¾ena).
#d-i partman-auto/init_automatically_partition \
#      select Pou¾ít nejvìt¹í spojité volné místo

# Alternativnì mù¾ete zadat k automatickému dìlení celý disk. Název
# zaøízení mù¾e být v tradièním formátu nebo ve formátu devfs.
# Napøíklad pro pou¾ití prvního disku, který devfs najde:
d-i partman-auto/disk string /dev/discs/disc0/disc

# Mù¾ete vybrat libovolné z pøednastavených schémat dìlení.
# Pozn: hodnota této ¹ablony musí být lokalizována (pøelo¾ena).
d-i partman-auto/choose_recipe \
       select All files in one partition (recommended for new users)
#d-i partman-auto/choose_recipe \
#       select Separate /home partition
#d-i partman-auto/choose_recipe \
#       select Separate /home, /usr, /var, and /tmp partitions

# Nebo zadat vá¹ vlastní návod na dìlení...
# Formát návodu je popsán v souboru devel/partman-auto-recipe.txt.
# Pokud umíte do prostøedí d-i dostat soubor s návodem na dìlení,
# staèí na nìj odkázat.
#d-i partman-auto/expert_recipe_file string /hd-media/recipe

# V opaèném pøípadì mù¾ete zadat celý návod na jednu (logickou) øádku.
# Napøíklad vytvoøíme malou oblast /boot, vhodný swap a zbytek
# pou¾ijeme jako koøenovou oblast:
#d-i partman-auto/expert_recipe string                         \
#      boot-root ::                                            \
#              40 50 100 ext3                                  \
#                      $primary{ } $bootable{ }                \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ /boot }                     \
#              .                                               \
#              500 10000 1000000000 ext3                       \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ / }                         \
#              .                                               \
#              64 512 300% linux-swap                          \
#                      method{ swap } format{ }                \
#              .

# Následujícím øeknete partmanu, aby disk rozdìlil bez potvrzení.
d-i partman/confirm_write_new_label boolean true
d-i partman/choose_partition \
       select Finish partitioning and write changes to disk
d-i partman/confirm boolean true
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-time">
  <title>Nastavení hodin a èasového pásma</title>

<informalexample role="example"><screen>
# Urèuje, zda jsou hardwarové hodiny nastaveny na UTC.
d-i clock-setup/utc boolean true

# Promìnnou mù¾ete nastavit na libovolnou platnou hodnotu $TZ;
# Seznam èasových pásem naleznete v /usr/share/zoneinfo/.
d-i time/zone string US/Eastern
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-apt">
  <title>Nastavení APT</title>
<para>

Nastavení souboru <filename>/etc/apt/sources.list</filename>
a nìkolika základních parametrù je plnì øízeno typem instalace
a døíve zodpovìzenými otázkami. Volitelnì mù¾ete pøidat dal¹í
(lokální) archivy.

</para>

<informalexample role="example"><screen>
# Mù¾ete si zvolit instalaci softwaru ze sekcí non-free a contrib.
#d-i apt-setup/non-free boolean true
#d-i apt-setup/contrib boolean true
# Odkomentujte, pokud nechcete pøidat zdroje s opravami, nebo pokud
# chcete pou¾ít jiný server ne¾ security.debian.org.
#d-i apt-setup/security_host string

# Dal¹í archivy, k dispozici jsou local[0-9]
#d-i apt-setup/local0/comment string local server
#d-i apt-setup/local0/repository string \
#       deb http://muj.server/debian stable main
# URL k veøejnému klíèi lokálního archivu
#d-i apt-setup/local0/key string http://local.server/key
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-account">
  <title>Nastavení úètù</title>
<para>

Instalaèní systém umo¾òuje pøednastavit jak heslo u¾ivatele root, tak
jméno a heslo prvního bì¾ného u¾ivatele systému. Heslo mù¾ete zadat
buï v ne¹ifrované podobì, nebo jako MD5 <emphasis>hash</emphasis>.

</para><warning><para>

Pøednastavení hesel není bezpeèné, proto¾e kdokoliv s pøístupem
k souboru s pøednastavením si tato hesla mù¾e pøeèíst. Z pohledu
bezpeènosti je pou¾ití MD5 hashù lep¹í, ov¹em poskytují pouze fale¹ný
pocit bezpeèí, proto¾e pøístup k MD5 hashi znamená mo¾nost útokù
hrubou silou.

</para></warning>

<informalexample role="example"><screen>
# Pøeskoèí vytvoøení úètu pro roota (bì¾ný u¾ivatel bude moci pou¾ít
# sudo).
#d-i passwd/root-login boolean false
# Volitelnì pøeskoèí vytvoøení bì¾ného u¾ivatelského úètu.
#d-i passwd/make-user boolean false

# Rootovo heslo v èitelném tvaru
#d-i passwd/root-password password r00tme
#d-i passwd/root-password-again password r00tme
# nebo ¹ifrované pomocí MD5 hashe.
#d-i passwd/root-password-crypted password [MD5 hash]

# Vytvoøení úètu bì¾ného u¾ivatele.
#d-i passwd/user-fullname string Jan Novak
#d-i passwd/username string jan
# Heslo bì¾ného u¾ivatele v èitelném tvaru
#d-i passwd/user-password password nebezpecne
#d-i passwd/user-password-again password nebezpecne
# nebo ¹ifrované pomocí MD5 hashe.
#d-i passwd/user-password-crypted password [MD5 hash]
</screen></informalexample>

<para>

Do promìnných <classname>passwd/root-password-crypted</classname> a
<classname>passwd/user-password-crypted</classname> mù¾ete jako
hodnotu zadat znak vykøièník <quote>!</quote>, co¾ znamená, ¾e daný
úèet bude zakázán. To se mù¾e hodit napøíklad pro úèet root, co¾ ov¹em
pøedpokládá, ¾e máte nastavenu nìjakou jinou mo¾nost, jak poèítaè
spravovat (napøíklad pomocí <command>sudo</command> nebo autentizace
pøes SSH klíèe).

</para><para>

MD5 hash hesla mù¾ete vygenerovat následujícím pøíkazem.

<informalexample><screen>
$ echo "r00tme" | mkpasswd -s -H MD5
</screen></informalexample>

</para>
  </sect2>

  <sect2 id="preseed-base-installer">
  <title>Instalace základního systému</title>
<para>

V této fázi instalace se toho moc nastavit nedá. Jediné otázky se
týkají instalace jádra.

</para>

<informalexample role="example"><screen>
# Vybere generátor initramfs, kterým se vygeneruje initrd pro jádra
# øady 2.6.
#d-i base-installer/kernel/linux/initramfs-generators string yaird
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-bootloader">
  <title>Instalace zavadìèe</title>

<informalexample role="example"><screen>
# Implicitní zavadìè (pro x86) je Grub. Chcete-li místo nìj instalovat
# LILO, odkomentujte následující:
#d-i grub-installer/skip boolean true

# Toto je bezpeèné nastavení - pokud nenalezne jiný operaèní systém,
# nainstaluje Grub do MBR.
d-i grub-installer/only_debian boolean true

# Toto nainstaluje Grub do MBR i kdy¾ nalezne jiný operaèní systém,
# co¾ je ménì bezpeèné, proto¾e se jiný systém nemusí zavést.
d-i grub-installer/with_other_os boolean true

# Alternativnì mù¾ete instalovat jinam ne¾ do MBR - odkomentujete
# a upravte tyto øádky:
#d-i grub-installer/bootdev  string (hd0,0)
#d-i grub-installer/only_debian boolean false
#d-i grub-installer/with_other_os boolean false
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-pkgsel">
  <title>Výbìr balíkù.</title>
<para>

Mù¾ete nainstalovat libovolnou kombinaci dostupných úloh. V dobì psaní
to zahrnuje:

</para>

<itemizedlist>
<listitem><para>
  <userinput>Standard system</userinput>
</para></listitem>
<listitem><para>
  <userinput>Desktop environment</userinput>
</para></listitem>
<listitem><para>
  <userinput>Web server</userinput>
</para></listitem>
<listitem><para>
  <userinput>Print server</userinput>
</para></listitem>
<listitem><para>
  <userinput>DNS server</userinput>
</para></listitem>
<listitem><para>
  <userinput>File server</userinput>
</para></listitem>
<listitem><para>
  <userinput>Mail server</userinput>
</para></listitem>
<listitem><para>
  <userinput>SQL database</userinput>
</para></listitem>
<listitem><para>
  <userinput>Laptop</userinput>
</para></listitem>
</itemizedlist>

<para>

Instalaci úloh mù¾ete vynechat a instalovat balíky nìjakou jinou
cestou. Úlohu <userinput>Standard system</userinput> v¹ak doporuèujeme
instalovat v¾dy.

</para>

<informalexample role="example"><screen>
tasksel tasksel/first multiselect Standard system, Desktop environment
#tasksel tasksel/first multiselect Standard system, Web server

# Nìkteré verze instalaèního systému mohou vývojáøùm Debianu hlásit
# seznam balíkù, které jste nainstalovali, co¾ pomáhá pøi
# rozhodování, který software je oblíbený a proto by mìl být zaøazen
# na CD. Výchozí hodnotou je zákaz posílání tohoto seznamu, ale mìli
# byste zvá¾it jeho povolení.
#popularity-contest popularity-contest/participate boolean false
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-finish">
  <title>Dokonèení první fáze instalace</title>

<informalexample role="example"><screen>
# Vynechá poslední hlá¹ku, ¾e je instalace kompletní.
d-i prebaseconfig/reboot_in_progress note

# Zaká¾e vysunutí CD bìhem restartu, co¾ se obèas mù¾e hodit.
#d-i cdrom-detect/eject boolean false
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-mailer">
  <title>Nastavení po¹ty</title>
<para>

Bìhem normální instalace se exim ptá pouze nìkolik otázek. (Je mo¾né
pøednastavit i slo¾itìj¹í nastavení.)

</para>

<informalexample role="example"><screen>
exim4-config exim4/dc_eximconfig_configtype \
       select no configuration at this time
exim4-config exim4/no_config boolean true
exim4-config exim4/no_config boolean true
exim4-config exim4/dc_postmaster string
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-X">
  <title>Nastavení X Window</title>
<para>

Pøednastavení odpovìdí pro systém X Window je mo¾né, nicménì není
zcela automatické a je velmi závislé na hardwaru ka¾dého poèítaèe,
tudí¾ byste si mìli o pøítomném hardwaru zjistit nìjaké podrobnosti.

</para>

<informalexample role="example"><screen>
# I kdy¾ X rozpozná správný ovladaè grafické karty, zde jej mù¾ete
# pøepsat. Vesa bude fungovat ve vìt¹inì pøípadù.
#xserver-xorg xserver-xorg/config/device/driver select vesa

# Pokud se automatické rozpoznání my¹i nezdaøí, dostanete se do
# nekoneèné smyèky, proto¾e nástroj se bude ptát znovu a znovu
# a poka¾dé (ne)nalezne stejnou nefunkèní my¹.
#xserver-xorg xserver-xorg/autodetect_mouse boolean true

# Automatické rozpoznání monitoru je doporuèeno.
xserver-xorg xserver-xorg/autodetect_monitor boolean true
# Odkomentujete pokud máte LCD displej.
#xserver-xorg xserver-xorg/config/monitor/lcd boolean true
# X má tøi metody nastavení monitoru. Uká¾eme støední cestu
# ("medium"), která je dostupná v¾dy. Mo¾nost "simple" nemusí být
# dostupná a "advanced" se ptá pøíli¹ mnoho otázek.
xserver-xorg xserver-xorg/config/monitor/selection-method \
       select medium
xserver-xorg xserver-xorg/config/monitor/mode-list \
       select 1024x768 @ 60 Hz
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-other">
  <title>Pøednastavení ostatních balíkù</title>

<informalexample role="example"><screen>
# Je mo¾né, ¾e se objeví dal¹í otázky v závislosti na tom, jaký
# software nainstalujete, nebo podle toho, co se bìhem instalace
# pokazí. Seznam v¹ech mo¾ných otázek bìhem instalace získáte
# pøíkazy:
#   debconf-get-selections --installer > soubor
#   debconf-get-selections >> soubor
</screen></informalexample>

  </sect2>
 </sect1>

 <sect1 id="preseed-advanced">
 <title>Pokroèilé mo¾nosti</title>

  <sect2 id="preseed-shell">
  <title>Shellové pøíkazy</title>

<informalexample role="example"><screen>
# Pøednastavení d-i není u¾ ze své podstaty bezpeèné. Nic
# v instalaèním systému nekontroluje pokusy kolem pøeteèení bufferu
# ani zneu¾ití hodnot v souboru s pøednastaveními. Pou¾ívejte tyto
# soubory pouze z dùvìryhodných zdrojù!
# Následuje ukázka, jak v d-i spustit automaticky nìjaký shellový pøíkaz.

# První pøíkaz je spu¹tìn co nejdøíve - hned po naètení pøednastavení.
#d-i preseed/early_command string anna-install nejaky-udeb

# Tento pøíkaz je spu¹tìn tìsnì pøed koncem instalace, ale je¹tì je
# pøipojen adresáø /target. Buï mù¾ete pou¾ít chroot na /target
# a pracovat pøímo v nìm, nebo mù¾ete pou¾ít pøíkaz apt-install
# resp. in-target pro jednoduchou instalaci balíkù resp. spou¹tìní
# pøíkazù v novì instalovaném systému
+#d-i preseed/late_command string apt-install zsh; in-target chsh -s /bin/zsh
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-chainload">
  <title>Zøetìzené nahrávání souborù s pøednastavením</title>
<para>

Pøesto¾e je pou¾ití jednoho velkého souboru s pøednastavením
jednoduché, zdaleka nemusí být pøehledné a navíc postrádá
flexibilitu. Z tohoto dùvodu je mo¾né nastavení rozdìlit do nìkolika
samostatných souborù a ty pak skládat dohromady. Proto¾e pozdìji
uvedené volby pøepisují volby zadané døíve, pøímo se nabízí vytvoøení
hlavního (sdíleného) souboru s obecnými pøedvolbami a k nìmu nìkolik
dal¹ích souborù se specifickým nastavením pro danou situaci.

</para>

<informalexample><screen>
# Zadat mù¾ete i více souborù najednou, staèí je oddìlit mezerami.
# Vlo¾ené soubory mohou obsahovat jak deklarace pro pøednastavení,
# tak pøíkazy pro zavedení dal¹ích souborù. Pokud cestu zadáte
# relativnì, hledají se soubory ve stejném adresáøi, jako nadøízený
# soubor.
#d-i preseed/include string x.cfg

# d-i mù¾e volitelnì kontrolovat kontrolní souèty souborù
# s pøednastavením. V souèasnosti jsou podporovány pouze md5 souèty.
# Seznam souètù zadejte ve stejném poøadí, v jakém se budou naèítat
# soubory s pøednastavením.
#d-i preseed/include/checksum string 5da499872becccfeda2c4872f9171c3d

# Mnohem pru¾nìj¹í je pou¾ití shellového pøíkazu, který vrátí názvy
# souborù, je¾ se mají nahrát.
#d-i preseed/include_command \
#      string echo if [ "`hostname`" = bob ]; then echo bob.cfg; fi
</screen></informalexample>

  </sect2>
 </sect1>
</appendix>
