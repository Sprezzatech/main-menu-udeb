<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- original version: -39224 -->
<!-- Traducido por Javier Fernandez-Sanguino -->

   <sect3 id="partman-crypto">
   <title>Configurar volumenes cifrados</title>
<para>

&d-i; permite la configuración de particiones cifradas. Cualquier fichero que
se guarde en una partición de estas características se guardará al dispositivo
cifrado. El acceso a los datos sólo se puede conseguir una vez haya introducido
la <firstterm>clave</firstterm> utilizada para crear originalmente la partición
cifrada. Esta función es útil para proteger datos sensibles en caso
de que alguien robe su portátil o disco duro. El ladrón podrá lograr acceder al
disco duro pero los datos en el disco parecerán ser caracteres aleatorios y no
podrá acceder a los mismos  si no sabe la clave correcta.

</para><para>

Las particiones más importantes a cifrar son: la partición «home» que
es donde se guardan sus datos privados y la partición de intercambio («swap»)
ya que pueden guardarse datos sensibles en ésta durante la operación del
sistema. Por supuesto, nada impide que vd. cifre otras particiones que podrían
ser de interés. Por ejemplo <filename>/var</filename>, que es donde se guardan
los datos de los sistemas de base de datos, servidores de correo o servidores
de impresora, o <filename>/tmp</filename>, que lo utilizan algunos programas
para almacenar algunos datos temporales que pudieran ser de interés. Algunos
usuarios pueden quere incluso cifrar todo su sistema. La única excepción
es que la partición <filename>/boot</filename> debe permanecer sin 
cifrar ya que de momento no hay ninguna forma de cargar un núcleo de una
partición cifrada.

</para><note><para>

Tenga en cuenta que el rendimiento de las particiones cifradas será
peor que el de las particiones sin cifrar porque se tienen que 
descifrar o cifrar los datos en cada acceso de lectura o escritura.
El impacto en el rendimiento dependen de la velocidad de su CPU,
y del cifrado y longitud de clave escogidos.

</para></note><para>

Debe crear una nueva partición en el menú de particionado seleccionando 
espacio libre si quiere utilizar el cifrado. Otra opción es utilizar
una partición existente (p.ej. una partición normal, o un volumen lógico
LVM  o RAID). Tiene que seleccionar <guimenuitem>volumen físico
para cifrado</guimenuitem> en el menú <guimenu>Configuración de la 
partición</guimenu> en la opción <menuchoice> <guimenu>Utilizar como:</guimenu> </menuchoice>. El menú cambiará para mostrar distintas opciones
criptográficas para la partición.

</para><para>

Puede utilizar distintos métodos de cifrado en &d-i;. El
método por omisión es <firstterm>dm-crypt</firstterm> (disponible
en las últimas versiones del núcleo de Linux que pueden incluir
volúmenes LVM físicos) y la otra es 
<firstterm>loop-AES</firstterm> (más antigua y mantenida de forma
separada del árbol del núcleo de Linux). Se le recomienda la primera
opción a no ser que tenga razones importantes para no utilizarla.

<!-- TODO: link to the "Debian block device encryption guide"
     once Max writes it :-) -->

</para><para>

En primer lugar veamos las opciones disponibles cuando seleccione
como método de cifrado <userinput>Device-mapper (dm-crypt)</userinput>. Como
siempre: cuando tenga dudas utilice los valores por omisión, se han escogido
con mucho cuidado pensando en la seguridad de su sistema.

<variablelist>

<varlistentry>
<term>Cifrado: <userinput>aes</userinput></term>

<listitem><para>

Esta opción le permite seleccionar el algoritmo de cifrado
(<firstterm>cifra</firstterm>) que se utiliza para cifrar los datos
en la partición. Actualmente &d-i; ofrece soporte para los siguientes
cifrados de bloque: <firstterm>aes</firstterm>,
<firstterm>blowfish</firstterm>,
<firstterm>serpent</firstterm>, y <firstterm>twofish</firstterm>.
La discusión de la calidad de los distintos algoritmos de cifrado
queda fuera del alcance de este documento. Sin embargo, puede ayudarle
a tomar una decisión el hecho de que en el año 2000 el 
Instituto Nacional de Estándares y Tecnología Norteamericano («American
National Institute of Standards and Technology», NIST) escogió AES
como el algoritmo de cifrado estándar para proteger información
sensible en el siglo XXI.

</para></listitem>
</varlistentry>

<varlistentry>
<term>Longitud de clave: <userinput>256</userinput></term>

<!-- TODO: Continue translating here -->

<listitem><para>

Here you can specify the length of the encryption key. With a larger
key size, the strength of the encryption is generally improved. On the
other hand, increasing the length of the key usually has a negative
impact on performance. Available key sizes vary depending on the
cipher.

</para></listitem>
</varlistentry>

<varlistentry>
<term>IV algorithm: <userinput>cbc-essiv:sha256</userinput></term>

<listitem><para>

The <firstterm>Initialization Vector</firstterm> or
<firstterm>IV</firstterm> algorithm is used in cryptography to ensure
that applying the cipher on the same <firstterm>clear text</firstterm>
data with the same key always produces a unique
<firstterm>cipher text</firstterm>. The idea is to prevent the
attacker from deducing information from repeated patterns in the encrypted
data.

</para><para>

From the provided alternatives, the default
<userinput>cbc-essiv:sha256</userinput> is currently the least
vulnerable to known attacks. Use the other alternatives only when you
need to ensure compatibility with some previously installed system
that is not able to use newer algorithms.

</para></listitem>
</varlistentry>

<varlistentry>
<term>Encryption key: <userinput>Passphrase</userinput></term>

<listitem><para>

Here you can choose the type of the encryption key for this partition.

 <variablelist>
 <varlistentry>
 <term>Passphrase</term>
 <listitem><para>

The encryption key will be computed<footnote>
<para>

Using a passphrase as the key currently means that the partition will
be set up using <ulink url="&url-luks;">LUKS</ulink>.

</para></footnote> on the basis of a passphrase which you will be able
to enter later in the process.

 </para></listitem>
 </varlistentry>

 <varlistentry>
 <term>Random key</term>
 <listitem><para>

A new encryption key will be generated from random data each time you
try to bring up the encrypted partition.  In other words: on every
shutdown the content of the partition will be lost as the key is
deleted from memory. (Of course, you could try to guess the key with a
brute force attack, but unless there is an unknown weakness in the
cipher algorithm, it is not achievable in our lifetime.)

 </para><para>

Random keys are useful for swap partitions because you do not need to
bother yourself with remembering the passphrase or wiping sensitive
information from the swap partition before shutting down your
computer. However, it also means that you
will <emphasis>not</emphasis> be able to use
the <quote>suspend-to-disk</quote> functionality offered by newer
Linux kernels as it will be impossible (during a subsequent boot) to
recover the suspended data written to the swap partition.

 </para></listitem>
 </varlistentry>
 </variablelist>

</para></listitem>
</varlistentry>

<varlistentry>
<term>Erase data: <userinput>yes</userinput></term>

<listitem><para>

Determines whether the content of this partition should be overwritten
with random data before setting up the encryption. This is recommended
because it might otherwise be possible for an attacker to discern
which parts of the partition are in use and which are not. In
addition, this will make it harder to recover any leftover data from
previous installations<footnote><para>

It is believed that the guys from three-letter agencies can restore
the data even after several rewrites of the magnetooptical media,
though.

</para></footnote>.

</para></listitem>
</varlistentry>

</variablelist>

</para><para>

If you select <menuchoice> <guimenu>Encryption method:</guimenu>
<guimenuitem>Loopback (loop-AES)</guimenuitem> </menuchoice>, the menu
changes to provide the following options:


<variablelist>
<varlistentry>
<term>Encryption: <userinput>AES256</userinput></term>

<listitem><para>

For loop-AES, unlike dm-crypt, the options for cipher and key size are
combined, so you can select both at the same time.  Please see the
above sections on ciphers and key sizes for further information.

</para></listitem>
</varlistentry>

<varlistentry>
<term>Encryption key: <userinput>Keyfile (GnuPG)</userinput></term>

<listitem><para>

Here you can select the type of the encryption key for this partition.

 <variablelist>
 <varlistentry>
 <term>Keyfile (GnuPG)</term>
 <listitem><para>

The encryption key will be generated from random data during the
installation. Moreover this key will be encrypted
with <application>GnuPG</application>, so to use it, you will need to
enter the proper passphrase (you will be asked to provide one later in
the process).

 </para></listitem>
 </varlistentry>

 <varlistentry>
 <term>Random key</term>
 <listitem><para>

Please see the the section on random keys above.

 </para></listitem>
 </varlistentry>
 </variablelist>

</para></listitem>
</varlistentry>

<varlistentry>
<term>Erase data: <userinput>yes</userinput></term>

<listitem><para>

Please see the the section on erasing data above.

</para></listitem>
</varlistentry>

</variablelist>

</para><note><para>

Please note that the <emphasis>graphical</emphasis> version of the
installer still has some limitations when compared to the textual
one. For cryptography it means you can set up only volumes using
<emphasis>passphrases</emphasis> as the encryption keys.

</para></note><para>


After you have selected the desired parameters for your encrypted
partitions, return back to the main partitioning menu. There should
now be a new menu item called <guimenu>Configure encrypted
volumes</guimenu>.  After you select it, you will be asked to confirm
the deletion of data on partitions marked to be erased and possibly
other actions such as writing a new partition table.  For large
partitions this might take some time.

</para><para>

Next you will be asked to enter a passphrase for partitions configured
to use one.  Good passphrases should be longer than 8 characters,
should be a mixture of letters, numbers and other characters and
should not contain common dictionary words or information easily
associable with you (such as birthdates, hobbies, pet names, names of
family members or relatives, etc.).

</para><warning><para>

Before you input any passphrases, you should have made sure that your
keyboard is configured correctly and generates the expected
characters. If you are unsure, you can switch to the second virtual
console and type some text at the prompt. This ensures that you won't be
surprised later, e.g. by trying to input a passphrase using a qwerty 
keyboard layout when you used an azerty layout during the installation.
This situation can have several causes. Maybe you switched to another
keyboard layout during the installation, or the selected keyboard layout
might not have been set up yet when entering the passphrase for the
root file system.

</para></warning><para>

If you selected to use methods other than a passphrase to create
encryption keys, they will be generated now. Because the kernel may
not have gathered a sufficient amount of entropy at this early stage
of the installation, the process may take a long time. You can help
speed up the process by generating entropy: e.g. by pressing random
keys, or by switching to the shell on the second virtual console and
generating some network and disk traffic (downloading some files,
feeding big files into <filename>/dev/null</filename>, etc.).

<!-- TODO: Mention hardware random generators when we will support
     them -->

This will be repeated for each partition to be encrypted.

</para><para>

After returning to the main partitioning menu, you will see all
encrypted volumes as additional partitions which can be configured in
the same way as ordinary partitions. The following example shows two
different volumes. The first one is encrypted via dm-crypt, the second
one via loop-AES.

<informalexample><screen>
Encrypted volume (<replaceable>crypt0</replaceable>) - 115.1 GB Linux device-mapper
     #1 115.1 GB  F ext3

Loopback (<replaceable>loop0</replaceable>) - 515.2 MB AES256 keyfile
     #1 515.2 MB  F ext3
</screen></informalexample>

Now is the time to assign mount points to the volumes and optionally
change the file system types if the defaults do not suit you.

</para><para>

One thing to note here are the identifiers in parentheses
(<replaceable>crypt0</replaceable>
and <replaceable>loop0</replaceable> in this case) and the mount
points you assigned to each encrypted volume. You will need this
information later when booting the new system. The differences between
ordinary boot process and boot process with encryption involved will
be covered later in <xref linkend="mount-encrypted-volumes"/>.

</para><para>

Once you are satisfied with the partitioning scheme, continue with the
installation.

</para>
   </sect3>
