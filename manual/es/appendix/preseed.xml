<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- original version: 56827 -->
<!-- traducido por jfs, 30 dic 2005 -->
<!-- actualizado ikks, 5 dic 2008 -->

<!--
Tened cuidado con el formato de este fichero dado que se parsea
para generar el fichero de preconfiguración.

En ese fichero se incluye todo el texto dentro de marcas
<informalexample> que tienen el atributo 'role="example"'.
Salvo si hay un atributo 'condition' que hace que no aplique a
la versión específica o un atributo 'arch' que hace que no aplique
a una arquitectura específica.

Actualmente sólo se genera una variante del fichero de ejemplo (para i386).
-->

<appendix id="appendix-preseed">
<title>Instalar automáticamente utilizando preconfiguración</title>

<para>

Este apéndice explica cómo preconfigurar respuestas a preguntas
en &d-i; para poder así automatizar una instalación.

</para><para>

Los fragmentos de configuración que se utilizan en este apéndice están también
disponibles como un fichero de preconfiguración de ejemplo en
&urlset-example-preseed;.

</para>

 <sect1 id="preseed-intro">
 <title>Introducción</title>
<para>

La preconfiguración ofrece un mecanismo para responder a preguntas realizadas
durante la instalación sin tener que introducir manualmente las respuestas
mientras ésta se ejecuta.
Esto hace posible que se automatizen la mayoría de las instalaciones e incluso
ofrece funcionalidades que no están disponibles durante una instalación normal.

</para><para>

La preconfiguración no es indispensable.  Si usa un fichero vacío de
preconfiguración, el instalador se comportará como una instalación manual
usual.  Cada pregunta que haya preconfigurado modificará(¡si lo ha hecho bien!)
la instalación de alguna forma con tal información.

</para>

  <sect2 id="preseed-methods">
  <title>Métodos de preconfiguración</title>
<para>

Se pueden utilizar tres métodos de preconfiguración:
<firstterm>initrd</firstterm>, <firstterm>file</firstterm> (fichero, n. del t.)
y <firstterm>network</firstterm> (red, n. del t.). La preconfiguración a través
de initrd funciona en cualquier método de instalación y permite preconfigurar
más cosas, pero es la que más preparación requiere. Los metodos de
preconfiguración con fichero o vía red pueden utilizarse en distintos métodos
de instalación.

</para><para>

La siguiente tabla muestra los métodos de preconfiguración que pueden utilizarse
con los distintos métodos de instalación.

<informaltable>
<tgroup cols="4">
<thead>
<row>
  <entry>Método de instalación</entry><entry>initrd</entry>
  <entry>file</entry><entry>network</entry>
</row>
</thead>

<tbody>
<row>
  <entry>CD/DVD</entry>
  <entry>sí</entry>
  <entry>sí</entry>
  <entry>sí<footnote id='apx-ps-net'>

  <para>
  pero sólo si tiene acceso a la red y configura <literal>preseed/url</literal>
  correctamente.
  </para>

  </footnote></entry>
</row><row>
  <entry>netboot</entry>
  <entry>sí</entry>
  <entry>no</entry>
  <entry>sí</entry>
</row><row>
  <entry>hd-media <phrase condition="bootable-usb">(incluyendo memorias usb)</phrase></entry>
  <entry>sí</entry>
  <entry>sí</entry>
  <entry>sí<footnoteref linkend='apx-ps-net'/></entry>
</row><row condition="supports-floppy-boot">
  <entry>basado en disquete (controladores de cd)</entry>
  <entry>sí</entry>
  <entry>sí</entry>
  <entry>sí<footnoteref linkend='apx-ps-net'/></entry>
</row><row condition="supports-floppy-boot">
  <entry>basado en disquete (controladores de red)</entry>
  <entry>sí</entry>
  <entry>no</entry>
  <entry>sí</entry>
</row><row arch="s390">
  <entry>genérico/cinta</entry>
  <entry>sí</entry>
  <entry>no</entry>
  <entry>sí</entry>
</row>
</tbody>

</tgroup></informaltable>

</para><para>

Una diferencia importante entre los métodos de preconfiguración es el punto en
el que se carga y procesa el fichero de preconfiguracio. Para la
preconfiguración a través del initrd esto se produce justo al comienzo de la
instalación, antes de hacer siquiera la primera pregunta. Para la
preconfiguración con fichero esto se hace después de que el CD o la imagen de
CD se haya cargado. Para la preconfiguración de red esto se hace sólo después
de que se haya configurado la red.

</para><para>

Obviamente, cualquier pregunta que se haya procesado antes de cargar el
fichero de preconfiguración no puede preconfigurarse (esto
incluye las preguntas que sólo se muestran a prioridad media o baja,
como el primer intento de detección automática del hardware).
Puede encontrar una forma para evitar que se omitan estas preguntas con
<xref linkend="preseed-bootparms"/>.

 </para><para>

Puede arrancar el instalador en modo <quote>auto</quote> para evitar
las preguntas que generalmente aparecen antes de que se realice la
preconfiguración. Esto hace que las preguntas que se harían antes de
poderse preconfigurar (p.ej. idioma, país y selección del teclado) se
harán después de la configuración de la red, lo que permite que se
preconfiguren. Esto también hace que la instalación se ejecute en
prioridad crítica, lo que hace que se omitan muchas preguntas poco
importantes. Para más información consulte <xref
linkend="preseed-auto"/>.

</para>
  </sect2>

  <sect2 id="preseed-limitations">
  <title>Limitaciones</title>
<para>

Aunque la mayoría de las preguntas que utiliza &d-i; pueden preconfigurarse
con este mecanismo hay algunas excepciones importantes. Tiene que (re)particionar
el disco completo o utilizar el espacio en disco libre disponible, no puede usar
particiones existentes.

</para>
  </sect2>

<!-- Joeyh feels this is too technical, so leave it out for now
  <sect2 id="preseed-debconf">
  <title>Información básica de Debconf</title>
<para>

Preseeding makes use of the <classname>debconf</classname> framework. This
framework is the preferred mechanism used in Debian to interact with the user
when configuring packages and also forms the heart of &d-i;.
In the <classname>debconf</classname> framework questions or dialogs are
based on <firstterm>templates</firstterm>. There are different types of
templates for different types of questions. The actual questions are
<quote>generated</quote> from templates at runtime;  multiple questions can
use the same template.

</para><para>

The following types of templates are relevant for preseeding.

</para>

<itemizedlist spacing="compact">
<listitem><para>
  string: allows the user to type any value
</para></listitem>
<listitem><para>
  password: similar to string but the value typed is not displayed
</para></listitem>
<listitem><para>
  boolean: for yes/no or true/false type of questions
</para></listitem>
<listitem><para>
  select: allows the user to select one option from a list
</para></listitem>
<listitem><para>
  multiselect: allows the user to select zero, one or more options from a list
</para></listitem>
<listitem><para>
  note: used to display a message
</para></listitem>
</itemizedlist>

<para>

In &d-i; templates are stored in a readable file
<filename>/var/cache/debconf/templates.dat</filename>. This file contains all fixed
text and all translations. It can also contain a default value for the
template. The fixed text can include variables that will be replaced at
runtime.

</para><para>

Another readable file <filename>/var/cache/debconf/questions.dat</filename>
is used to store the values for variables and the answers given to questions.
A question always refers to the template used to ask it. For obvious
security reasons the values for questions of type <quote>password</quote>
are stored in a separate, non-readable file in the same directory.

</para>
  </sect2>
-->

</sect1>

 <sect1 id="preseed-using">
 <title>Utilizar la preconfiguración</title>
<para>

En primer lugar ha de crear primero el fichero de preconfiguración
y ponerlo en la localización donde pretende utilizarlo. La creación del fichero
de preconfiguración se describe más adelante en este apéndice. Colocar el
fichero en la ubicación correcta es algo relativamente sencillo para la
preconfiguración vía red o si quiere leer el fichero de un disquete o una
memoria usb. Si desea incluir el fichero en un CD o DVD tendrá que rehacer la
imagen ISO. La inclusión del fichero de preconfiguración en el initrd queda
fuera del alcance de este documento, consulte la documentación de
desarrolladores de &d-i; si está interesado.

</para><para>

Tiene un fichero de preconfiguración de ejemplo, que puede utilizar como base
para su propio fichero de preconfiguración, en &urlset-example-preseed;. Este
fichero está basado en fragmentos de configuración incluídos en este apéndice.

</para>

  <sect2 id="preseed-loading">
  <title>Cargar el fichero de preconfiguración</title>
<para>

Si está utilizando la preconfiguración por initrd tiene que asegurarse que
existe un fichero con el nombre de <filename>preseed.cfg</filename> en el
directorio raíz del initrd. El instalador buscará automáticamente este fichero
y lo cargará.

</para><para>

Para otros métodos de preconfiguración tiene que decirle al instalador qué
ficheros utilizar cuando se arranca. Esto se hace habitualmente dando un valor al parámetro
de arranque del núcleo, bien manualmente en el arranque o bien editando el
fichero de configuración del cargador de arranque (p.ej.
<filename>syslinux.cfg</filename>) y añadiendo el parámetro al final de la/s
línea/s <quote>append</quote> para el núcleo.

</para><para>

Si especifica un fichero de preconfiguración en la configuración del cargador
de arranque podrá cambiar la configuración para que no tenga que pulsar enter
en el arranque del instalador. En el caso de syslinux esto signfica que
tiene que poner el valor de <quote>timeout</quote> en
<filename>syslinux.cfg</filename> a <literal>1</literal>.

</para><para>

Para asegurarse de que el instalador obtiene el fichero de preconfiguración
correcto puede especificar (opcionalmente) una marca identificativa para el
fichero. Esta marca es actualmente una suma MD5 y, si se especifica, debe
coincidir el valor que se obtenga del fichero de preconfiguración o el
instalador se negará a utilizarlo.

</para>

<informalexample><screen>
Párametros de arranque a especificar:
- si está arrancando de red:
  preseed/url=http://host/path/to/preseed.cfg
  preseed/url/checksum=5da499872becccfeda2c4872f9171c3d

- si está arrancando de un CD remasterizado:
  preseed/file=/cdrom/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d

- si está instalando de un medio USB (ponga el fichero de preconfiguración
  en el directorio principal de la memoria USB):
  preseed/file=/hd-media/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d
</screen></informalexample>

<para>

Tenga en cuenta que puede abreviar <filename>preseed/url</filename> a
<filename>url</filename> y <filename>preseed/file</filename> a
<filename>file</filename> cuando se pasan como parámetros al núcleo.

</para>
  </sect2>
 
  <sect2 id="preseed-bootparms">
  <title>Usar parámetros de arranque para preconfigurar preguntas</title>
<para>

Puede automatizar la instalación aún cuando no pueda utilizar el
archivo de preconfiguración para preconfigurar algunos pasos. Esto es
gracias a que se pueden preconfigurar valores en la línea de órdenes
cuando se arranca el instalador.

</para><para>

Los parámetros de arranque también pueden utilizarse cuando no quiere
realmente preconfigurar sino que sólo quiere dar una respuesta a una
pregunta concreta. Algunos de los ejemplos donde esto puede ser útil
están documentados en otras partes de este manual.

</para><para>

Para fijar un valor que vaya a utilizar &d-i;, sólo tiene que pasar
<userinput><replaceable>ruta/a/variable</replaceable>=<replaceable>valor</replaceable></userinput>
para cualquiera de las variables que se listan como ejemplos en este
apéndice. Si se va a utilizar el valor para preconfigurar paquetes en
el sistema objetivo, deberán estar precedidos por
<firstterm>propietario</firstterm><footnote>


<para>
El propietario de una variable debconf (o plantilla) normalmente es el
nombre del paquete que contiene la plantilla debconf en cuestión.  El
propietario es <quote>d-i</quote> para el caso de las variables que se
utilizan en el instalador en sí. Las plantillas y las variables pueden
tener más de un propietario, lo que ayuda a determinar si pueden
eliminarse de la base de datos de debconf si se purga el paquete.
</para>

</footnote> de la variable como sigue:
<userinput><replaceable>propietario</replaceable>:<replaceable>ruta/a/variable</replaceable>=<replaceable>valor</replaceable></userinput>.
No se copiará el valor de la variable a la base de datos de debconf
del sistema objetivo si no especifica el propietario. Por lo que no se
utilizará durante la configuración del paquete apropiado.

</para><para>

Normalmente, al preconfigurar una pregunta de esta forma, la pregunta
no se mostrará.  Para especificar un valor predeterminado para la pregunta,
y que esta se muestre, use el operador <quote>?=</quote> en lugar de
<quote>=</quote>. Consulte <xref linkend="preseed-seenflag"/>.

</para><para>

Tenga en cuenta que hay una abreviatura para las variables que se
utilizan con más frecuencia en el indicador de arranque. Los ejemplos
de este apéndice utilizan la abreviatura, si hay una disponible, en
lugar de la variable completa.  Por ejemplo, se ha abreviado la
variable <literal>preseed/url</literal> a <literal>url</literal>. Otro
ejemplo es la abreviatura <literal>tasks</literal> que se traduce a
<literal>tasksel:tasksel/first</literal>.

</para><para>

Un <quote>--</quote> en las opciones de arranque tiene un
significado especial. Los parámetros que aparezcan tras éste pueden copiarse
a la configuración del cargador de arranque que se instale (si el instalador
proporciona soporte para esa opción con el cargador de arranque
seleccionado). El instalador filtrará de forma automática cualquier
opción (como las opciones de preconfiguración) que reconozca.

</para>
<note><para>

Los núcleos actuales (2.6.9 y posteriores) aceptan hasta treinta y dos
opciones de línea de órdenes y treinta y dos opciones de entornos. Si
se exceden estos números el núcleo abortará (con un
<quote>panic</quote>). Los números eran menores en núcleos anteriores.

</para></note>
<para>

Para la mayoría de las instalaciones se pueden eliminar con seguridad
algunas de las opciones del fichero de configuración del cargado de
arranque, como por ejemplo <literal>vga=normal</literal> lo que
permite añadir más opciones para la preconfiguración.

</para>
<note><para>

No siempre es posible especificar valores con espacios para los parámetros
de arranque aunque se delimiten con comillas dobles.

</para></note>
   </sect2>

  <sect2 id="preseed-auto">
  <title>Modo «auto»</title>
<para>

Hay algunas funciones del Instalador de Debian que se combinan para
permitir que algunas entradas de línea de órdenes en el indicador del
arranque tengan como consecuencia una instalación automática adaptada
y de arbitrariedad compleja. Para mostrar estro aquí hay algunos
ejemplos que pueden utilizarse en el indicador del arranque:

<informalexample><screen>
auto url=autoservidor
</screen></informalexample>

Este valor depende de la existencia de un servidor de DHCP que hará
que la máquina llegue al punto donde <literal>autoservidor</literal>
puede resolverse por DNS quizás después de añadir un dominio local
entregado por el servidor de DHCP. Si esto se utilizara en un sitio
donde el dominio fuera <literal>ejemplo.com</literal>, y tuviera una
configuración de DHCP razonablemente correcta, esto haría que se
llegara a descargar el fichero de preconfiguración de
<literal>http://autoserver.example.com/d-i/&releasename;/./preseed.cfg</literal>.

</para><para>

La última parte de esa url (<literal>d-i/&releasename;/./preseed.cfg</literal>)
se toma de <literal>auto-install/defaultroot</literal>. Por omisión
incluye el directorio <literal>&releasename;</literal> para que versiones
futuras puedan especificar su propio nombre en clave y permita hacer
migraciones de forma controlada. El trozo <literal>/./</literal> se
utiliza para indicar la raíz, relativa a la cual se anclarán las rutas
siguientes (que se utilizará en preseed/include and preseed/run). Esto
permite que los ficheros se especifiquen o bien como una URL completa,
bien como rutas que empiezan con «/» y que están ancladas como se
mencionaba, o bien como rutas relativas a la ubicación donde se
encontró el último fichero de preconfiguración. Esto puede utilizarse
para construirse guiones más portable de forma que una jerarquía
completa de guiones puede moverse a una nueva ubicación sin
romperla. Por ejempo, copiando los ficheros a un stick USB cuando
antes estaban en un servidor web. En este ejemplo si el fichero de
preconfiguración fija <literal>preseed/run</literal> a
<literal>/scripts/orden_tardia.sh</literal> entonces este se intenta
obtener de
<literal>http://autoserver.example.com/d-i/&releasename;/./scripts/orden_tardia.sh</literal>.

</para><para>

Aún puede utilizar una URL específica si no tiene una infraestructura
de DHCP o DNS o si no quiere utilizar la ruta por omisión
<filename>preseed.cfg</filename>. Si no utiliza el elemento
<literal>/./</literal>, entonces se anclará al principio de la ruta
(esto es, al tercer <literal>/</literal> en la URL). A continuación se
muestra un ejemplo que requiere poco soporte de la infraestructura de
red local:

<informalexample><screen>
auto url=<replaceable>http://192.168.1.2/ruta/a/mipreconfiguracion.archivo</replaceable>
</screen></informalexample>

Esto funciona de la siguiente forma:
<itemizedlist spacing="compact">
<listitem><para>
si la URL no indica un protocolo se presupone que es http,
</para></listitem>
<listitem><para>
si la sección del nombre de equipo no tiene puntos se le añade el
dominio derivado del DHCP, y
</para></listitem>
<listitem><para>
si no hay ningún <literal>/</literal> tras el nombre de host se añade
la ruta por omisión.
</para></listitem>
</itemizedlist>

</para><para>

Además de indicar urls, también puede especificar los valores que no
afectan directamente al comportamiento de &d-i; pero pueden pasarse a
los programas indicados en <literal>preseed/run</literal> en el
fichero de preconfiguración cargado. De momento el único ejemplo de
esto es  <literal>auto-install/classes</literal>, que tiene la
abreviatura <literal>classes</literal>.  Puede usarse de la siguiente
forma:


<informalexample><screen>
auto url=<replaceable>ejemplo.com</replaceable> classes=<replaceable>clase_A;clase_B</replaceable>
</screen></informalexample>

Las clases podrían indicar, por ejemplo, el tipo de sistema a utilizar
o la localización a usar.

</para><para>

Por supuesto, se puede extender este concepto y, si lo hace, puede
utilizar el espacio de nombres «auto-install» para ello. Así, uno
podría tener algo como <literal>auto-install/style</literal> que
después se utilizara en sus programas. Si piensa que necesita hacerlo,
por favor, comuníquelo a la lista de correo
<email>debian-boot@lists.debian.org</email> para intentar evitar
conflictos en el espacio de nombres y para quizás añadir una
abreviatura al parámetro para vd.

</para><para>

La etiqueta de arranque <literal>auto</literal> aún no está definida
en todas las arquitecturas. Puede obtener el mismo efecto simplemente
añadiendo dos parámetros a la línea de órdenes del núcleo:
<literal>auto=true priority=critical</literal>. El parámetro
<literal>auto</literal> es una abreviatura para
<literal>auto-install/enable</literal> y controla el tiempo de espera
de las preguntas de localización y teclado para que estas se realicen
más adelante y puedan preconfigurarse. El parámetro
<literal>priority</literal> es la abreviatura de
<literal>debconf/priority</literal>, si se fija a
<literal>critical</literal> no se hará ninguna pregunta con una
prioridad inferior a ésta.

</para><para>

Algunas opciones de interés cuando intenta automatizar una instalación
utilizando DHCP son: <literal>interface=auto
netcfg/dhcp_timeout=60</literal> que hace que el sistema coja la
primera tarjeta de red disponible y sea un poco más paciente mientras
espera una respuesta a su consulta DHCP.

</para>
<tip><para>
Puede encontrar en el <ulink url="http://hands.com/d-i/">sitio web del
desarrollador</ulink> un ejemplo muy largo que muestra cómo usar esta
plataforma, el sitio incluye programas y clases de ejemplo. Los ejemplos
disponibles en esa ubicación también muestran algunos de los efectos positivos
que pueden conseguirse gracias al uso creativo de la preconfiguración.
</para></tip>

  </sect2>

  <sect2 id="preseed-aliases">
  <title>Aliases useful with preseeding</title>
<para>

Las siguientes abreviaturas pueden ser útiles cuando se utiliza
preconfiguración (en modo auto)

</para>

<!-- Setting column width does not seem to work; use non-breaking spaces
     to separate columns a bit -->
<informaltable frame="none">
<tgroup cols="2"><tbody>
<row><entry>auto</entry><entry>auto-install/enable</entry></row>
<row><entry>classes</entry><entry>auto-install/classes</entry></row>
<row><entry>fb</entry><entry>debian-installer/framebuffer</entry></row>
<row><entry>locale</entry><entry>debian-installer/locale</entry></row>
<row><entry>priority</entry><entry>debconf/priority</entry></row>
<row><entry>file</entry><entry>preseed/file</entry></row>
<row><entry>url</entry><entry>preseed/url</entry></row>
<row><entry>interface</entry><entry>netcfg/choose_interface</entry></row>
<row><entry>hostname&nbsp;&nbsp;&nbsp;</entry><entry>netcfg/get_hostname</entry></row>
<row><entry>domain</entry><entry>netcfg/get_domain</entry></row>
<row><entry>protocol</entry><entry>mirror/protocol</entry></row>
<row><entry>suite</entry><entry>mirror/suite</entry></row>
</tbody></tgroup>
</informaltable>

  </sect2>
 
 <sect2 id="preseed-dhcp">
 <title>Utilizar un servidor DHCP para especificar los ficheros de preconfiguración</title>
<para>

También es posible utilizar DHCP para especificar un fichero de preconfiguración
que se debe descargar de la red. El protocolo DHCP permite especificar
un archivo. Generalmente este es un archivo para el arranque en red,
pero si parece ser un URL entonces el medio de instalación que soporte
preconfiguración vía red descargará un fichero de la URL y lo utilizará
como un fichero de preconfiguración. A continuación se muestra un ejemplo
de cómo configurar el dhcp.conf de la versión 3 del servidor de DHCP de
ISC (el paquete Debian dhcp3-server).
</para>

<informalexample><screen>
if substring (option vendor-class-identifier, 0, 3) = "d-i" {
    filename "http://servidor/preconfiguracion.cfg";
}
</screen></informalexample>

<para>

Tenga en cuenta que el ejemplo anterior limita la entrega de este nombre
de fichero a clientes DHCP que se idenfiquen como «d-i». De esta forma
no se afectará a clientes DHCP normales sino sólo al instalador. También
puede poner ese texto en la definición de un sistema específico para
evitar preconfigurar todas las instalaciones que se hagan en su red.

</para><para>

Una buena forma de hacer uso de la preconfiguración de DHCP es sólo
preconfigurar los valores específicos a su red, como puedan ser la
réplica Debian a utilizar. De esta forma todas las instalaciones en su
red cogerán automáticamente la réplica adecuada, mientras que el resto
de la instalación se realizará de forma interactiva. Deberá tener
cuidado si quiere utilizar preconfiguración DHCP para automatizar
la instalación completa de Debian.

</para>
  </sect2>

</sect1>
 <sect1 id="preseed-creating">
 <title>Crear un fichero de preconfiguración</title>
<para>

El fichero de preconfiguración tiene el formato que utiliza la orden
<command>debconf-set-selections</command>.
El formato general para una línea del fichero de preconfiguración es:

<informalexample><screen>
&lt;propietario&gt; &lt;nombre de la pregunta&gt; &lt;tipo de pregunta&gt; &lt;valor&gt;
</screen></informalexample>

</para><para>

Existen algunas reglas a tener en cuenta cuando se escribe un fichero
de preconfiguración.


</para>

<itemizedlist>
<listitem><para>
  Sólo se permite un espacio entre tipo de plantilla y valor. Cualquier
  espacio adicional se considerará que pertenece al valor.
</para></listitem>
<listitem><para>
 Se puede dividir una línea en múltiples líneas si se añade un barra invertida
 (<quote><literal>\</literal></quote>) como carácter de continuación de línea.
 Un buen punto para la divisón de la linea es después del nombre de la
 pregunta. Es mala idea dividir la línea entre el tipo y el valor.  Las líneas
 con saltos se unirán en una sola línea con todo el espacio al principio y al
 final condensado en un solo espacio.

 </para></listitem>
 <listitem><para>
  Para las variables debconf(plantillas) que se usan en el instalador, el
  dueño debería ser <quote>d-i</quote>; para preconfigurar las variables
  que se usan en el sistema instalado, debería coincidir el nombre de la
  plantilla debconf correspondiente con el nombre del paquete.  Solamente
  se propagarán las variables que tengan el dueño distinto a
  <quote>d-i</quote> en la base de datos para el sistema instalado.
</para></listitem>
<listitem><para>
  La mayoría de las preguntas tienen que preconfigurarse con los
  valores que sean válidos en inglés y no en las traducciones de esos mismos
  valores. Hay algunas preguntas, sin embargo (como es el caso de
  <classname>partman</classname>) donde se tienen que utilizar los valores
  traducidos.
 </para></listitem>
 <listitem><para>
  Algunas preguntas toman un código como valor en lugar del campo
  de texto mostrado durante la instalación (en inglés).
 </para></listitem>
</itemizedlist>

<para>

La forma más sencilla para crear un fichero de configuración es utilizar
como base el ejemplo enlazado en <xref linkend="preseed-contents"/> y
trabajar a partir de ahí.

</para><para>

Un método alternativo es realizar una instalación manual y, tras el
rearranque, utilizar <command>debconf-get-selections</command>, disponible
en el paquete <classname>debconf-utils</classname>, para volcar
la base de datos de debconf y la base de datos cdebconf del instalador en un sólo fichero.

<informalexample><screen>
$ debconf-get-selections --installer &gt; <replaceable>fichero</replaceable>
$ debconf-get-selections &gt;&gt; <replaceable>fichero</replaceable>
</screen></informalexample>

</para><para>

Sin embargo, un fichero generado de esta forma tendrá algunos elementos que no
deberían preconfigurarse. Lo recomendable para la mayoría de los usuarios es
empezar con el fichero de ejemplo.

</para>

<note><para>

Este método se basa en el hecho de que al final de la instalación
la base de datos «cdebconf» del instalador se guarda en el sistema instalado en
<filename>/var/log/installer/cdebconf</filename>. Dado que esta base de datos
puede conetener información sensible sólo la puede leer, por omisión, el
superusuario.

</para><para>

Si purga el paquete
<classname>installation-report</classname> se eliminará el directorio
<filename>/var/log/installer</filename> y todos los ficheros en él
incluidos de su sistema.

</para></note>

<para>

Puede utilizar <command>nano</command> para comprobar los posibles
valores de las preguntas, examinando los ficheros en <filename>/var/lib/cdebconf</filename> durante una instalación que está en progreso. Consulte
<filename>templates.dat</filename> si quiere las plantillas en crudo
o <filename>questions.dat</filename> si quiere consultar los valores
actuales y asignados a las variables.

</para><para>


Para comprobar si el formato de su fichero de preconfiguración es válido
antes de hacer una instalación puede utilizar la orden
<command>debconf-set-selections -c <replaceable>preseed.cfg</replaceable></command>.

</para>
 </sect1>

 <sect1 id="preseed-contents">
 <title>Contenidos del fichero de preconfiguración(para &releasename;)</title>
<para>

Los fragmentos de configuración que se utilizan en este apéndice también están
disponible como un ejemplo de fichero de preconfiguración en
&urlset-example-preseed;.

</para><para>

Tenga en cuenta que este ejemplo está basado en una instalación para la
arquitectura Intel x86. Si está instalando en otra arquitectura no serán
relevantes algunos de los ejemplos (como la seleccio de teclado o la
instalación del cargador) y tendrá que reemplazarlos por los valores de debconf
más apropiados a su arquitectura.

</para>

  <sect2 id="preseed-l10n">
  <title>Localización</title>
<para>

La configuración de los valores de localización sólo funcionará si está
utilizando preconfiguración a través de initrd. Con cualquier otro método
el fichero de preconfiguración se cargará después de haber hecho estas preguntas.

</para><para>

<!-- N del T: En el texto original utiliza en_US, aquí cambiamos a es_ES -->
La localización puede utilizarse para especificar tanto el idioma como el país
y puede usarse cualquier combinación de idioma y país reconocido soportados
por el &d-i;.  Si la combinación no constituye una localización válida, el
instalador seleccionará automáticamente una localización válida para el
idioma seleccionado.
Puede utilizar
<userinput>locale=<replaceable>es_ES</replaceable></userinput>.
para especificar la localización como un parámetro de arranque.

<informalexample role="example"><screen>
# Configuración de localización para el idioma y país.
d-i debian-installer/locale string es_ES
</screen></informalexample>

</para><para>

La configuración del teclado consiste en la selección de una arquitectura
de teclado y un mapa de teclado. En la mayor parte de los casos se selecciona
una arquitectura de teclado correcta por omisión y no es necesario preconfigurarla.
El mapa de teclado debe ser conocido por el &d-i; para la arquitectura de teclado
seleccionada.

<informalexample role="example"><screen>
# Selección de teclado
#d-i console-tools/archs select at
d-i console-keymaps-at/keymap select us
# Ejemplo de cómo configurar una arquitectura de teclado distinta
#d-i console-keymaps-usb/keymap select mac-usb-us
</screen></informalexample>

</para><para>

Para obviar la configuración de teclado preconfigure
<classname>console-tools/archs</classname> con
<userinput>skip-config</userinput>.
Esto hará que sea el mapa de teclado del núcleo el permanezca activo.

</para>

<note><para>

Los cambios en la capa de entrada para los núcleos 2.6 han hecho que la
arquitectura de teclado esté practicamente obsoleta. En el caso de los núcleos
2.6 debería seleccionarse generalmente un mapa de teclado <quote>PC</quote>
(<userinput>at</userinput>).

</para></note>
  </sect2>

  <sect2 id="preseed-network">
  <title>Configuración de red</title>
<para>

Por supuesto, no funcionará la preconfiguración de la tarjeta de red si está
obteniendo el fichero de preconfiguración de la red. Pero esta opción es muy
cómoda cuando está arrancando de un CD o memoria USB. Si carga ficheros de
preconfiguración de la red puede dar los parámetros de configuración de la red
a través de parámetro de arranque del núcleo.

</para><para>

Tiene que utilizar un parámetro de arranque similar a
<userinput>interface=<replaceable>eth1</replaceable></userinput>
si tiene que escoger un interfaz particular durante el arranque vía red antes
de cargar el fichero de preconfiguración de la red.

</para><para>

Aunque generalmente no es posible preconfigurar la red cuando se hace
preconfiguración de red (al utilizar <quote>preseed/url</quote>), puede
utilizar este truco para evitar esto si, por ejemplo, quiere conifgurar una
dirección estática a la interfaz de red. El truco es obligar a que la
configuración de red se ejecute de nuevo después de haber cargado el fichero de
preconfiguración creando un programa <quote>preseed/run</quote> con las
siguientes órdenes:

<informalexample><screen>
killall.sh; netcfg
</screen></informalexample>

</para><para>

Las siguientes variables debconf son relevantes para configuración de red.

</para>

<informalexample role="example"><screen>
# netcfg escojerá la interfaz que tiene enlace si puede. Esto hace que no
# muestre la lista si hay más de uno.
d-i netcfg/choose_interface select auto

# Escoger una interfaz específica en lugar de la encontrada:
#d-i netcfg/choose_interface select eth1

# Si tiene un servidor de DHCP lento y el instalador expira intentando
# conectarse a él, esto puede serle útil.
#d-i netcfg/dhcp_timeout string 60

# Así es como puede configurar la red manualmente descomentando esta línea
# y las líneas de configuración estática de red a continuación.
#d-i netcfg/disable_dhcp boolean true

# Si quiere que el fichero de preconfiguración funcione tanto en
# sistemas con un servidor de DHCP como en los que no lo tengan, tendrá
# que descomentar estas líneas y añadir la configuración estática de red
# a continuación.
#d-i netcfg/dhcp_failed note
#d-i netcfg/dhcp_options select Configure network manually

# Configuración estática de red
#d-i netcfg/get_nameservers string 192.168.1.1
#d-i netcfg/get_ipaddress string 192.168.1.42
#d-i netcfg/get_netmask string 255.255.255.0
#d-i netcfg/get_gateway string 192.168.1.1
#d-i netcfg/confirm_static boolean true

# Cualquier nombre de host y de dominio que se obtengan por DHCP se utilizan
# antes que los valores aquí definidos. Sin embargo, definir los valores evita
# que la pregunta se muestre aunque los valores vengan del DHCP.
d-i netcfg/get_hostname string unassigned-hostname
d-i netcfg/get_domain string unassigned-domain

# Deshabilitar el molesto mensaje sobre la clave WEP
d-i netcfg/wireless_wep string
# El nombre de servidor raro que algunos ISP utilizan como una especie de contraseña
#d-i netcfg/dhcp_hostname string radish

# Si se requiere firmware no libre para la red o para otro dispositivo, puede
# configurar el instalador para que siempre intente cargarlo, sin preguntar. O
# cambiar a falso para inhibir la pregunta.
#d-i hw-detect/load_firmware boolean true
</screen></informalexample>

<para>

Tenga en cuenta que <command>netcfg</command> determinará automáticamente la
máscara de red si <classname>netcfg/get_netmask</classname> no está presente.
En cuyo caso, la variable tiene que marcarse como <literal>vista</literal> en
el caso de instalaciones automáticas.  De la misma forma,
<command>netcfg</command> elegirá una dirección apropiada si
<classname>netcfg/get_gateway</classname> no ha sido establecida. La excepción
es establecer a <classname>netcfg/get_gateway</classname> en <quote>none</quote>
para especificar que no se debería usar puerta de enlace alguna.

</para>

  </sect2>

  <sect2 id="preseed-mirror">
  <title>Configuración de la réplica</title>
<para>

Dependiendo del método de instalación que uitlice se utilizará una
réplica tanto para descargar componentes adicionales del instalador
como para instalar el sistema base y para configurar
<filename>/etc/apt/sources.list</filename> en el sistema instalado.

</para><para>

El parámetro <classname>mirror/suite</classname> determina la versión
(<quote>suite</quote>, n. del t.) que utiliza el sistema instalado.

</para><para>

El parámetro <classname>mirror/udeb/suite</classname> determina la
<quote>suite</quote> de los componentes adicionales del
instalador. Sólo es necesario estabelecer este valor si se llegan a
descargar componentes a través de la red y debería coincidir con el
valor que se utilizó para construir el initrd para el método de
instalación utilizado. Por omisión, el valor de
<classname>mirror/udeb/suite</classname> es el mismo que el dado a
<classname>mirror/suite</classname>.

</para>

<informalexample role="example"><screen>
# No tiene que definir la cadena mirror/country si selecciona ftp
#d-i mirror/protocol string ftp
d-i mirror/country string manual
d-i mirror/http/hostname string &archive-mirror;
d-i mirror/http/directory string /debian
d-i mirror/http/proxy string

# Versión a instalar.
#d-i mirror/suite string testing
# Versión a utilizar para descargar componentes de la instalación
# (opcional)
#d-i mirror/udeb/suite string testing
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-time">
  <title>Configuración del reloj y zona horaria</title>

<informalexample role="example"><screen>
# Controla si el reloj del sistema debe establecerse a UTC.
d-i clock-setup/utc boolean true

# Puede establecer este a cualquier valor válido para $TZ;
# consulte en los contenidos de /usr/share/zoneinfo/ para hallar
# valores válidos.
d-i time/zone string US/Eastern

# Controla si se usará NTP para establecer el reloj durante la
# instalación
d-i clock-setup/ntp boolean true
# Servidores NTP a usar. El predeterminado sería el mejor en
# general.
#d-i clock-setup/ntp-server string ntp.example.com
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-partman">
  <title>Particionado</title>
<para>

La utilización de la preconfiguración para particionar el disco duro
está limitada a lo que <classname>partman-auto</classname> pueda
permitir. Puede elegir o bien particionar el espacio libre en el disco
o todo el disco. La distribución del disco puede basarse en una receta
existente o utilizar una receta de un fichero o una receta incluída en
el fichero de preconfiguración. Actualmente no es posible utilizar la
preconfiguración para particionar más de un disco.

</para>

<warning><para>

La identificación de los discos depende del order en el que se
cargaron las unidades. Asegúrese de utilizar el disco correcto antes
de configurarlo si el sistema tiene más de un disco.

</para></warning>

<informalexample role="example"><screen>
# Si el sistema tiene espacio libre puede elegir particionar solamente
# este espacio.
#d-i partman-auto/init_automatically_partition select biggest_free

# También puede especificar un disco a particionar. El nombre del
# dispositivo se se debe especificar en formato tradicional no devfs.
# Nota: Debe especificar un disco, a menos que el sistema tenga uno
# solo.  Por ejemplo, para usar el primer disco SCSI/SATA:
#d-i partman-auto/disk string /dev/sda
# Además, debe especificar el método a utilizar.
# Los métodos disponibles actualmente son: "regular", "lvm" y "crypto"
d-i partman-auto/method string lvm

# Si alguno de los discos que va a ser automaticamente particionado
# contiene una configuración antigua de LVM se le presentaría un
# aviso al usuario. Esto puede preconfigurarse para que no aparezca:
d-i partman-lvm/device_remove_lvm boolean true
# De la misma forma para arreglos por RAID por software pre existentes:
d-i partman-md/device_remove_md boolean true
# Y lo mismo pasa con la confirmación para escribir las particiones
# lvm.
d-i partman-lvm/confirm boolean true

# Puede elegir cualquiera de las tres recetas de particionado
# predefinidas:
# - atomic: todos los ficheros en una partición
# - home:   separa la partición /home
# - multi:  separar las particiones /home, /usr, /var y /tmp
d-i partman-auto/choose_recipe select atomic

# O indicar su propia receta...
# El formato de las recetas está documentado en el fichero
# devel/partman-auto-recipe.txt.
# Si tiene una forma de colocar el fichero de receta dentro del entorno
# del d-i, simplemente puede direccionarlo a éste.
#d-i partman-auto/expert_recipe_file string /hd-media/recipe

# Si no, puede colocar la receta completa en el fichero de
# preconfiguración en una única línea (lógica).
# Este ejemplo crea una pequeña partición /boot, una
# partición de intercambio apropiada y usa el resto del espacio para
# la partición raíz:
#d-i partman-auto/expert_recipe string                         \
#      boot-root ::                                            \
#              40 50 100 ext3                                  \
#                      $primary{ } $bootable{ }                \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ /boot }                     \
#              .                                               \
#              500 10000 1000000000 ext3                       \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ / }                         \
#              .                                               \
#              64 512 300% linux-swap                          \
#                      method{ swap } format{ }                \
#              .

# La siguiente receta hace que «partman» particione automáticamente el
# espacio sin confirmación, en caso de que usted haya indicado qué hacer
# con uno de los métodos mencionados anteriormente.
d-i partman/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-partman-raid">
  <title>Particionar con RAID</title>
<para>

También puede utilizar la preconfiguración para configurar las
particiones en arrays RAID por software. Se puede utilizar para
niveles RAID 0, 1 y 5, 6 y 10 creando arrays degradados y especificando
dispositivos libres.
Puede configurar grub para que se instale en todos los dispositivos
utilizados en el array si está utilizando RAID 1, consulte <xref
linkend="preseed-bootloader"/>.

</para>

<warning><para>

Es fácil equivocarse en este tipo de particionado automático. También
es una funcionalidad que es poco probada por los desarrolladores del
&d-i;.  El usuario es responsable de aplicar bien las posibles
recetas bien (de forma que tengan sentido y no entren en conflicto).
Si tiene problemas compruebe
<filename>/var/log/syslog</filename>.


</para><para>

Tenga en cuenta que los desarrolladores de este componente han probado
sólo RAID 0 y RAID 1. No se ha probado aún RAID 5. Sólo se ha probado
ligeramente la configuración de RAID avanzados con arrays degradados o
dispositivos libres.

</para></warning>

<informalexample><screen>
# AVISO: esta opción es de calidad beta y debería utilizarse con
# cuidado.

# Debería fijarse el método a "raid".
#d-i partman-auto/method string raid
# Specificar los discos a particionar. Deberían tener la misma
# distribución por lo que esto sólo funcionará si los discos son del
# mismo tamaño.
#d-i partman-auto/disk string /dev/discs/disc0/disc /dev/discs/disc1/disc

# A continuación, tiene que especificar las particiones físicas que se
# utilizarán.
#d-i partman-auto/expert_recipe string \
#      multiraid ::                                         \
#              1000 5000 4000 raid                          \
#                      $primary{ } method{ raid }           \
#              .                                            \
#              64 512 300% raid                             \
#                      method{ raid }                       \
#              .                                            \
#              500 10000 1000000000 raid                    \
#                      method{ raid }                       \
#              .

# Por último, tiene que especificar cómo van a utilizarse las
# particiones antes definidas en la configuración RAID. Recuerde que
# tiene que utilizar los números de partición correctos para las
# particiones lógicas.
# Los parámetros son
# &lt;raidtype&gt; &lt;devcount&gt; &lt;sparecount&gt; &lt;fstype&gt; &lt;mountpoint&gt; \
#          &lt;devices&gt; &lt;sparedevices&gt;
# Se soportan los niveles RAID 0, 1 y 5,6 y 10; los dispositivos se separan
# con "#"
#d-i partman-auto-raid/recipe string \
#    1 2 0 ext3 /                                           \
#          /dev/discs/disc0/part1#/dev/discs/disc1/part1    \
#    .                                                      \
#    1 2 0 swap -                                           \
#          /dev/discs/disc0/part5#/dev/discs/disc1/part5    \
#    .                                                      \
#    0 2 0 ext3 /home                                       \
#          /dev/discs/disc0/part6#/dev/discs/disc1/part6    \
#    .

# Esto hace que partman particione de forma automática sin
# confirmación.
d-i partman-md/confirm boolean true
d-i partman/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-base-installer">
  <title>Configuración del sistema base</title>
<para>

No hay mucho que se pueda preconfigurar en esta etapa de la
instalación. La única pregunta concerniente a la instalación
refiere al núcleo.

</para>

<informalexample role="example"><screen>
# Seleccione el generador de initramfs que se emplee para generar
# el initrd para los núcleos 2.6,
#d-i base-installer/kernel/linux/initramfs-generators string yaird

# El (meta) paquete de la imagen del núcleo que se vaya a instalar;
# puede usar "none" si no se ba a instalar núcleo.
#d-i base-installer/kernel/image string linux-image-2.6-486
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-account">
  <title>Configuración de cuentas de usuario</title>
<para>

Puede preconfigurarse la contraseña para la cuenta del superusuario
(<quote>root</quote>) y el nombre y la contraseña de la primera cuenta
de usuario normal. Para las contaseñas se pueden utilizar tanto
<emphasis>hashes</emphasis> MD5 como valores en texto plano .

</para>
<warning><para>

Tenga en cuenta que la preconfiguración de la contraseña no es un
proceso seguro dado que cualquiera que pueda acceder a los ficheros de
preconfiguración podrá conocer las contraseñas. De cara a la seguridad
es un poco mejor la utilización de hashes MD5 pero también da un falso
sentido de la seguridad ya que el acceso al hash MD5 permite llevar a
cabo ataques de fuerza bruta sobre la contraseña.

</para></warning>

<informalexample role="example"><screen>
# No crear una cuenta de superusuario (la cuenta del usuario normal
# utilizar sudo).
#d-i passwd/root-login boolean false
# Igualmente, se puede omitir la creación de una cuenta de un usuario
# normal.
#d-i passwd/make-user boolean false

# Contraseña del superusuario, bien en texto en claro
#d-i passwd/root-password password r00tme
#d-i passwd/root-password-again password r00tme
# o cifrada utilizando un hash MD5
#d-i passwd/root-password-crypted password [MD5 hash]

# Para crear una cuenta de un usuario:
#d-i passwd/user-fullname string Debian User
#d-i passwd/username string debian
# Contraseña del usuario normal, bien en texto en claro:
#d-i passwd/user-password password insecure
#d-i passwd/user-password-again password insecure
# o cifrada utilizando un hash MD5.
#d-i passwd/user-password-crypted password [MD5 hash]
# Crea el primer usuario con el UID especificado en lugar del
# predeterminado.
#d-i passwd/user-uid string 1010

# La cuenta de usuario se añadirá a ciertos grupos especiales. Para
# cambiarlos, use lo siguiente:
#d-i passwd/user-default-groups string audio cdrom video
</screen></informalexample>

<para>

También se pueden preconfigurar las variables
<classname>passwd/root-password-crypted</classname> y
<classname>passwd/user-password-crypted</classname> utilizando como
valor <quote>!</quote>. Si hace esto para cualquiera de las dos
cuentas ésta se deshabilitará. Esto puede ser de ayuda para el caso de
la cuenta de superusuario, siempre que tenga un mecanismo alternativo
para poder llevar a cabo tareas de administración o acceder como
superusuario (como por ejemplo, la utilización de autenticación en SSH
mediante ficheros de clave pública o <command>sudo</command>).

</para><para>

Puede generar un hash MD5 para una contraseña con la siguiente orden:

<informalexample><screen>
$ printf "r00tme" | mkpasswd -s -m md5
</screen></informalexample>

</para>
  </sect2>

  <sect2 id="preseed-apt">
  <title>Configuración de APT</title>
<para>

Tanto la configuración de <filename>/etc/apt/sources.list</filename> como
las opciones de configuraciones básicas se automatizan completamente de
acuerdo al método de instalación y las respuestas a preguntas anteriores.
Puede opcionalmente colocar otros repositorios(locales).

</para>

<informalexample role="example"><screen>
# Puede elegir instalar software de «non-free» y «contrib».
#d-i apt-setup/non-free boolean true
#d-i apt-setup/contrib boolean true
# Descomente lo siguiente si no quiere usar una réplica en red.
#d-i apt-setup/use_mirror boolean false
# Seleccione qué servicios de actualización desea usar; defina
# las réplicas en red a usar.
# Los valores mostrados son los predeterminados.
#d-i apt-setup/services-select multiselect security, volatile
#d-i apt-setup/security_host string security.debian.org
#d-i apt-setup/volatile_host string volatile.debian.org

# Repositorios locales, disponibles local[0-9]
#d-i apt-setup/local0/repository string \
#       http://local.server/debian stable main
#d-i apt-setup/local0/comment string local server
# Habilitar las líneas deb-src
#d-i apt-setup/local0/source boolean true
# URL de la llave pública del repositorio local; debe proveer una llave o
# apt se quejará acerca la falta de autenticidad del repsoirtorio y
# la línea en sources.list se dejará comentada
#d-i apt-setup/local0/key string http://local.server/key

# El instalador exige por omisión que los repositorios estén autenticados
# con una llave gpg conocida.  Puede usar esta opción para deshabilitar
# la autenticación.  Advertencia: es inseguro y no recomendado.
#d-i debian-installer/allow_unauthenticated boolean true
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-pkgsel">
  <title>Selección de paquetes</title>
<para>

Puede elegir la instalación de cualquier combinación de las tareas que
están disponibles. Las tareas disponibles en el momento de escribir
estas líneas incluyen:

</para>

<itemizedlist>
<listitem><para>
  <userinput>Sistema estándar («standard»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Entorno de escritorio («desktop»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Entorno de escritorio GNOME («gnome-desktop»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Entorno de escritorio KDE («kde-desktop»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Servidor web («web-server»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Servidor de impresoras («print-server»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Servidor de DNS («dns-server»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Servidor de ficheros («file-server»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Servidor de correos («mail-server»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Base de datos SQL («sql-database»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Ordenador portátil («laptop»)</userinput>
</para></listitem>
</itemizedlist>

<para>

También puede no seleccionar ninguna tarea y forzar la instalación de un
conjunto de paquetes de alguna otra forma. Le recomendamos que siempre
introduzca la tarea <userinput>Sistema estándar</userinput>.

</para><para>

Puede utilizar el parámetro <classname>pkgsel/include</classname> para
instalar paquetes individuales además de los paquetes que instalan las
tareas. Este parámetro toma valores que pueden estar separados por
comas o por espacios, de forma que puede utilizar fácilmente en la
línea de órdenes del núcleo.

</para>

<informalexample role="example">
<screen>
#tasksel tasksel/first multiselect standard, web-server
# Si la tarea escritorio se selecciona, instalar los escritorios
# kde y xfce en lugar del escritorio predeterminado gnome.
#tasksel tasksel/desktop multiselect kde, xfce

# Paquetes individuales que también se instalan
#d-i pkgsel/include string openssh-server build-essential
# En caso de querer hacer actualización de paquetes después
# de debootstrap.
# Valores posibles: none, safe-upgrade, full-upgrade
#d-i pkgsel/upgrade select none

# Algunas versiones del instalador pueden informar de las versiones
# de programas que tiene instalados y los programas que utiliza.
# Por omisión, no se envía ningún informe, pero estos informes
# ayudan al proyecto a determinar qué programas son más populares
# y deben incluirse en los CDs
#popularity-contest popularity-contest/participate boolean false
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-bootloader">
  <title>Instalación del cargador de arranque</title>

<informalexample role="example"><screen>
# Grub es el gestor de arranque predeterminado (para arquitectura x86).
# Descomente esta opción si quiere instalar lilo en su lugar:
#d-i grub-installer/skip boolean true
# Si quiere omitir la instalación de lilo, y no usar un gestor de arranque
# descomente también esta línea:
#d-i lilo-installer/skip boolean true

# Esta es una configuración adecuada y segura, hace que grub se instale
# automáticamente en el MBR si no se detecta otro sistema operativo en
# la máquina.
d-i grub-installer/only_debian boolean true

# Lo siguiente hace que el «grub-installer» instale en el MBR en caso de
# que se encuentre instalado otro sistema operativo. Esto es menos seguro puesto
# que podría hacer que el otro sistema operativo no se pudiera arrancar.
d-i grub-installer/with_other_os boolean true

# Alternativamente, descomente y edite estas líneas
# si desea instalar en una ubicación distinta al MBR:
#d-i grub-installer/only_debian boolean false
#d-i grub-installer/with_other_os boolean false
#d-i grub-installer/bootdev  string (hd0,0)
# Para instalar grub en múltiples discos:
#d-i grub-installer/bootdev  string (hd0,0) (hd1,0) (hd2,0)

# Clave opcional para grub, bien sea en texto plano
#d-i grub-installer/password password r00tme
#d-i grub-installer/password-again password r00tme
# o encriptada usando un hash MD5, consulte grub-md5-crypt(8).
#d-i grub-installer/password-crypted password [MD5 hash]
</screen></informalexample>

<para>

Con la orden <command>grub-md5-crypt</command>, o con la orden del ejemplo en
<xref linkend="preseed-account"/> se puede generar una clave hash MD5 para
<classname>grub</classname>.

</para>
  </sect2>

  <sect2 id="preseed-finish">
  <title>Finalizar la instalación</title>

<informalexample role="example"><screen>
# En installations desde la consola serial, las consolas virutales usuales
# (VT1-VT6) están deshabilitadas normalmente en /etc/inittab. Descomente
# la siguiente línea para evitar este comportamiento:
#d-i finish-install/keep-consoles boolean true

# Omitir el mensaje final sobre la finalización de la instalación.
d-i finish-install/reboot_in_progress note

# Esta opción impedirá que el instalador expulse el CD durante
# el reinicio, y puede ser útil en algunas circunstancias:
#d-i cdrom-detect/eject boolean false

# Para hacer que el sistema se detenga cuando termine la instalación en
# lugar de reiniciar al sistema instalado:
#d-i debian-installer/exit/halt boolean true
# Para apagar la máquina en lugar de detenerla:
#d-i debian-installer/exit/poweroff boolean true
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-other">
  <title>Preconfiguración de otros paquetes</title>

<informalexample role="example"><screen>
# Dependiendo del software que elija instalar, o si las cosas no salen
# bien durante el proceso de instalación, es posible que se formulen
# otra preguntas. Por supuesto también puede preconfigurar éstas.
# Para obtener una lista de cada pregunta posible que podría llegar a ser
# formulada durante una instalación puede hacer una instalación y
# ejecutar estas órdenes:
#   debconf-get-selections --installer > file
#   debconf-get-selections >> file
</screen></informalexample>

  </sect2>
 </sect1>

 <sect1 id="preseed-advanced">
 <title>Opciones avanzadas</title>

  <sect2 id="preseed-hooks">
  <title>Ejecutar órdenes a medida durante la instalación</title>
<para>

Una opción muy potente y flexible que se ofrece con las herramientas
de preconfiguración es la capacidad de ejecutar órdenes o programas en
distintos puntos de la instalación.

</para>


<informalexample role="example"><screen>
# La preconfiguración de d-i es inherentemente insegura. Ninguna parte del
# instalador verifica intentos de desbordamiento de buffer u otras
# formas de malversación de los valores de un fichero de preconfiguración
# como éste. ¡Use solamente ficheros de preconfiguración de fuentes
# confiables! Para poder gestionar esto, y porque generalmente es útil,
# a continuación ofrecemos una forma de ejecutar automáticamente cualquier
# orden de shell que desee dentro del instalador.

# Esta primera orden se ejecuta tan pronto como sea posible, después de que
# se lea el fichero de preconfiguración:
#d-i preseed/early_command string anna-install some-udeb

# Ésta orden se ejecuta justamente antes de que finalice la instalación,
# pero cuando todavía existe un directorio /target usable. Puede
# hacer un chroot a /target y utilizarlo directamente o utilizar las
# órdenes apt-install e «in-target» para instalar fácilmente paquetes
# y ejecutar órdenes en el sistema objetivo
#d-i preseed/late_command string apt-install zsh; in-target chsh -s /bin/zsh
</screen></informalexample>

  </sect2>

 
  <sect2 id="preseed-seenflag">
  <title>Utilizar la preconfiguración para cambiar valores por omisión</title>
<para>

Es posible utilizar la preconfiguración para cambiar la respuesta por
omisión para una pregunta, pero manteniendo la pregunta de forma que
ésta se haría en cualquier caso. Para hacer esto tiene que resetar el
campo <firstterm>seen</firstterm> (n. del t., «visto») a
<quote>false</quote> después de fijar el valor para la pregunta.

<informalexample><screen>
d-i foo/bar string value
d-i foo/bar seen false
</screen></informalexample>

Puede conseguir el mismo efecto en  <emphasis>todas</emphasis> las preguntas
sin más que configurar el parámetro <classname>preseed/interactive=true</classname>
en el indicador de arranque. Esta opción puede ser útil para probar o depurar
su fichero de preconfiguración.

</para><para>

Puede hacer que el instalador le pregunte una pregunta específica utilizando
el operador <quote>?=</quote> si está preconfigurando con parámetros del arranque.
Por ejemplo,
<userinput><replaceable>foo</replaceable>/<replaceable>bar</replaceable>?=<replaceable>value</replaceable></userinput>.

Esta opción sólo tendrá utilidad en el caso de parámetros que correspondan a
preguntas que se muestran durante la instalación y no para el caso de parámetros
<quote>internos</quote>.

</para>

  </sect2>

  <sect2 id="preseed-chainload">
  <title>Carga de archivos de configuración en cadena</title>
<para>

Si lo desea puede incluir otros ficheros de preconfiguración en éste.
Cualquier configuración en estos ficheros modificará los valores
preexistentes de este fichero. Esto permite, por ejemplo, poner la
configuración general de red para su ubicación en un fichero y poner
configuraciones más específicas para algunas configuraciones en otros
ficheros.

</para>

<informalexample><screen>

# Se puede listar más de un fichero, separado por espacios y se cargarán
# todos. Los ficheros incluidos también pueden tener directivas propias
# de preconfiguración o inclusión. Tenga en cuenta que si los nombres de
# fichero son relativos, éstos se toman del mismo directorio donde se
# ubica el fichero que los incluye.
#d-i preseed/include string x.cfg

# El instalador puede, opcionalmente, verificar las sumas de control
# de los ficheros de preconfiguración antes de utilizarlos. De momento
# sólo se pueden utilizar sumas MD5. Debe listar las sumas MD5 en el
# mismo orden en el que lista los ficheros a incluir.
#d-i preseed/include/checksum string 5da499872becccfeda2c4872f9171c3d


# Esta opción es todavía más flexible: se ejecuta una orden de shell y
# se incluyen nuevos ficheros si ésta imprime los nombres de otrs
# ficheros de preconfiguración.
#d-i preseed/include_command \
#      string if [ "`hostname`" = bob ]; then echo bob.cfg; fi

# Lo más flexible es descargar un programa y ejecutarlo. El programa
# puede utilizar órdenes como debconf-set para manipular la base de datos
# de debconf.
# Puede listar más de un programa, separándolos entre sí con espacios.
# Tenga en cuenta que los nombres de los archivos son relativos,
# se obtienen del mismo directorio donde está el archivo de preconfiguración
# que los ejecuta.
#d-i preseed/run string foo.sh
</screen></informalexample>

<para>

También es posible cargar en cadena desde el initrd o la fase de
preconfiguración de fichero en la preconfiguración con red
configurando preseed/url en los ficheros antriores. Esto hará que la
preconfiguración de la red se realice antes de configurar la red. Ha
de tener cuidado cuando hace esto ya que habrá dos ejecuciones
independientes de la pregconfiguación. Lo que significa que tiene dos
oportunidades para ejecutar la orden preseed/early command, la segunda
tendrá lugar justo después de que se habilite el acceso a la red.

</para>

  </sect2>
 </sect1>
</appendix>
