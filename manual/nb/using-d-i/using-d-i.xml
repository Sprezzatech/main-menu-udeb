<!-- Start of file using-d-i/using-d-i.xml -->
<!-- $Id: using-d-i.xml 56428 2008-10-15 09:35:28Z fjp $ -->


 <chapter id="d-i-intro"
><title
>Using the Debian Installer</title>

 <sect1
><title
>How the Installer Works</title>
<para
>The Debian Installer consists of a number of special-purpose components to perform each installation task. Each component performs its task, asking the user questions as necessary to do its job. The questions themselves are given priorities, and the priority of questions to be asked is set when the installer is started. </para
><para
>When a default installation is performed, only essential (high priority) questions will be asked. This results in a highly automated installation process with little user interaction. Components are automatically run in sequence; which components are run depends mainly on the installation method you use and on your hardware. The installer will use default values for questions that are not asked. </para
><para
>If there is a problem, the user will see an error screen, and the installer menu may be shown in order to select some alternative action. If there are no problems, the user will never see the installer menu, but will simply answer questions for each component in turn. Serious error notifications are set to priority <quote
>critical</quote
> so the user will always be notified. </para
><para
>Some of the defaults that the installer uses can be influenced by passing boot arguments when &d-i; is started. If, for example, you wish to force static network configuration (DHCP is used by default if available), you could add the boot parameter <userinput
>netcfg/disable_dhcp=true</userinput
>. See <xref linkend="installer-args"/> for available options. </para
><para
>Power users may be more comfortable with a menu-driven interface, where each step is controlled by the user rather than the installer performing each step automatically in sequence. To use the installer in a manual, menu-driven way, add the boot argument <userinput
>priority=medium</userinput
>. </para
><para
>If your hardware requires you to pass options to kernel modules as they are installed, you will need to start the installer in <quote
>expert</quote
> mode. This can be done by either using the <command
>expert</command
> command to start the installer or by adding the boot argument <userinput
>priority=low</userinput
>. Expert mode gives you full control over &d-i;. </para
><para condition="gtk"
>For this architecture the &d-i; supports two different user interfaces: a character-based one and a graphical one. The character-based interface is used by default unless you selected the <quote
>Graphical install</quote
> option in the initial boot menu. For more information about the graphical installer, please refer to <xref linkend="graphical"/>. </para
><para condition="not-gtk"
>For this architecture the installer uses a character-based user interface. A graphical user interface is currently not available. </para
><para
>In the character-based environment the use of a mouse is not supported. Here are the keys you can use to navigate within the various dialogs. The <keycap
>Tab</keycap
> or <keycap
>right</keycap
> arrow keys move <quote
>forward</quote
>, and the <keycombo
> <keycap
>Shift</keycap
> <keycap
>Tab</keycap
> </keycombo
> or <keycap
>left</keycap
> arrow keys move <quote
>backward</quote
> between displayed buttons and selections. The <keycap
>up</keycap
> and <keycap
>down</keycap
> arrow select different items within a scrollable list, and also scroll the list itself. In addition, in long lists, you can type a letter to cause the list to scroll directly to the section with items starting with the letter you typed and use <keycap
>Pg-Up</keycap
> and <keycap
>Pg-Down</keycap
> to scroll the list in sections. The <keycap
>space bar</keycap
> selects an item such as a checkbox. Use &enterkey; to activate choices. </para
><para arch="s390"
>S/390 does not support virtual consoles. You may open a second and third ssh session to view the logs described below. </para
><para
>Error messages and logs are redirected to the fourth console. You can access this console by pressing <keycombo
><keycap
>Left Alt</keycap
><keycap
>F4</keycap
></keycombo
> (hold the left <keycap
>Alt</keycap
> key while pressing the <keycap
>F4</keycap
> function key); get back to the main installer process with <keycombo
><keycap
>Left Alt</keycap
><keycap
>F1</keycap
></keycombo
>. </para
><para
>These messages can also be found in <filename
>/var/log/syslog</filename
>. After installation, this log is copied to <filename
>/var/log/installer/syslog</filename
> on your new system. Other installation messages may be found in <filename
>/var/log/</filename
> during the installation, and <filename
>/var/log/installer/</filename
> after the computer has been booted into the installed system. </para>
 </sect1>


  <sect1 id="modules-list"
><title
>Components Introduction</title>
<para
>Here is a list of installer components with a brief description of each component's purpose. Details you might need to know about using a particular component are in <xref linkend="module-details"/>. </para>

<variablelist>
<varlistentry>

<term
>main-menu</term
><listitem
><para
>Shows the list of components to the user during installer operation, and starts a component when it is selected. Main-menu's questions are set to priority medium, so if your priority is set to high or critical (high is the default), you will not see the menu. On the other hand, if there is an error which requires your intervention, the question priority may be downgraded temporarily to allow you to resolve the problem, and in that case the menu may appear. </para
><para
>You can get to the main menu by selecting the &BTN-GOBACK; button repeatedly to back all the way out of the currently running component. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>localechooser</term
><listitem
><para
>Allows the user to select localization options for the installation and the installed system: language, country and locales. The installer will display messages in the selected language, unless the translation for that language is not complete in which case some messages may be shown in English. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>kbd-chooser</term
><listitem
><para
>Shows a list of keyboards, from which the user chooses the model which matches his own. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>hw-detect</term
><listitem
><para
>Automatically detects most of the system's hardware, including network cards, disk drives, and PCMCIA. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>cdrom-detect</term
><listitem
><para
>Looks for and mounts a Debian installation CD. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>netcfg</term
><listitem
><para
>Configures the computer's network connections so it can communicate over the internet. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>iso-scan</term
><listitem
><para
>Searches for ISO images (<filename
>.iso</filename
> files) on hard drives. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>choose-mirror</term
><listitem
><para
>Presents a list of Debian archive mirrors. The user may choose the source of his installation packages. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>cdrom-checker</term
><listitem
><para
>Checks integrity of a CD-ROM. This way, the user may assure him/herself that the installation CD-ROM was not corrupted. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>lowmem</term
><listitem
><para
>Lowmem tries to detect systems with low memory and then does various tricks to remove unnecessary parts of &d-i; from the memory (at the cost of some features). </para
></listitem>
</varlistentry>
<varlistentry>

<term
>anna</term
><listitem
><para
>Anna's Not Nearly APT. Installs packages which have been retrieved from the chosen mirror or CD. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>clock-setup</term
><listitem
><para
>Updates the system clock and determines whether the clock is set to UTC or not. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>tzsetup</term
><listitem
><para
>Selects the time zone, based on the location selected earlier. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>partman</term
><listitem
><para
>Allows the user to partition disks attached to the system, create file systems on the selected partitions, and attach them to the mountpoints. Included are also interesting features like a fully automatic mode or LVM support. This is the preferred partitioning tool in Debian. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>partitioner</term
><listitem
><para
>Allows the user to partition disks attached to the system. A partitioning program appropriate to your computer's architecture is chosen. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>partconf</term
><listitem
><para
>Displays a list of partitions, and creates file systems on the selected partitions according to user instructions. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>lvmcfg</term
><listitem
><para
>Helps the user with the configuration of the <firstterm
>LVM</firstterm
> (Logical Volume Manager). </para
></listitem>
</varlistentry>
<varlistentry>

<term
>mdcfg</term
><listitem
><para
>Allows the user to set up Software <firstterm
>RAID</firstterm
> (Redundant Array of Inexpensive Disks). This Software RAID is usually superior to the cheap IDE (pseudo hardware) RAID controllers found on newer motherboards. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>base-installer</term
><listitem
><para
>Installs the most basic set of packages which would allow the computer to operate under Linux when rebooted. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>user-setup</term
><listitem
><para
>Sets up the root password, and adds a non-root user. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>apt-setup</term
><listitem
><para
>Configures apt, mostly automatically, based on what media the installer is running from. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>pkgsel</term
><listitem
><para
>Uses <classname
>tasksel</classname
> to select and install additional software. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>os-prober</term
><listitem
><para
>Detects currently installed operating systems on the computer and passes this information to the bootloader-installer, which may offer you an ability to add discovered operating systems to the bootloader's start menu. This way the user could easily choose at the boot time which operating system to start. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>bootloader-installer</term
><listitem
><para
>The various bootloader installers each install a boot loader program on the hard disk, which is necessary for the computer to start up using Linux without using a floppy or CD-ROM. Many boot loaders allow the user to choose an alternate operating system each time the computer boots. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>shell</term
><listitem
><para
>Allows the user to execute a shell from the menu, or in the second console. </para
></listitem>
</varlistentry>
<varlistentry>

<term
>save-logs</term
><listitem
><para
>Provides a way for the user to record information on a floppy disk, network, hard disk, or other media when trouble is encountered, in order to accurately report installer software problems to Debian developers later. </para
></listitem>
</varlistentry>

</variablelist>

 </sect1>


<!-- Start of file using-d-i/components.xml -->
<!-- $Id: components.xml 56257 2008-10-04 14:42:49Z fjp $ -->

 <sect1 id="module-details">
 <title
>Using Individual Components</title>
<para
>In this section we will describe each installer component in detail. The components have been grouped into stages that should be recognizable for users. They are presented in the order they appear during the install. Note that not all modules will be used for every installation; which modules are actually used depends on the installation method you use and on your hardware. </para>

  <sect2 id="di-setup">
  <title
>Setting up Debian Installer and Hardware Configuration</title>
<para
>Let's assume the Debian Installer has booted and you are facing its first screen. At this time, the capabilities of &d-i; are still quite limited. It doesn't know much about your hardware, preferred language, or even the task it should perform. Don't worry. Because &d-i; is quite clever, it can automatically probe your hardware, locate the rest of its components and upgrade itself to a capable installation system. However, you still need to help &d-i; with some information it can't determine automatically (like selecting your preferred language, keyboard layout or desired network mirror). </para
><para
>You will notice that &d-i; performs <firstterm
>hardware detection</firstterm
> several times during this stage. The first time is targeted specifically at the hardware needed to load installer components (e.g. your CD-ROM or network card). As not all drivers may be available during this first run, hardware detection needs to be repeated later in the process. </para
><para arch="not-s390"
>During hardware detection &d-i; checks if any of the drivers for the hardware devices in your system require firmware to be loaded. If any firmware is requested but unavailable, a dialog will be displayed that allows the missing firmware to be loaded from a removable medium. See <xref linkend="loading-firmware"/> for further details. </para>


<!-- Start of file using-d-i/modules/lowmem.xml -->
<!-- $Id: lowmem.xml 49849 2007-10-21 12:12:33Z fjp $ -->

  <sect3 id="lowmem">
  <title
>Check available memory / low memory mode</title>

<para
>One of the first things &d-i; does, is to check available memory. If the available memory is limited, this component will make some changes in the installation process which hopefully will allow you to install &debian; on your system. </para
><para
>The first measure taken to reduce memory consumption by the installer is to disable translations, which means that the installation can only be done in English. Of course, you can still localize the installed system after the installation has completed. </para
><para
>If that is not sufficient, the installer will further reduce memory consumption by loading only those components essential to complete a basic installation. This reduces the functionality of the installation system. You will be given the opportunity to load additional components manually, but you should be aware that each component you select will use additional memory and thus may cause the installation to fail. </para
><para
>If the installer runs in low memory mode, it is recommended to create a relatively large swap partition (64&ndash;128MB). The swap partition will be used as virtual memory and thus increases the amount of memory available to the system. The installer will activate the swap partition as early as possible in the installation process. Note that heavy use of swap will reduce performance of your system and may lead to high disk activity. </para
><para
>Despite these measures, it is still possible that your system freezes, that unexpected errors occur or that processes are killed by the kernel because the system runs out of memory (which will result in <quote
>Out of memory</quote
> messages on VT4 and in the syslog). </para
><para
>For example, it has been reported that creating a big ext3 file system fails in low memory mode when there is insufficient swap space. If a larger swap doesn't help, try creating the file system as ext2 (which is an essential component of the installer) instead. It is possible to change an ext2 partition to ext3 after the installation. </para
><para
>It is possible to force the installer to use a higher lowmem level than the one based on available memory by using the boot parameter <quote
>lowmem</quote
> as described in <xref linkend="installer-args"/>. </para>
   </sect3>
<!--   End of file using-d-i/modules/lowmem.xml -->

<!-- Start of file using-d-i/modules/localechooser.xml -->
<!-- $Id: localechooser.xml 56423 2008-10-15 08:23:57Z fjp $ -->


   <sect3 id="localechooser">
   <title
>Selecting Localization Options</title>

<para
>In most cases the first questions you will be asked concern the selection of localization options to be used both for the installation and for the installed system. The localization options consist of language, country and locales. </para
><para
>The language you choose will be used for the rest of the installation process, provided a translation of the different dialogs is available. If no valid translation is available for the selected language, the installer will default to English. </para
><para
>The selected country will be used later in the installation process to pick the default timezone and a Debian mirror appropriate for your geographic location. Language and country together will be used to set the default locale for your system and to help select your keyboard. </para
><para
>You will first be asked to select your preferred language. The language names are listed both in English (left side) and in the language itself (right side); the names on the right side are also shown in the proper script for the language. The list is sorted on the English names. At the top of the list is an extra option that allows you to select the <quote
>C</quote
> locale instead of a language. Choosing the <quote
>C</quote
> locale will result in the installation proceding in English; the installed system will have no localization support as the <classname
>locales</classname
> package will not be installed. </para
><para
>If you selected a language that is recognized as an official language for more than one country<footnote
> <para
> In technical terms: where multiple locales exist for that language with differing country codes. </para
> </footnote
>, you will be shown a list of only those countries. To select a country that is not in that list, choose <guimenuitem
>Other</guimenuitem
> (the last option). You will then be presented with a list of continents; selecting a continent will lead to a list of relevant countries on that continent. </para
><para
>If the language has only one country associated with it, that country will be selected automatically. In that case it is only possible to select a different country by first lowering the debconf priority to medium, followed by revisiting the language selection option in the main menu of the installer. </para
><para
>A default locale will be selected based on the selected language and country. If you are installing at medium or low priority, you will have the option of selecting a different default locale and of selecting additional locales to be generated for the installed system. </para>
   </sect3>
<!--   End of file using-d-i/modules/localechooser.xml -->

<!-- Start of file using-d-i/modules/kbd-chooser.xml -->
<!-- $Id: kbd-chooser.xml 53452 2008-05-20 20:00:16Z tbm $ -->

   <sect3 id="kbd-chooser">
   <title
>Choosing a Keyboard</title>

<para
>Keyboards are often tailored to the characters used in a language. Select a layout that conforms to the keyboard you are using, or select something close if the keyboard layout you want isn't represented. Once the system installation is complete, you'll be able to select a keyboard layout from a wider range of choices (run <command
>kbdconfig</command
> as root after you have completed the installation). </para
><para
>Move the highlight to the keyboard selection you desire and press &enterkey;. Use the arrow keys to move the highlight &mdash; they are in the same place in all national language keyboard layouts, so they are independent of the keyboard configuration. An 'extended' keyboard is one with <keycap
>F1</keycap
> through <keycap
>F10</keycap
> keys along the top row. </para
><para arch="powerpc"
>There are two keyboard layouts for US keyboards; the qwerty/mac-usb-us (Apple USB) layout will place the Alt function on the <keycap
>Command/Apple</keycap
> key (in the keyboard position next to the <keycap
>space</keycap
> key similar to <keycap
>Alt</keycap
> on PC keyboards), while the qwerty/us (Standard) layout will place the Alt function on the <keycap
>Option</keycap
> key (engraved with 'alt' on most Mac keyboards). In other respects the two layouts are similar. </para>
   </sect3>
<!--   End of file using-d-i/modules/kbd-chooser.xml -->

<!-- Start of file using-d-i/modules/s390/netdevice.xml -->
<!-- $Id: netdevice.xml 11648 2004-03-22 00:37:46Z joeyh $ -->
<!--   End of file using-d-i/modules/s390/netdevice.xml -->

<!-- Start of file using-d-i/modules/ddetect.xml -->
<!-- $Id: ddetect.xml 11648 2004-03-22 00:37:46Z joeyh $ -->
<!--   End of file using-d-i/modules/ddetect.xml -->

<!-- Start of file using-d-i/modules/cdrom-detect.xml -->
<!-- $Id: cdrom-detect.xml 11648 2004-03-22 00:37:46Z joeyh $ -->
<!--   End of file using-d-i/modules/cdrom-detect.xml -->

<!-- Start of file using-d-i/modules/iso-scan.xml -->
<!-- $Id: iso-scan.xml 23058 2004-10-12 23:51:17Z cjwatson $ -->

   <sect3 id="iso-scan">
   <title
>Looking for the Debian Installer ISO Image</title>
<para
>When installing via the <emphasis
>hd-media</emphasis
> method, there will be a moment where you need to find and mount the Debian Installer iso image in order to get the rest of the installation files. The component <command
>iso-scan</command
> does exactly this. </para
><para
>At first, <command
>iso-scan</command
> automatically mounts all block devices (e.g. partitions) which have some known filesystem on them and sequentially searches for filenames ending with <filename
>.iso</filename
> (or <filename
>.ISO</filename
> for that matter). Beware that the first attempt scans only files in the root directory and in the first level of subdirectories (i.e. it finds <filename
>/<replaceable
>whatever</replaceable
>.iso</filename
>, <filename
>/data/<replaceable
>whatever</replaceable
>.iso</filename
>, but not <filename
>/data/tmp/<replaceable
>whatever</replaceable
>.iso</filename
>). After an iso image has been found, <command
>iso-scan</command
> checks its content to determine if the image is a valid Debian iso image or not. In the former case we are done, in the latter <command
>iso-scan</command
> seeks for another image. </para
><para
>In case the previous attempt to find an installer iso image fails, <command
>iso-scan</command
> will ask you whether you would like to perform a more thorough search. This pass doesn't just look into the topmost directories, but really traverses whole filesystem. </para
><para
>If <command
>iso-scan</command
> does not discover your installer iso image, reboot back to your original operating system and check if the image is named correctly (ending in <filename
>.iso</filename
>), if it is placed on a filesystem recognizable by &d-i;, and if it is not corrupted (verify the checksum). Experienced Unix users could do this without rebooting on the second console. </para>
   </sect3>
<!--   End of file using-d-i/modules/iso-scan.xml -->

<!-- Start of file using-d-i/modules/anna.xml -->
<!-- $Id: anna.xml 11648 2004-03-22 00:37:46Z joeyh $ -->
<!--   End of file using-d-i/modules/anna.xml -->

<!-- Start of file using-d-i/modules/netcfg.xml -->
<!-- $Id: netcfg.xml 50619 2007-12-25 09:20:39Z fjp $ -->

   <sect3 id="netcfg">
   <title
>Configuring the Network</title>

<para
>As you enter this step, if the system detects that you have more than one network device, you'll be asked to choose which device will be your <emphasis
>primary</emphasis
> network interface, i.e. the one which you want to use for installation. The other interfaces won't be configured at this time. You may configure additional interfaces after installation is complete; see the <citerefentry
> <refentrytitle
>interfaces</refentrytitle
> <manvolnum
>5</manvolnum
> </citerefentry
> man page. </para
><para
>By default, &d-i; tries to configure your computer's network automatically via DHCP. If the DHCP probe succeeds, you are done. If the probe fails, it may be caused by many factors ranging from unplugged network cable, to a misconfigured DHCP setup. Or maybe you don't have a DHCP server in your local network at all. For further explanation, check the error messages on the fourth console. In any case, you will be asked if you want to retry, or if you want to perform a manual setup. DHCP servers are sometimes really slow in their responses, so if you are sure everything is in place, try again. </para
><para
>The manual network setup in turn asks you a number of questions about your network, notably <computeroutput
>IP address</computeroutput
>, <computeroutput
>Netmask</computeroutput
>, <computeroutput
>Gateway</computeroutput
>, <computeroutput
>Name server addresses</computeroutput
>, and a <computeroutput
>Hostname</computeroutput
>. Moreover, if you have a wireless network interface, you will be asked to provide your <computeroutput
>Wireless ESSID</computeroutput
> and a <computeroutput
>WEP key</computeroutput
>. Fill in the answers from <xref linkend="needed-info"/>. </para
><note
><para
>Some technical details you might, or might not, find handy: the program assumes the network IP address is the bitwise-AND of your system's IP address and your netmask. The default broadcast address is calculated as the bitwise OR of your system's IP address with the bitwise negation of the netmask. It will also guess your gateway. If you can't find any of these answers, use the offered defaults &mdash; if necessary, you can change them by editing <filename
>/etc/network/interfaces</filename
> once the system has been installed. </para
></note>
   </sect3>
<!--   End of file using-d-i/modules/netcfg.xml -->

<!-- Start of file using-d-i/modules/choose-mirror.xml -->
<!-- $Id: choose-mirror.xml 43658 2006-12-29 18:52:39Z fjp $ -->

<!--
Hmm. This really does need documenting :-/

- Component is only selected and executed if the installer needs to load
  installer components or the base system from the network
  (either local or the internet).
- This means you first have to configure a network interface.
- Mirror selection is delayed until apt-setup for CD-based installs (except
  businesscard)
- A list of countries is displayed with the default based on the country you
  selected earlier.
- Selection of a local mirror (at top of the list: manual selection).
- After selecting a country, a list of mirrors in the country will be shown.
  (not for ftp)
- Forcing to ftp can be done using "protocol=ftp"
- Note that not all mirrors are equal (see http://www.nl.debian.org/mirror/list)

- The selected mirror will be tested.
- How to handle problems with mirrors.
-->
<!--   End of file using-d-i/modules/choose-mirror.xml -->
<!-- tzsetup is included in clock-setup -->

<!-- Start of file using-d-i/modules/clock-setup.xml -->
<!-- $Id: clock-setup.xml 50618 2007-12-25 09:18:06Z fjp $ -->

   <sect3 id="clock-setup">
   <title
>Configuring the Clock</title>

<para
>The installer will first attempt to connect to a time server on the Internet (using the <firstterm
>NTP</firstterm
> protocol) in order to correctly set the system time. If this does not succeed, the installer will assume the time and date obtained from the system clock when the installation system was booted are correct. It is not possible to manually set the system time during the installation process. </para>


<!-- Start of file using-d-i/modules/tzsetup.xml -->
<!-- $Id: tzsetup.xml 50620 2007-12-25 09:22:03Z fjp $ -->

<!-- As tzsetup is invoked from inside clock-setup, this is not a
     separate section -->

<para
>Depending on the location selected earlier in the installation process, you may be shown a list of timezones relevant for that location. If your location has only one time zone, you will not be asked anything and the system will assume that time zone. </para
><para
>If for some reason you wish to set a time zone for the installed system that does <emphasis
>not</emphasis
> match the selected location, there are two options. </para>

<orderedlist>
<listitem>

<para
>The simplest option is to just select a different timezone after the installation has been completed and you've booted into the new system. The command to do this is: <informalexample
><screen
># dpkg-reconfigure tzdata
</screen
></informalexample>

</para>

</listitem
><listitem>

<para
>Alternatively, the time zone can be set at the very start of the installation by passing the parameter <userinput
>time/zone=<replaceable
>value</replaceable
></userinput
> when you boot the installation system. The value should of course be a valid time zone, for example <userinput
>Europe/London</userinput
> or <userinput
>UTC</userinput
>. </para>

</listitem>
</orderedlist>

<para
>For automated installations the time zone can also be set using preseeding. </para>
<!--   End of file using-d-i/modules/tzsetup.xml -->

   </sect3>
<!--   End of file using-d-i/modules/clock-setup.xml -->

  </sect2>

  <sect2 id="di-partition">
  <title
>Partitioning and Mount Point Selection</title>
<para
>At this time, after hardware detection has been executed a final time, &d-i; should be at its full strength, customized for the user's needs and ready to do some real work. As the title of this section indicates, the main task of the next few components lies in partitioning your disks, creating filesystems, assigning mountpoints and optionally configuring closely related options like RAID, LVM or encrypted devices. </para>


<!-- Start of file using-d-i/modules/s390/dasd.xml -->
<!-- $Id: dasd.xml 11648 2004-03-22 00:37:46Z joeyh $ -->
<!--   End of file using-d-i/modules/s390/dasd.xml -->

<!-- Start of file using-d-i/modules/partman.xml -->
<!-- $Id: partman.xml 56425 2008-10-15 08:50:59Z fjp $ -->

<para
>If you are uncomfortable with partitioning, or just want to know more details, see <xref linkend="partitioning"/>. </para>
<warning arch="sparc"
><para
>If a hard disk has previously used under Solaris, the partitioner may not detect the size of the drive correctly. Creating a new partition table does not fix this issue. What does help, is to <quote
>zero</quote
> the first few sectors of the drive: <informalexample
><screen
>
# dd if=/dev/zero of=/dev/hd<replaceable>X</replaceable> bs=512 count=2; sync
</screen
></informalexample
> Note that this will make any existing data on that disk inaccessible. </para
></warning>
<para
>First you will be given the opportunity to automatically partition either an entire drive, or available free space on a drive. This is also called <quote
>guided</quote
> partitioning. If you do not want to autopartition, choose <guimenuitem
>Manual</guimenuitem
> from the menu. </para>

   <sect3 id="partman-auto">
   <title
>Guided Partitioning</title>
<para
>If you choose guided partitioning, you may have three options: to create partitions directly on the hard disk (classic method), or to create them using Logical Volume Management (LVM), or to create them using encrypted LVM<footnote
> <para
> The installer will encrypt the LVM volume group using a 256 bit AES key and makes use of the kernel's <quote
>dm-crypt</quote
> support. </para
> </footnote
>. </para>
<note
><para
>The option to use (encrypted) LVM may not be available on all architectures. </para
></note>
<para
>When using LVM or encrypted LVM, the installer will create most partitions inside one big partition; the advantage of this method is that partitions inside this big partition can be resized relatively easily later. In the case of encrypted LVM the big partition will not be readable without knowing a special key phrase, thus providing extra security of your (personal) data. </para
><para
>When using encrypted LVM, the installer will also automatically erase the disk by writing random data to it. This further improves security (as it makes it impossible to tell which parts of the disk are in use and also makes sure that any traces of previous installations are erased), but may take some time depending on the size of your disk. </para>
<note
><para
>If you choose guided partitioning using LVM or encrypted LVM, some changes in the partition table will need to be written to the selected disk while LVM is being set up. These changes effectively erase all data that is currently on the selected hard disk and you will not be able to undo them later. However, the installer will ask you to confirm these changes before they are written to disk. </para
></note>
<para
>If you choose guided partitioning (either classic or using (encrypted) LVM) for a whole disk, you will first be asked to select the disk you want to use. Check that all your disks are listed and, if you have several disks, make sure you select the correct one. The order they are listed in may differ from what you are used to. The size of the disks may help to identify them. </para
><para
>Any data on the disk you select will eventually be lost, but you will always be asked to confirm any changes before they are written to the disk. If you have selected the classic method of partitioning, you will be able to undo any changes right until the end; when using (encrypted) LVM this is not possible. </para
><para
>Next, you will be able to choose from the schemes listed in the table below. All schemes have their pros and cons, some of which are discussed in <xref linkend="partitioning"/>. If you are unsure, choose the first one. Bear in mind that guided partitioning needs a certain minimal amount of free space to operate with. If you don't give it at least about 1GB of space (depends on chosen scheme), guided partitioning will fail. </para>

<informaltable>
<tgroup cols="3">
<thead>
<row>
  <entry
>Partitioning scheme</entry>
  <entry
>Minimum space</entry>
  <entry
>Created partitions</entry>
</row>
</thead>

<tbody>
<row>
  <entry
>All files in one partition</entry>
  <entry
>600MB</entry>
  <entry
><filename
>/</filename
>, swap</entry>
</row
><row>
  <entry
>Separate /home partition</entry>
  <entry
>500MB</entry>
  <entry
><filename
>/</filename
>, <filename
>/home</filename
>, swap </entry>
</row
><row>
  <entry
>Separate /home, /usr, /var and /tmp partitions</entry>
  <entry
>1GB</entry>
  <entry
><filename
>/</filename
>, <filename
>/home</filename
>, <filename
>/usr</filename
>, <filename
>/var</filename
>, <filename
>/tmp</filename
>, swap </entry>
</row>

</tbody
></tgroup
></informaltable>

<para
>If you choose guided partitioning using (encrypted) LVM, the installer will also create a separate <filename
>/boot</filename
> partition. The other partitions, including the swap partition, will be created inside the LVM partition. </para
><para arch="ia64"
>If you choose guided partitioning for your IA-64 system, there will be an additional partition, formatted as a FAT16 bootable filesystem, for the EFI boot loader. There is also an additional menu item in the formatting menu to manually set up a partition as an EFI boot partition. </para
><para arch="alpha"
>If you choose guided partitioning for your Alpha system, an additional, unformatted partition will be allocated at the beginning of your disk to reserve this space for the aboot boot loader. </para
><para
>After selecting a scheme, the next screen will show your new partition table, including information on whether and how partitions will be formatted and where they will be mounted. </para
><para
>The list of partitions might look like this: <informalexample
><screen
>
  IDE1 master (hda) - 6.4 GB WDC AC36400L
        #1 primary   16.4 MB  B f ext2       /boot
        #2 primary  551.0 MB      swap       swap
        #3 primary    5.8 GB      ntfs
           pri/log    8.2 MB      FREE SPACE

  IDE1 slave (hdb) - 80.0 GB ST380021A
        #1 primary   15.9 MB      ext3
        #2 primary  996.0 MB      fat16
        #3 primary    3.9 GB      xfs        /home
        #5 logical    6.0 GB    f ext3       /
        #6 logical    1.0 GB    f ext3       /var
        #7 logical  498.8 MB      ext3
        #8 logical  551.5 MB      swap       swap
        #9 logical   65.8 GB      ext2
</screen
></informalexample
> This example shows two IDE harddrives divided into several partitions; the first disk has some free space. Each partition line consists of the partition number, its type, size, optional flags, file system, and mountpoint (if any). Note: this particular setup cannot be created using guided partitioning but it does show possible variation that can be achieved using manual partitioning. </para
><para
>This concludes the guided partitioning. If you are satisfied with the generated partition table, you can choose <guimenuitem
>Finish partitioning and write changes to disk</guimenuitem
> from the menu to implement the new partition table (as described at the end of this section). If you are not happy, you can choose to <guimenuitem
>Undo changes to partitions</guimenuitem
> and run guided partitioning again, or modify the proposed changes as described below for manual partitioning. </para>
   </sect3>

   <sect3 id="partman-manual">
   <title
>Manual Partitioning</title>
<para
>A similar screen to the one shown just above will be displayed if you choose manual partitioning except that your existing partition table will be shown and without the mount points. How to manually set up your partition table and the usage of partitions by your new Debian system will be covered in the remainder of this section. </para
><para
>If you select a pristine disk which has neither partitions nor free space on it, you will be asked if a new partition table should be created (this is needed so you can create new partitions). After this, a new line entitled <quote
>FREE SPACE</quote
> should appear in the table under the selected disk. </para
><para
>If you select some free space, you will have the opportunity to create a new partition. You will have to answer a quick series of questions about its size, type (primary or logical), and location (beginning or end of the free space). After this, you will be presented with a detailed overview of your new partition. The main setting is <guimenuitem
>Use as:</guimenuitem
>, which determines if the partition will have a file system on it, or be used for swap, software RAID, LVM, an encrypted file system, or not be used at all. Other settings include mountpoint, mount options, and bootable flag; which settings are shown depends on how the partition is to be used. If you don't like the preselected defaults, feel free to change them to your liking. E.g. by selecting the option <guimenuitem
>Use as:</guimenuitem
>, you can choose a different filesystem for this partition, including options to use the partition for swap, software RAID, LVM, or not use it at all. Another nice feature is the ability to copy data from an existing partition onto this one. When you are satisfied with your new partition, select <guimenuitem
>Done setting up the partition</guimenuitem
> and you will return to <command
>partman</command
>'s main screen. </para
><para
>If you decide you want to change something about your partition, simply select the partition, which will bring you to the partition configuration menu. This is the same screen as is used when creating a new partition, so you can change the same settings. One thing that may not be very obvious at a first glance is that you can resize the partition by selecting the item displaying the size of the partition. Filesystems known to work are at least fat16, fat32, ext2, ext3 and swap. This menu also allows you to delete a partition. </para
><para
>Be sure to create at least two partitions: one for the <emphasis
>root</emphasis
> filesystem (which must be mounted as <filename
>/</filename
>) and one for <emphasis
>swap</emphasis
>. If you forget to mount the root filesystem, <command
>partman</command
> won't let you continue until you correct this issue. </para
><para arch="ia64"
>If you forget to select and format an EFI boot partition, <command
>partman</command
> will detect this and will not let you continue until you allocate one. </para
><para
>Capabilities of <command
>partman</command
> can be extended with installer modules, but are dependent on your system's architecture. So if you can't see all promised goodies, check if you have loaded all required modules (e.g. <filename
>partman-ext3</filename
>, <filename
>partman-xfs</filename
>, or <filename
>partman-lvm</filename
>). </para
><para
>After you are satisfied with partitioning, select <guimenuitem
>Finish partitioning and write changes to disk</guimenuitem
> from the partitioning menu. You will be presented with a summary of changes made to the disks and asked to confirm that the filesystems should be created as requested. </para>
   </sect3>
<!--   End of file using-d-i/modules/partman.xml -->

<!-- Start of file using-d-i/modules/autopartkit.xml -->
<!-- $Id: autopartkit.xml 11648 2004-03-22 00:37:46Z joeyh $ -->
<!--   End of file using-d-i/modules/autopartkit.xml -->

<!-- Start of file using-d-i/modules/partitioner.xml -->
<!-- $Id: partitioner.xml 11648 2004-03-22 00:37:46Z joeyh $ -->

<!--   End of file using-d-i/modules/partitioner.xml -->

<!-- Start of file using-d-i/modules/partconf.xml -->
<!-- $Id: partconf.xml 11648 2004-03-22 00:37:46Z joeyh $ -->
<!--   End of file using-d-i/modules/partconf.xml -->

<!-- Start of file using-d-i/modules/mdcfg.xml -->
<!-- $Id: mdcfg.xml 56427 2008-10-15 09:07:45Z fjp $ -->

   <sect3 id="mdcfg">
   <title
>Configuring Multidisk Devices (Software RAID)</title>
<para
>If you have more than one harddrive<footnote
><para
> To be honest, you can construct an MD device even from partitions residing on single physical drive, but that won't give any benefits. </para
></footnote
> in your computer, you can use <command
>mdcfg</command
> to set up your drives for increased performance and/or better reliability of your data. The result is called <firstterm
>Multidisk Device</firstterm
> (or after its most famous variant <firstterm
>software RAID</firstterm
>). </para
><para
>MD is basically a bunch of partitions located on different disks and combined together to form a <emphasis
>logical</emphasis
> device. This device can then be used like an ordinary partition (i.e. in <command
>partman</command
> you can format it, assign a mountpoint, etc.). </para
><para
>What benefits this brings depends on the type of MD device you are creating. Currently supported are: <variablelist
> <varlistentry
> <term
>RAID0</term
><listitem
><para
> Is mainly aimed at performance. RAID0 splits all incoming data into <firstterm
>stripes</firstterm
> and distributes them equally over each disk in the array. This can increase the speed of read/write operations, but when one of the disks fails, you will lose <emphasis
>everything</emphasis
> (part of the information is still on the healthy disk(s), the other part <emphasis
>was</emphasis
> on the failed disk). </para
><para
> The typical use for RAID0 is a partition for video editing. </para
></listitem
> </varlistentry
> <varlistentry
> <term
>RAID1</term
><listitem
><para
> Is suitable for setups where reliability is the first concern. It consists of several (usually two) equally-sized partitions where every partition contains exactly the same data. This essentially means three things. First, if one of your disks fails, you still have the data mirrored on the remaining disks. Second, you can use only a fraction of the available capacity (more precisely, it is the size of the smallest partition in the RAID). Third, file-reads are load-balanced among the disks, which can improve performance on a server, such as a file server, that tends to be loaded with more disk reads than writes. </para
><para
> Optionally you can have a spare disk in the array which will take the place of the failed disk in the case of failure. </para
></listitem
> </varlistentry
> <varlistentry
> <term
>RAID5</term
><listitem
><para
> Is a good compromise between speed, reliability and data redundancy. RAID5 splits all incoming data into stripes and distributes them equally on all but one disk (similar to RAID0). Unlike RAID0, RAID5 also computes <firstterm
>parity</firstterm
> information, which gets written on the remaining disk. The parity disk is not static (that would be called RAID4), but is changing periodically, so the parity information is distributed equally on all disks. When one of the disks fails, the missing part of information can be computed from remaining data and its parity. RAID5 must consist of at least three active partitions. Optionally you can have a spare disk in the array which will take the place of the failed disk in the case of failure. </para
><para
> As you can see, RAID5 has a similar degree of reliability to RAID1 while achieving less redundancy. On the other hand, it might be a bit slower on write operations than RAID0 due to computation of parity information. </para
></listitem
> </varlistentry
> <varlistentry
> <term
>RAID6</term
><listitem
><para
> Is similar to RAID5 except that it uses two parity devices instead of one. </para
><para
> A RAID6 array can survive up to two disk failures. </para
></listitem
> </varlistentry
> <varlistentry
> <term
>RAID10</term
><listitem
><para
> RAID10 combines striping (as in RAID0) and mirroring (as in RAID1). It creates <replaceable
>n</replaceable
> copies of incoming data and distributes them across the partitions so that none of the copies of the same data are on the same device. The default value of <replaceable
>n</replaceable
> is 2, but it can be set to something else in expert mode. The number of partitions used must be at least <replaceable
>n</replaceable
>. RAID10 has different layouts for distributing the copies. The default is near copies. Near copies have all of the copies at about the same offset on all of the disks. Far copies have the copies at different offsets on the disks. Offset copies copy the stripe, not the individual copies. </para
><para
> RAID10 can be used to achieve reliability and redundancy without the drawback of having to calculate parity. </para
></listitem
> </varlistentry
> </variablelist
> To sum it up: <informaltable
> <tgroup cols="5">
<thead>
<row>
  <entry
>Type</entry>
  <entry
>Minimum Devices</entry>
  <entry
>Spare Device</entry>
  <entry
>Survives disk failure?</entry>
  <entry
>Available Space</entry>
</row>
</thead>

<tbody>
<row>
  <entry
>RAID0</entry>
  <entry
>2</entry>
  <entry
>no</entry>
  <entry
>no</entry>
  <entry
>Size of the smallest partition multiplied by number of devices in RAID</entry>
</row>

<row>
  <entry
>RAID1</entry>
  <entry
>2</entry>
  <entry
>optional</entry>
  <entry
>yes</entry>
  <entry
>Size of the smallest partition in RAID</entry>
</row>

<row>
  <entry
>RAID5</entry>
  <entry
>3</entry>
  <entry
>optional</entry>
  <entry
>yes</entry>
  <entry
>Size of the smallest partition multiplied by (number of devices in RAID minus one) </entry>
</row>

<row>
  <entry
>RAID6</entry>
  <entry
>4</entry>
  <entry
>optional</entry>
  <entry
>yes</entry>
  <entry
>Size of the smallest partition multiplied by (number of devices in RAID minus two) </entry>
</row>

<row>
  <entry
>RAID10</entry>
  <entry
>2</entry>
  <entry
>optional</entry>
  <entry
>yes</entry>
  <entry
>Total of all partitions divided by the number of chunk copies (defaults to two) </entry>
</row>

</tbody
></tgroup
></informaltable>

</para
><para
>If you want to know more about Software RAID, have a look at <ulink url="&url-software-raid-howto;"
>Software RAID HOWTO</ulink
>. </para
><para
>To create an MD device, you need to have the desired partitions it should consist of marked for use in a RAID. (This is done in <command
>partman</command
> in the <guimenu
>Partition settings</guimenu
> menu where you should select <menuchoice
> <guimenu
>Use as:</guimenu
> <guimenuitem
>physical volume for RAID</guimenuitem
> </menuchoice
>.) </para
><note
><para
>Make sure that the system can be booted with the partitioning scheme you are planning. In general it will be necessary to create a separate file system for <filename
>/boot</filename
> when using RAID for the root (<filename
>/</filename
>) file system. Most boot loaders <phrase arch="x86"
>(including lilo and grub)</phrase
> do support mirrored (not striped!) RAID1, so using for example RAID5 for <filename
>/</filename
> and RAID1 for <filename
>/boot</filename
> can be an option. </para
></note>
<warning
><para
>Support for MD is a relatively new addition to the installer. You may experience problems for some RAID levels and in combination with some bootloaders if you try to use MD for the root (<filename
>/</filename
>) file system. For experienced users, it may be possible to work around some of these problems by executing some configuration or installation steps manually from a shell. </para
></warning
><para
>Next, you should choose <guimenuitem
>Configure software RAID</guimenuitem
> from the main <command
>partman</command
> menu. (The menu will only appear after you mark at least one partition for use as <guimenuitem
>physical volume for RAID</guimenuitem
>.) On the first screen of <command
>mdcfg</command
> simply select <guimenuitem
>Create MD device</guimenuitem
>. You will be presented with a list of supported types of MD devices, from which you should choose one (e.g. RAID1). What follows depends on the type of MD you selected. </para>

<itemizedlist>
<listitem
><para
>RAID0 is simple &mdash; you will be issued with the list of available RAID partitions and your only task is to select the partitions which will form the MD. </para
></listitem>
<listitem
><para
>RAID1 is a bit more tricky. First, you will be asked to enter the number of active devices and the number of spare devices which will form the MD. Next, you need to select from the list of available RAID partitions those that will be active and then those that will be spare. The count of selected partitions must be equal to the number provided earlier. Don't worry. If you make a mistake and select a different number of partitions, &d-i; won't let you continue until you correct the issue. </para
></listitem>
<listitem
><para
>RAID5 has a setup procedure similar to RAID1 with the exception that you need to use at least <emphasis
>three</emphasis
> active partitions. </para
></listitem>
<listitem
><para
>RAID6 also has a setup procedure similar to RAID1 except that at least <emphasis
>four</emphasis
> active partitions are required. </para
></listitem>
<listitem
><para
>RAID10 again has a setup procedure similar to RAID1 except in expert mode. In expert mode, &d-i; will ask you for the layout. The layout has two parts. The first part is the layout type. It is either <literal
>n</literal
> (for near copies), <literal
>f</literal
> (for far copies), or <literal
>o</literal
> (for offset copies). The second part is the number of copies to make of the data. There must be at least that many active devices so that all of the copies can be distributed onto different disks. </para
></listitem>
</itemizedlist>

<para
>It is perfectly possible to have several types of MD at once. For example, if you have three 200 GB hard drives dedicated to MD, each containing two 100 GB partitions, you can combine the first partitions on all three disks into the RAID0 (fast 300 GB video editing partition) and use the other three partitions (2 active and 1 spare) for RAID1 (quite reliable 100 GB partition for <filename
>/home</filename
>). </para
><para
>After you set up MD devices to your liking, you can <guimenuitem
>Finish</guimenuitem
> <command
>mdcfg</command
> to return back to the <command
>partman</command
> to create filesystems on your new MD devices and assign them the usual attributes like mountpoints. </para>
   </sect3>
<!--   End of file using-d-i/modules/mdcfg.xml -->

<!-- Start of file using-d-i/modules/partman-lvm.xml -->
<!-- $Id: partman-lvm.xml 56326 2008-10-06 23:03:54Z fjp $ -->

   <sect3 id="partman-lvm">
   <title
>Configuring the Logical Volume Manager (LVM)</title>
<para
>If you are working with computers at the level of system administrator or <quote
>advanced</quote
> user, you have surely seen the situation where some disk partition (usually the most important one) was short on space, while some other partition was grossly underused and you had to manage this situation by moving stuff around, symlinking, etc. </para
><para
>To avoid the described situation you can use Logical Volume Manager (LVM). Simply said, with LVM you can combine your partitions (<firstterm
>physical volumes</firstterm
> in LVM lingo) to form a virtual disk (so called <firstterm
>volume group</firstterm
>), which can then be divided into virtual partitions (<firstterm
>logical volumes</firstterm
>). The point is that logical volumes (and of course underlying volume groups) can span across several physical disks. </para
><para
>Now when you realize you need more space for your old 160GB <filename
>/home</filename
> partition, you can simply add a new 300GB disk to the computer, join it with your existing volume group and then resize the logical volume which holds your <filename
>/home</filename
> filesystem and voila &mdash; your users have some room again on their renewed 460GB partition. This example is of course a bit oversimplified. If you haven't read it yet, you should consult the <ulink url="&url-lvm-howto;"
>LVM HOWTO</ulink
>. </para
><para
>LVM setup in &d-i; is quite simple and completely supported inside <command
>partman</command
>. First, you have to mark the partition(s) to be used as physical volumes for LVM. This is done in the <guimenu
>Partition settings</guimenu
> menu where you should select <menuchoice
> <guimenu
>Use as:</guimenu
> <guimenuitem
>physical volume for LVM</guimenuitem
> </menuchoice
>. </para
><para
>When you return to the main <command
>partman</command
> screen, you will see a new option <guimenuitem
>Configure the Logical Volume Manager</guimenuitem
>. When you select that, you will first be asked to confirm pending changes to the partition table (if any) and after that the LVM configuration menu will be shown. Above the menu a summary of the LVM configuration is shown. The menu itself is context sensitive and only shows valid actions. The possible actions are: <itemizedlist>
  <listitem
><para
><guimenuitem
>Display configuration details</guimenuitem
>: shows LVM device structure, names and sizes of logical volumes and more </para
></listitem>
  <listitem
><para>
    <guimenuitem
>Create volume group</guimenuitem>
  </para
></listitem>
  <listitem
><para>
    <guimenuitem
>Create logical volume</guimenuitem>
  </para
></listitem>
  <listitem
><para>
    <guimenuitem
>Delete volume group</guimenuitem>
  </para
></listitem>
  <listitem
><para>
    <guimenuitem
>Delete logical volume</guimenuitem>
  </para
></listitem>
  <listitem
><para>
    <guimenuitem
>Extend volume group</guimenuitem>
  </para
></listitem>
  <listitem
><para>
    <guimenuitem
>Reduce volume group</guimenuitem>
  </para
></listitem>
  <listitem
><para
><guimenuitem
>Finish</guimenuitem
>: return to the main <command
>partman</command
> screen </para
></listitem>
</itemizedlist>

</para
><para
>Use the options in that menu to first create a volume group and then create your logical volumes inside it. </para
><para
>After you return to the main <command
>partman</command
> screen, any created logical volumes will be displayed in the same way as ordinary partitions (and you should treat them as such). </para>
   </sect3>
<!--   End of file using-d-i/modules/partman-lvm.xml -->

<!-- Start of file using-d-i/modules/partman-crypto.xml -->
<!-- $Id: partman-crypto.xml 56427 2008-10-15 09:07:45Z fjp $ -->

   <sect3 id="partman-crypto">
   <title
>Configuring Encrypted Volumes</title>
<para
>&d-i; allows you to set up encrypted partitions. Every file you write to such a partition is immediately saved to the device in encrypted form. Access to the encrypted data is granted only after entering the <firstterm
>passphrase</firstterm
> used when the encrypted partition was originally created. This feature is useful to protect sensitive data in case your laptop or hard drive gets stolen. The thief might get physical access to the hard drive, but without knowing the right passphrase, the data on the hard drive will look like random characters. </para
><para
>The two most important partitions to encrypt are: the home partition, where your private data resides, and the swap partition, where sensitive data might be stored temporarily during operation. Of course, nothing prevents you from encrypting any other partitions that might be of interest. For example <filename
>/var</filename
> where database servers, mail servers or print servers store their data, or <filename
>/tmp</filename
> which is used by various programs to store potentially interesting temporary files. Some people may even want to encrypt their whole system. The only exception is the <filename
>/boot</filename
> partition which must remain unencrypted, because currently there is no way to load the kernel from an encrypted partition. </para
><note
><para
>Please note that the performance of encrypted partitions will be less than that of unencrypted ones because the data needs to be decrypted or encrypted for every read or write. The performance impact depends on your CPU speed, chosen cipher and a key length. </para
></note
><para
>To use encryption, you have to create a new partition by selecting some free space in the main partitioning menu. Another option is to choose an existing partition (e.g. a regular partition, an LVM logical volume or a RAID volume). In the <guimenu
>Partition settings</guimenu
> menu, you need to select <guimenuitem
>physical volume for encryption</guimenuitem
> at the <menuchoice
> <guimenu
>Use as:</guimenu
> </menuchoice
> option. The menu will then change to include several cryptographic options for the partition. </para
><para
>&d-i; supports several encryption methods. The default method is <firstterm
>dm-crypt</firstterm
> (included in newer Linux kernels, able to host LVM physical volumes), the other is <firstterm
>loop-AES</firstterm
> (older, maintained separately from the Linux kernel tree). Unless you have compelling reasons to do otherwise, it is recommended to use the default. </para
><para
>First, let's have a look at the options available when you select <userinput
>Device-mapper (dm-crypt)</userinput
> as the encryption method. As always: when in doubt, use the defaults, because they have been carefully chosen with security in mind. <variablelist>

<varlistentry>
<term
>Encryption: <userinput
>aes</userinput
></term>

<listitem
><para
>This option lets you select the encryption algorithm (<firstterm
>cipher</firstterm
>) which will be used to encrypt the data on the partition. &d-i; currently supports the following block ciphers: <firstterm
>aes</firstterm
>, <firstterm
>blowfish</firstterm
>, <firstterm
>serpent</firstterm
>, and <firstterm
>twofish</firstterm
>. It is beyond the scope of this document to discuss the qualities of these different algorithms, however, it might help your decision to know that in 2000, <emphasis
>AES</emphasis
> was chosen by the American National Institute of Standards and Technology as the standard encryption algorithm for protecting sensitive information in the 21st century. </para
></listitem>
</varlistentry>

<varlistentry>
<term
>Key size: <userinput
>256</userinput
></term>

<listitem
><para
>Here you can specify the length of the encryption key. With a larger key size, the strength of the encryption is generally improved. On the other hand, increasing the length of the key usually has a negative impact on performance. Available key sizes vary depending on the cipher. </para
></listitem>
</varlistentry>

<varlistentry>
<term
>IV algorithm: <userinput
>cbc-essiv:sha256</userinput
></term>

<listitem
><para
>The <firstterm
>Initialization Vector</firstterm
> or <firstterm
>IV</firstterm
> algorithm is used in cryptography to ensure that applying the cipher on the same <firstterm
>clear text</firstterm
> data with the same key always produces a unique <firstterm
>cipher text</firstterm
>. The idea is to prevent the attacker from deducing information from repeated patterns in the encrypted data. </para
><para
>From the provided alternatives, the default <userinput
>cbc-essiv:sha256</userinput
> is currently the least vulnerable to known attacks. Use the other alternatives only when you need to ensure compatibility with some previously installed system that is not able to use newer algorithms. </para
></listitem>
</varlistentry>

<varlistentry>
<term
>Encryption key: <userinput
>Passphrase</userinput
></term>

<listitem
><para
>Here you can choose the type of the encryption key for this partition. <variablelist>
 <varlistentry>
 <term
>Passphrase</term>
 <listitem
><para
>The encryption key will be computed<footnote
> <para
> Using a passphrase as the key currently means that the partition will be set up using <ulink url="&url-luks;"
>LUKS</ulink
>. </para
></footnote
> on the basis of a passphrase which you will be able to enter later in the process. </para
></listitem>
 </varlistentry>

 <varlistentry>
 <term
>Random key</term>
 <listitem
><para
>A new encryption key will be generated from random data each time you try to bring up the encrypted partition. In other words: on every shutdown the content of the partition will be lost as the key is deleted from memory. (Of course, you could try to guess the key with a brute force attack, but unless there is an unknown weakness in the cipher algorithm, it is not achievable in our lifetime.) </para
><para
>Random keys are useful for swap partitions because you do not need to bother yourself with remembering the passphrase or wiping sensitive information from the swap partition before shutting down your computer. However, it also means that you will <emphasis
>not</emphasis
> be able to use the <quote
>suspend-to-disk</quote
> functionality offered by newer Linux kernels as it will be impossible (during a subsequent boot) to recover the suspended data written to the swap partition. </para
></listitem>
 </varlistentry>
 </variablelist>

</para
></listitem>
</varlistentry>

<varlistentry>
<term
>Erase data: <userinput
>yes</userinput
></term>

<listitem
><para
>Determines whether the content of this partition should be overwritten with random data before setting up the encryption. This is recommended because it might otherwise be possible for an attacker to discern which parts of the partition are in use and which are not. In addition, this will make it harder to recover any leftover data from previous installations<footnote
><para
> It is believed that the guys from three-letter agencies can restore the data even after several rewrites of the magnetooptical media, though. </para
></footnote
>. </para
></listitem>
</varlistentry>

</variablelist>

</para
><para
>If you select <menuchoice
> <guimenu
>Encryption method:</guimenu
> <guimenuitem
>Loopback (loop-AES)</guimenuitem
> </menuchoice
>, the menu changes to provide the following options: <variablelist>
<varlistentry>
<term
>Encryption: <userinput
>AES256</userinput
></term>

<listitem
><para
>For loop-AES, unlike dm-crypt, the options for cipher and key size are combined, so you can select both at the same time. Please see the above sections on ciphers and key sizes for further information. </para
></listitem>
</varlistentry>

<varlistentry>
<term
>Encryption key: <userinput
>Keyfile (GnuPG)</userinput
></term>

<listitem
><para
>Here you can select the type of the encryption key for this partition. <variablelist>
 <varlistentry>
 <term
>Keyfile (GnuPG)</term>
 <listitem
><para
>The encryption key will be generated from random data during the installation. Moreover this key will be encrypted with <application
>GnuPG</application
>, so to use it, you will need to enter the proper passphrase (you will be asked to provide one later in the process). </para
></listitem>
 </varlistentry>

 <varlistentry>
 <term
>Random key</term>
 <listitem
><para
>Please see the section on random keys above. </para
></listitem>
 </varlistentry>
 </variablelist>

</para
></listitem>
</varlistentry>

<varlistentry>
<term
>Erase data: <userinput
>yes</userinput
></term>

<listitem
><para
>Please see the the section on erasing data above. </para
></listitem>
</varlistentry>

</variablelist>

</para
><para
>After you have selected the desired parameters for your encrypted partitions, return back to the main partitioning menu. There should now be a new menu item called <guimenu
>Configure encrypted volumes</guimenu
>. After you select it, you will be asked to confirm the deletion of data on partitions marked to be erased and possibly other actions such as writing a new partition table. For large partitions this might take some time. </para
><para
>Next you will be asked to enter a passphrase for partitions configured to use one. Good passphrases should be longer than 8 characters, should be a mixture of letters, numbers and other characters and should not contain common dictionary words or information easily associable with you (such as birthdates, hobbies, pet names, names of family members or relatives, etc.). </para
><warning
><para
>Before you input any passphrases, you should have made sure that your keyboard is configured correctly and generates the expected characters. If you are unsure, you can switch to the second virtual console and type some text at the prompt. This ensures that you won't be surprised later, e.g. by trying to input a passphrase using a qwerty keyboard layout when you used an azerty layout during the installation. This situation can have several causes. Maybe you switched to another keyboard layout during the installation, or the selected keyboard layout might not have been set up yet when entering the passphrase for the root file system. </para
></warning
><para
>If you selected to use methods other than a passphrase to create encryption keys, they will be generated now. Because the kernel may not have gathered a sufficient amount of entropy at this early stage of the installation, the process may take a long time. You can help speed up the process by generating entropy: e.g. by pressing random keys, or by switching to the shell on the second virtual console and generating some network and disk traffic (downloading some files, feeding big files into <filename
>/dev/null</filename
>, etc.). This will be repeated for each partition to be encrypted. </para
><para
>After returning to the main partitioning menu, you will see all encrypted volumes as additional partitions which can be configured in the same way as ordinary partitions. The following example shows two different volumes. The first one is encrypted via dm-crypt, the second one via loop-AES. <informalexample
><screen
>
Encrypted volume (<replaceable>sda2_crypt</replaceable>) - 115.1 GB Linux device-mapper
     #1 115.1 GB  F ext3

Loopback (<replaceable>loop0</replaceable>) - 515.2 MB AES256 keyfile
     #1 515.2 MB  F ext3
</screen
></informalexample
> Now is the time to assign mount points to the volumes and optionally change the file system types if the defaults do not suit you. </para
><para
>Pay attention to the identifiers in parentheses (<replaceable
>sda2_crypt</replaceable
> and <replaceable
>loop0</replaceable
> in this case) and the mount points you assigned to each encrypted volume. You will need this information later when booting the new system. The differences between the ordinary boot process and the boot process with encryption involved will be covered later in <xref linkend="mount-encrypted-volumes"/>. </para
><para
>Once you are satisfied with the partitioning scheme, continue with the installation. </para>
   </sect3>
<!--   End of file using-d-i/modules/partman-crypto.xml -->
  </sect2>
  
  <sect2 id="di-install-base">
  <title
>Installing the Base System</title>
<para
>Although this stage is the least problematic, it consumes a significant fraction of the install because it downloads, verifies and unpacks the whole base system. If you have a slow computer or network connection, this could take some time. </para>


<!-- Start of file using-d-i/modules/base-installer.xml -->
<!-- $Id: base-installer.xml 43573 2006-12-27 02:20:58Z fjp $ -->

<para
>During installation of the base system, package unpacking and setup messages are redirected to <userinput
>tty4</userinput
>. You can access this terminal by pressing <keycombo
><keycap
>Left Alt</keycap
><keycap
>F4</keycap
></keycombo
>; get back to the main installer process with <keycombo
><keycap
>Left Alt</keycap
><keycap
>F1</keycap
></keycombo
>. </para
><para
>The unpack/setup messages generated during this phase are also saved in <filename
>/var/log/syslog</filename
>. You can check them there if the installation is performed over a serial console. </para
><para
>As part of the installation, a Linux kernel will be installed. At the default priority, the installer will choose one for you that best matches your hardware. In lower priority modes, you will be able to choose from a list of available kernels. </para>
<!--   End of file using-d-i/modules/base-installer.xml -->
  </sect2>

  <sect2 id="di-user-setup">
  <title
>Setting Up Users And Passwords</title>
<para
>After the base system has been installed, the installer will allow you to set up the <quote
>root</quote
> account and/or an account for the first user. Other user accounts can be created after the installation has been completed. </para>


<!-- Start of file using-d-i/modules/user-setup.xml -->
<!-- $Id: user-setup.xml 50618 2007-12-25 09:18:06Z fjp $ -->

   <sect3 id="user-setup-root">
   <title
>Set the Root Password</title>

<!-- TODO: Document sudo setup (no root password); medium/low prio only -->

<para
>The <emphasis
>root</emphasis
> account is also called the <emphasis
>super-user</emphasis
>; it is a login that bypasses all security protection on your system. The root account should only be used to perform system administration, and only used for as short a time as possible. </para
><para
>Any password you create should contain at least 6 characters, and should contain both upper- and lower-case characters, as well as punctuation characters. Take extra care when setting your root password, since it is such a powerful account. Avoid dictionary words or use of any personal information which could be guessed. </para
><para
>If anyone ever tells you they need your root password, be extremely wary. You should normally never give your root password out, unless you are administering a machine with more than one system administrator. </para>
  </sect3>

  <sect3 id="make-normal-user">
  <title
>Create an Ordinary User</title>

<para
>The system will ask you whether you wish to create an ordinary user account at this point. This account should be your main personal log-in. You should <emphasis
>not</emphasis
> use the root account for daily use or as your personal login. </para
><para
>Why not? Well, one reason to avoid using root's privileges is that it is very easy to do irreparable damage as root. Another reason is that you might be tricked into running a <emphasis
>Trojan-horse</emphasis
> program &mdash; that is a program that takes advantage of your super-user powers to compromise the security of your system behind your back. Any good book on Unix system administration will cover this topic in more detail &mdash; consider reading one if it is new to you. </para
><para
>You will first be prompted for the user's full name. Then you'll be asked for a name for the user account; generally your first name or something similar will suffice and indeed will be the default. Finally, you will be prompted for a password for this account. </para
><para
>If at any point after installation you would like to create another account, use the <command
>adduser</command
> command. </para>
   </sect3>
<!--   End of file using-d-i/modules/user-setup.xml -->
  </sect2>

  <sect2 id="di-install-software">
  <title
>Installing Additional Software</title>
<para
>At this point you have a usable but limited system. Most users will want to install additional software on the system to tune it to their needs, and the installer allows you do so. This step can take even longer than installing the base system if you have a slow computer or network connection. </para>


<!-- Start of file using-d-i/modules/apt-setup.xml -->
<!-- $Id: apt-setup.xml 51744 2008-03-06 04:21:56Z fjp $ -->

   <sect3 id="apt-setup">
   <title
>Configuring apt</title>

<para
>One of the tools used to install packages on a &debian; system is a program called <command
>apt-get</command
>, from the <classname
>apt</classname
> package<footnote
> <para
> Note that the program which actually installs the packages is called <command
>dpkg</command
>. However, this program is more of a low-level tool. <command
>apt-get</command
> is a higher-level tool, which will invoke <command
>dpkg</command
> as appropriate. It knows how to retrieve packages from your CD, the network, or wherever. It is also able to automatically install other packages which are required to make the package you're trying to install work correctly. </para
> </footnote
>. Other front-ends for package management, like <command
>aptitude</command
> and <command
>synaptic</command
>, are also in use. These front-ends are recommended for new users, since they integrate some additional features (package searching and status checks) in a nice user interface. In fact, <command
>aptitude</command
> is now the recommended utility for package management. </para
><para
><command
>apt</command
> must be configured so that it knows from where to retrieve packages. The results of this configuration are written to the file <filename
>/etc/apt/sources.list</filename
>. You can examine and edit this file to your liking after the installation is complete. </para
><para
>If you are installing at default priority, the installer will largely take care of the configuration automatically, based on the installation method you are using and possibly using choices made earlier in the installation. In most cases the installer will automatically add a security mirror and, if you are installing the stable distribution, a mirror for the <quote
>volatile</quote
> update service. </para
><para
>If you are installing at a lower priority (e.g. in expert mode), you will be able to make more decisions yourself. You can choose whether or not to use the security and/or volatile update services, and you can choose to add packages from the <quote
>contrib</quote
> and <quote
>non-free</quote
> sections of the archive. </para>

    <sect4 id="apt-setup-cdset">
    <title
>Installing from more than one CD or DVD</title>

<para
>If you are installing from a CD or a DVD that is part of a larger set, the installer will ask if you want to scan additional CDs or DVDs. If you have additional CDs or DVDs available, you probably want to do this so the installer can use the packages included on them. </para
><para
>If you do not have any additional CDs or DVDs, that is no problem: using them is not required. If you also do not use a network mirror (as explained in the next section), it can mean that not all packages belonging to the tasks you select in the next step of the installation can be installed. </para>
<note
><para
>Packages are included on CDs (and DVDs) in the order of their popularity. This means that for most uses only the first CDs in a set are needed and that only very few people actually use any of the packages included on the last CDs in a set. </para
><para
>It also means that buying or downloading and burning a full CD set is just a waste of money as you'll never use most of them. In most cases you are better off getting only the first 3 to 8 CDs and installing any additional packages you may need from the Internet by using a mirror. The same goes for DVD sets: the first DVD, or maybe the first two DVDs will cover most needs. </para
><para
>A good rule of thumb is that for a regular desktop installation (using the GNOME desktop environment) only the first three CDs are needed. For the alternative desktop environments (KDE or Xfce), additional CDs are needed. The first DVD easily covers all three desktop environments. </para
></note>
<para
>If you do scan multiple CDs or DVDs, the installer will prompt you to exchange them when it needs packages from another CD/DVD than the one currently in the drive. Note that only CDs or DVDs that belong to the same set should be scanned. The order in which they are scanned does not really matter, but scanning them in ascending order will reduce the chance of mistakes. </para>
    </sect4>

    <sect4 id="apt-setup-mirror">
    <title
>Using a network mirror</title>

<para
>One question that will be asked during most installs is whether or not to use a network mirror as a source for packages. In most cases the default answer should be fine, but there are some exceptions. </para
><para
>If you are <emphasis
>not</emphasis
> installing from a full CD or DVD or using a full CD/DVD image, you really should use a network mirror as otherwise you will end up with only a very minimal system. However, if you have a limited Internet connection it is best <emphasis
>not</emphasis
> to select the <literal
>desktop</literal
> task in the next step of the installation. </para
><para
>If you are installing from a single full CD or using a full CD image, using a network mirror is not required, but is still strongly recommended because a single CD contains only a fairly limited number of packages. If you have a limited Internet connection it may still be best to <emphasis
>not</emphasis
> select a network mirror here, but to finish the installation using only what's available on the CD and selectively install additional packages after the installation (i.e. after you have rebooted into the new system). </para
><para
>If you are installing from a DVD or using a DVD image, any packages needed during the installation should be present on the first DVD. The same is true if you have scanned multiple CDs as explained in the previous section. Use of a network mirror is optional. </para
><para
>One advantage of adding a network mirror is that updates that have occurred since the CD/DVD set was created and have been included in a point release, will become available for installation, thus extending the life of your CD/DVD set without compromising the security or stability of the installed system. </para
><para
>In summary: selecting a network mirror is generally a good idea, except if you do not have a good Internet connection. If the current version of a package is available from CD/DVD, the installer will always use that. The amount of data that will be downloaded if you do select a mirror thus depends on <orderedlist>
<listitem
><para
>the tasks you select in the next step of the installation, </para
></listitem>
<listitem
><para
>which packages are needed for those tasks, </para
></listitem>
<listitem
><para
>which of those packages are present on the CDs or DVDs you have scanned, and </para
></listitem>
<listitem
><para
>whether any updated versions of packages included on the CDs or DVDs are available from a mirror (either a regular package mirror, or a mirror for security or volatile updates). </para
></listitem>
</orderedlist>

</para
><para
>Note that the last point means that, even if you choose not to use a network mirror, some packages may still be downloaded from the Internet if there is a security or volatile update available for them and those services have been configured. </para>
</sect4>
   </sect3>
<!--   End of file using-d-i/modules/apt-setup.xml -->

<!-- Start of file using-d-i/modules/pkgsel.xml -->
<!-- $Id: pkgsel.xml 56511 2008-10-24 21:00:37Z fjp $ -->

   <sect3 id="pkgsel">
   <title
>Selecting and Installing Software</title>

<para
>During the installation process, you are given the opportunity to select additional software to install. Rather than picking individual software packages from the &num-of-distrib-pkgs; available packages, this stage of the installation process focuses on selecting and installing predefined collections of software to quickly set up your computer to perform various tasks. </para
><para
>So, you have the ability to choose <emphasis
>tasks</emphasis
> first, and then add on more individual packages later. These tasks loosely represent a number of different jobs or things you want to do with your computer, such as <quote
>Desktop environment</quote
>, <quote
>Web server</quote
>, or <quote
>Print server</quote
><footnote
> <para
> You should know that to present this list, the installer is merely invoking the <command
>tasksel</command
> program. It can be run at any time after installation to install more packages (or remove them), or you can use a more fine-grained tool such as <command
>aptitude</command
>. If you are looking for a specific single package, after installation is complete, simply run <userinput
>aptitude install <replaceable
>package</replaceable
></userinput
>, where <replaceable
>package</replaceable
> is the name of the package you are looking for. </para
> </footnote
>. <xref linkend="tasksel-size-list"/> lists the space requirements for the available tasks. </para
><para
>Some tasks may be pre-selected based on the characteristics of the computer you are installing. If you disagree with these selections you can deselect them. You can even opt to install no tasks at all at this point. </para>
<note
><para
>Unless you are using the special KDE or Xfce CDs, the <quote
>Desktop environment</quote
> task will install the GNOME desktop environment. </para
><para
>It is not possible to interactively select a different desktop during the installation. However, it <emphasis
>is</emphasis
> possible to get &d-i; to install a KDE desktop environment instead of GNOME by using preseeding (see <xref linkend="preseed-pkgsel"/>) or by adding the parameter <literal
>desktop=kde</literal
> at the boot prompt when starting the installer. Alternatively the more lightweight Xfce desktop environment can be selected by using <literal
>desktop=xfce</literal
>. </para
><para
>Note that this will only work if the packages needed for KDE or Xfce are actually available. If you are installing using a single full CD image, they will need to be downloaded from a mirror as most needed packages are only included on later CDs; installing KDE or Xfce this way should work fine if you are using a DVD image or any other installation method. </para
><para
>The various server tasks will install software roughly as follows. DNS server: <classname
>bind9</classname
>; File server: <classname
>samba</classname
>, <classname
>nfs</classname
>; Mail server: <classname
>exim4</classname
>, <classname
>spamassassin</classname
>, <classname
>uw-imap</classname
>; Print server: <classname
>cups</classname
>; SQL database: <classname
>postgresql</classname
>; Web server: <classname
>apache2</classname
>. </para
></note>
<para
>Once you've selected your tasks, select &BTN-CONT;. At this point, <command
>aptitude</command
> will install the packages that are part of the selected tasks. If a particular program needs more information from the user, it will prompt you during this process. </para>
<note
><para
>In the standard user interface of the installer, you can use the space bar to toggle selection of a task. </para
></note>
<para
>You should be aware that especially the Desktop task is very large. Especially when installing from a normal CD-ROM in combination with a mirror for packages not on the CD-ROM, the installer may want to retrieve a lot of packages over the network. If you have a relatively slow Internet connection, this can take a long time. There is no option to cancel the installation of packages once it has started. </para
><para
>Even when packages are included on the CD-ROM, the installer may still retrieve them from the mirror if the version available on the mirror is more recent than the one included on the CD-ROM. If you are installing the stable distribution, this can happen after a point release (an update of the original stable release); if you are installing the testing distribution this will happen if you are using an older image. </para>
   </sect3>
<!--   End of file using-d-i/modules/pkgsel.xml -->
  </sect2>
	
  <sect2 id="di-make-bootable">
  <title
>Making Your System Bootable</title>

<para condition="supports-nfsroot"
>If you are installing a diskless workstation, obviously, booting off the local disk isn't a meaningful option, and this step will be skipped. <phrase arch="sparc"
>You may wish to set OpenBoot to boot from the network by default; see <xref linkend="boot-dev-select-sun"/>.</phrase
> </para>


<!-- Start of file using-d-i/modules/os-prober.xml -->
<!-- $Id: os-prober.xml 33725 2006-01-03 19:39:07Z fjp $ -->

   <sect3 id="os-prober">
   <title
>Detecting other operating systems</title>

<para
>Before a boot loader is installed, the installer will attempt to probe for other operating systems which are installed on the machine. If it finds a supported operating system, you will be informed of this during the boot loader installation step, and the computer will be configured to boot this other operating system in addition to Debian. </para
><para
>Note that multiple operating systems booting on a single machine is still something of a black art. The automatic support for detecting and setting up boot loaders to boot other operating systems varies by architecture and even by subarchitecture. If it does not work you should consult your boot manager's documentation for more information. </para>
   </sect3>
<!--   End of file using-d-i/modules/os-prober.xml -->

<!-- Start of file using-d-i/modules/alpha/aboot-installer.xml -->
<!-- $Id: aboot-installer.xml 43573 2006-12-27 02:20:58Z fjp $ -->

  <sect3 arch="alpha">
  <title
>Install <command
>aboot</command
> on a Hard Disk</title>
<para
>If you have booted from SRM and you select this option, the installer will write <command
>aboot</command
> to the first sector of the disk on which you installed Debian. Be <emphasis
>very</emphasis
> careful &mdash; it is <emphasis
>not</emphasis
> possible to boot multiple operating systems (e.g. GNU/Linux, Free/Open/NetBSD, OSF/1 a.k.a. Digital Unix a.k.a. Tru64 Unix, or OpenVMS) from the same disk. If you also have a different operating system installed on the disk where you have installed Debian, you will have to boot GNU/Linux from a floppy instead. </para>
  </sect3>
<!--   End of file using-d-i/modules/alpha/aboot-installer.xml -->

<!-- Start of file using-d-i/modules/hppa/palo-installer.xml -->
<!-- $Id: palo-installer.xml 14602 2004-05-02 16:31:59Z mck-guest $ -->

  <sect3 arch="hppa">
  <title
><command
>palo</command
>-installer</title>
<para
>The bootloader on PA-RISC is <quote
>palo</quote
>. <command
>PALO</command
> is similar in configuration and usage to <command
>LILO</command
>, with a few exceptions. First of all, <command
>PALO</command
> allows you to boot any kernel image on your boot partition. This is because <command
>PALO</command
> can actually read Linux partitions. </para
><para condition="FIXME"
>hppa FIXME ( need more info ) </para>
  </sect3>
<!--   End of file using-d-i/modules/hppa/palo-installer.xml -->

<!-- Start of file using-d-i/modules/x86/grub-installer.xml -->
<!-- $Id: grub-installer.xml 46722 2007-05-07 15:34:13Z fjp $ -->

  <sect3 arch="x86">
  <title
>Install the <command
>Grub</command
> Boot Loader on a Hard Disk</title>
<para
>The main &architecture; boot loader is called <quote
>grub</quote
>. Grub is a flexible and robust boot loader and a good default choice for new users and old hands alike. </para
><para
>By default, grub will be installed into the Master Boot Record (MBR), where it will take over complete control of the boot process. If you prefer, you can install it elsewhere. See the grub manual for complete information. </para
><para
>If you do not want to install grub, use the &BTN-GOBACK; button to get to the main menu, and from there select whatever bootloader you would like to use. </para>
  </sect3>
<!--   End of file using-d-i/modules/x86/grub-installer.xml -->

<!-- Start of file using-d-i/modules/x86/lilo-installer.xml -->
<!-- $Id: lilo-installer.xml 49849 2007-10-21 12:12:33Z fjp $ -->

  <sect3 arch="x86">
  <title
>Install the <command
>LILO</command
> Boot Loader on a Hard Disk</title>
<para
>The second &architecture; boot loader is called <quote
>LILO</quote
>. It is an old complex program which offers lots of functionality, including DOS, Windows, and OS/2 boot management. Please carefully read the instructions in the directory <filename
>/usr/share/doc/lilo/</filename
> if you have special needs; also see the <ulink url="&url-lilo-howto;"
>LILO mini-HOWTO</ulink
>. </para>
<note
><para
>Currently the LILO installation will only create menu entries for other operating systems if these can be <firstterm
>chainloaded</firstterm
>. This means you may have to manually add a menu entry for operating systems like GNU/Linux and GNU/Hurd after the installation. </para
></note>
<para
>&d-i; offers you three choices on where to install the <command
>LILO</command
> boot loader: <variablelist>
<varlistentry>
<term
>Master Boot Record (MBR)</term
><listitem
><para
>This way the <command
>LILO</command
> will take complete control of the boot process. </para
></listitem
></varlistentry>
<varlistentry>
<term
>new Debian partition</term
><listitem
><para
>Choose this if you want to use another boot manager. <command
>LILO</command
> will install itself at the beginning of the new Debian partition and it will serve as a secondary boot loader. </para
></listitem
></varlistentry>
<varlistentry>
<term
>Other choice</term
><listitem
><para
>Useful for advanced users who want to install <command
>LILO</command
> somewhere else. In this case you will be asked for desired location. You can use traditional device names such as <filename
>/dev/hda</filename
> or <filename
>/dev/sda</filename
>. </para
></listitem
></varlistentry>
</variablelist>

</para
><para
>If you can no longer boot into Windows 9x (or DOS) after this step, you'll need to use a Windows 9x (MS-DOS) boot disk and use the <userinput
>fdisk /mbr</userinput
> command to reinstall the MS-DOS master boot record &mdash; however, this means that you'll need to use some other way to get back into Debian! </para>
  </sect3>
<!--   End of file using-d-i/modules/x86/lilo-installer.xml -->

<!-- Start of file using-d-i/modules/ia64/elilo-installer.xml -->
<!-- $Id: elilo-installer.xml 43573 2006-12-27 02:20:58Z fjp $ -->

  <sect3 arch="ia64">
  <title
>Install the <command
>ELILO</command
> Boot Loader on a Hard Disk</title>
<para
>The &architecture; boot loader is called <quote
>elilo</quote
>. It is modeled on the <quote
>lilo</quote
> boot loader for the x86 architecture and uses a similar configuration file. However, instead of writing an MBR or partition boot record to the disk, it copies the necessary files to a separate FAT formatted disk partition and modifies the <guimenuitem
>EFI Boot Manager</guimenuitem
> menu in the firmware to point to the files in the EFI partition. The <command
>elilo</command
> boot loader is really in two parts. The <filename
>/usr/sbin/elilo</filename
> command manages the partition and copies files into it. The <filename
>elilo.efi</filename
> program is copied into the EFI partition and then run by the <quote
>EFI Boot Manager</quote
> to do the actual work of loading and starting the Linux kernel. </para
><para
>The <quote
>elilo</quote
> configuration and installation is done as the last step of installing the packages of the base installation. &d-i; will present you with a list of potential disk partitions that it has found suitable for an EFI partition. Select the partition you set up earlier in the installation, typically a partition on the same disk that contains your <emphasis
>root</emphasis
> filesystem. </para>

  <warning
><title
>Choose the correct partition!</title>

<para
>The criteria for selecting a partition is that it is FAT format filesystem with its <emphasis
>boot</emphasis
> flag set. &d-i; may show multiple choices depending on what it finds from scanning all of the disks of the system including EFI partitions of other system disks and EFI diagnostic partitions. Remember, <command
>elilo</command
> may format the partition during the installation, erasing any previous contents! </para
></warning>

  </sect3>

  <sect3 arch="ia64">
  <title
>EFI Partition Contents</title>

<para
>The EFI partition is a FAT filesystem format partition on one of the hard disks of the system, usually the same disk that contains the <emphasis
>root</emphasis
> filesystem. It is normally not mounted on a running system as it is only needed by the <quote
>EFI Boot Manager</quote
> to load the system and the installer part of the <command
>elilo</command
> writes to the filesystem directly. The <command
>/usr/sbin/elilo</command
> utility writes the following files into the <filename
>efi/debian</filename
> directory of the EFI partition during the installation. Note that the <quote
>EFI Boot Manager</quote
> would find these files using the path <filename
>fs<replaceable
>n</replaceable
>:\efi\debian</filename
>. There may be other files in this filesystem as well over time as the system is updated or re-configured. </para>

<variablelist>

<varlistentry>
<term
><filename
>elilo.conf</filename
></term>
<listitem
><para
>This is the configuration file read by the boot loader when it starts. It is a copy of the <filename
>/etc/elilo.conf</filename
> with the filenames re-written to refer to files in the EFI partition. </para
></listitem
></varlistentry>

<varlistentry>
<term
><filename
>elilo.efi</filename
></term>
<listitem
><para
>This is the boot loader program that the <quote
>EFI Boot Manager</quote
> runs to boot the system. It is the program behind the <guimenuitem
>Debian GNU/Linux</guimenuitem
> menu item of the <quote
>EFI Boot Manager</quote
> command menu. </para
></listitem
></varlistentry>

<varlistentry>
<term
><filename
>initrd.img</filename
></term>
<listitem
><para
>This is the initial root filesystem used to boot the kernel. It is a copy of the file referenced in the <filename
>/etc/elilo.conf</filename
>. In a standard Debian installation it would be the file in <filename
>/boot</filename
> pointed to by the symbolic link <filename
>/initrd.img</filename
>. </para
></listitem
></varlistentry>

<varlistentry>
<term
><filename
>readme.txt</filename
></term>
<listitem
><para
>This is a small text file warning you that the contents of the directory are managed by the <command
>elilo</command
> and that any local changes would be lost at the next time <filename
>/usr/sbin/elilo</filename
> is run. </para
></listitem
></varlistentry>

<varlistentry>
<term
><filename
>vmlinuz</filename
></term>
<listitem
><para
>This is the compressed kernel itself. It is a copy of the file referenced in the <filename
>/etc/elilo.conf</filename
>. In a standard Debian installation it would be the file in <filename
>/boot</filename
> pointed to by the symbolic link <filename
>/vmlinuz</filename
>. </para
></listitem
></varlistentry>

</variablelist>

  </sect3>
<!--   End of file using-d-i/modules/ia64/elilo-installer.xml -->

<!-- Start of file using-d-i/modules/mips/arcboot-installer.xml -->
<!-- $Id: arcboot-installer.xml 35613 2006-03-19 04:18:28Z tbm $ -->

  <sect3 arch="mips">
  <title
><command
>arcboot</command
>-installer</title>
<para
>The boot loader on SGI machines is <command
>arcboot</command
>. It has to be installed on the same hard disk as the kernel (this is done automatically by the installer). Arcboot supports different configurations which are set up in <filename
>/etc/arcboot.conf</filename
>. Each configuration has a unique name, the default setup as created by the installer is <quote
>linux</quote
>. After arcboot has been installed, the system can be booted from hard disk by setting some firmware environment variables entering <informalexample
><screen
>
<userinput> setenv SystemPartition scsi(<replaceable>scsi</replaceable>)disk(<replaceable>disk</replaceable>)rdisk(0)partition(0)</userinput>
<userinput> setenv OSLoadPartition scsi(<replaceable>scsi</replaceable>)disk(<replaceable>disk</replaceable>)rdisk(0)partition(<replaceable>partnr</replaceable>)</userinput>
<userinput> setenv OSLoader arcboot</userinput>
<userinput> setenv OSLoadFilename <replaceable>config</replaceable></userinput>
<userinput> setenv AutoLoad yes</userinput>
</screen
></informalexample
> on the firmware prompt, and then typing <command
>boot</command
>. </para>

<variablelist>
<varlistentry>
<term
> <replaceable
>scsi</replaceable
> </term>
<listitem
><para
>is the SCSI bus to be booted from, this is <userinput
>0</userinput
> for the onboard controllers </para
></listitem>
</varlistentry>
<varlistentry>
<term
> <replaceable
>disk</replaceable
> </term>
<listitem
><para
>is the SCSI ID of the hard disk on which <command
>arcboot</command
> is installed </para
></listitem>
</varlistentry>
<varlistentry>
<term
> <replaceable
>partnr</replaceable
> </term>
<listitem
><para
>is the number of the partition on which <filename
>/etc/arcboot.conf</filename
> resides </para
></listitem>
</varlistentry>
<varlistentry>
<term
> <replaceable
>config</replaceable
> </term>
<listitem
><para
>is the name of the configuration entry in <filename
>/etc/arcboot.conf</filename
>, which is <quote
>linux</quote
> by default. </para
></listitem>
</varlistentry>
</variablelist>

  </sect3>
<!--   End of file using-d-i/modules/mips/arcboot-installer.xml -->

<!-- Start of file using-d-i/modules/mipsel/colo-installer.xml -->
<!-- $Id: colo-installer.xml 14337 2004-04-24 15:05:40Z mck-guest $ -->
<!--   End of file using-d-i/modules/mipsel/colo-installer.xml -->

<!-- Start of file using-d-i/modules/powerpc/yaboot-installer.xml -->
<!-- $Id: yaboot-installer.xml 14975 2004-05-08 13:28:15Z mck-guest $ -->

  <sect3 arch="powerpc">
  <title
>Install <command
>Yaboot</command
> on a Hard Disk</title>
<para
>Newer (mid 1998 and on) PowerMacs use <command
>yaboot</command
> as their boot loader. The installer will set up <command
>yaboot</command
> automatically, so all you need is a small 820k partition named <quote
>bootstrap</quote
> with type <emphasis
>Apple_Bootstrap</emphasis
> created back in the partitioning component. If this step completes successfully then your disk should now be bootable and OpenFirmware will be set to boot &debian;. </para>
  </sect3>
<!--   End of file using-d-i/modules/powerpc/yaboot-installer.xml -->

<!-- Start of file using-d-i/modules/powerpc/quik-installer.xml -->
<!-- $Id: quik-installer.xml 14975 2004-05-08 13:28:15Z mck-guest $ -->

  <sect3 arch="powerpc">
  <title
>Install <command
>Quik</command
> on a Hard Disk</title>
<para
>The boot loader for OldWorld Power Macintosh machines is <command
>quik</command
>. You can also use it on CHRP. The installer will attempt to set up <command
>quik</command
> automatically. The setup has been known to work on 7200, 7300, and 7600 Powermacs, and on some Power Computing clones. </para>
  </sect3>
<!--   End of file using-d-i/modules/powerpc/quik-installer.xml -->

<!-- Start of file using-d-i/modules/s390/zipl-installer.xml -->
<!-- $Id: zipl-installer.xml 14602 2004-05-02 16:31:59Z mck-guest $ -->

  <sect3 arch="s390">
  <title
><command
>zipl</command
>-installer</title>
<para
>The boot loader on &arch-title; is <quote
>zipl</quote
>. <command
>ZIPL</command
> is similar in configuration and usage to <command
>LILO</command
>, with a few exceptions. Please take a look at <quote
>LINUX for &arch-title; Device Drivers and Installation Commands</quote
> from IBM's developerWorks web site if you want to know more about <command
>ZIPL</command
>. </para>
  </sect3>
<!--   End of file using-d-i/modules/s390/zipl-installer.xml -->

<!-- Start of file using-d-i/modules/sparc/silo-installer.xml -->
<!-- $Id: silo-installer.xml 24582 2004-12-27 02:16:29Z cjwatson $ -->

  <sect3 arch="sparc">
  <title
>Install the <command
>SILO</command
> Boot Loader on a Hard Disk</title>
<para
>The standard &architecture; boot loader is called <quote
>silo</quote
>. It is documented in <filename
>/usr/share/doc/silo/</filename
>. <command
>SILO</command
> is similar in configuration and usage to <command
>LILO</command
>, with a few exceptions. First of all, <command
>SILO</command
> allows you to boot any kernel image on your drive, even if it is not listed in <filename
>/etc/silo.conf</filename
>. This is because <command
>SILO</command
> can actually read Linux partitions. Also, <filename
>/etc/silo.conf</filename
> is read at boot time, so there is no need to rerun <command
>silo</command
> after installing a new kernel like you would with <command
>LILO</command
>. <command
>SILO</command
> can also read UFS partitions, which means it can boot SunOS/Solaris partitions as well. This is useful if you want to install GNU/Linux alongside an existing SunOS/Solaris install. </para>
  </sect3>
<!--   End of file using-d-i/modules/sparc/silo-installer.xml -->

<!-- Start of file using-d-i/modules/nobootloader.xml -->
<!-- $Id: nobootloader.xml 25513 2005-02-07 23:43:27Z fjpop-guest $ -->

   <sect3 id="nobootloader">
   <title
>Continue Without Boot Loader</title>

<para
>This option can be used to complete the installation even when no boot loader is to be installed, either because the arch/subarch doesn't provide one, or because none is desired (e.g. you will use existing boot loader). <phrase arch="m68k"
>This option is especially useful for Macintosh, Atari, and Amiga systems, where the original operating system must be maintained on the box and used to boot GNU/Linux.</phrase
> </para
><para
>If you plan to manually configure your bootloader, you should check the name of the installed kernel in <filename
>/target/boot</filename
>. You should also check that directory for the presence of an <firstterm
>initrd</firstterm
>; if one is present, you will probably have to instruct your bootloader to use it. Other information you will need are the disk and partition you selected for your <filename
>/</filename
> filesystem and, if you chose to install <filename
>/boot</filename
> on a separate partition, also your <filename
>/boot</filename
> filesystem. </para>
   </sect3>
<!--   End of file using-d-i/modules/nobootloader.xml -->
  </sect2>

  <sect2 id="di-finish">
  <title
>Finishing the Installation</title>
<para
>This is the last step in the Debian installation process during which the installer will do any last minute tasks. It mostly consists of tidying up after the &d-i;. </para>


<!-- Start of file using-d-i/modules/clock-setup-finish.xml -->
<!-- $Id: clock-setup-finish.xml 50618 2007-12-25 09:18:06Z fjp $ -->

   <sect3 id="system-clock">
   <title
>Setting the System Clock</title>

<para
>The installer may ask you if the computer's clock is set to UTC. Normally this question is avoided if possible and the installer tries to work out whether the clock is set to UTC based on things like what other operating systems are installed. </para
><para
>In expert mode you will always be able to choose whether or not the clock is set to UTC. <phrase arch="m68k;powerpc"
>Macintosh hardware clocks are normally set to local time. If you want to dual-boot, select local time instead of UTC.</phrase
> <phrase arch="x86"
>Systems that (also) run Dos or Windows are normally set to local time. If you want to dual-boot, select local time instead of UTC.</phrase
> </para
><para
>At this point &d-i; will also attempt to save the current time to the system's hardware clock. This will be done either in UTC or local time, depending on the selection that was just made. </para>

   </sect3>
<!--   End of file using-d-i/modules/clock-setup-finish.xml -->

<!-- Start of file using-d-i/modules/finish-install.xml -->
<!-- $Id: finish-install.xml 50618 2007-12-25 09:18:06Z fjp $ -->

   <sect3 id="finish-install">
   <title
>Reboot the System</title>

<para arch="not-s390"
>You will be prompted to remove the boot media (CD, floppy, etc) that you used to boot the installer. After that the system will be rebooted into your new Debian system. </para
><para arch="s390"
>After a final prompt the system will be halted because rebooting is not supported on &arch-title;. You then need to IPL &debian; from the DASD which you selected for the root filesystem during the first steps of the installation. </para>
   </sect3>
<!--   End of file using-d-i/modules/finish-install.xml -->
  </sect2>

  <sect2 id="di-miscellaneous">
  <title
>Miscellaneous</title>
<para
>The components listed in this section are usually not involved in the installation process, but are waiting in the background to help the user in case something goes wrong. </para>


<!-- Start of file using-d-i/modules/save-logs.xml -->
<!-- $Id: save-logs.xml 33725 2006-01-03 19:39:07Z fjp $ -->

   <sect3 id="save-logs">
   <title
>Saving the installation logs</title>

<para
>If the installation is successful, the logfiles created during the installation process will be automatically saved to <filename
>/var/log/installer/</filename
> on your new Debian system. </para
><para
>Choosing <guimenuitem
>Save debug logs</guimenuitem
> from the main menu allows you to save the log files to a floppy disk, network, hard disk, or other media. This can be useful if you encounter fatal problems during the installation and wish to study the logs on another system or attach them to an installation report. </para>
   </sect3>
<!--   End of file using-d-i/modules/save-logs.xml -->

<!-- Start of file using-d-i/modules/cdrom-checker.xml -->
<!-- $Id: cdrom-checker.xml 14337 2004-04-24 15:05:40Z mck-guest $ -->
<!--   End of file using-d-i/modules/cdrom-checker.xml -->

<!-- Start of file using-d-i/modules/shell.xml -->
<!-- $Id: shell.xml 56326 2008-10-06 23:03:54Z fjp $ -->

   <sect3 id="shell">
   <title
>Using the Shell and Viewing the Logs</title>

<para
>There are several methods you can use to get a shell while running an installation. On most systems, and if you are not installing over serial console, the easiest method is to switch to the second <emphasis
>virtual console</emphasis
> by pressing <keycombo
><keycap
>Left Alt</keycap
> <keycap
>F2</keycap
></keycombo
><footnote
> <para
> That is: press the <keycap
>Alt</keycap
> key on the left-hand side of the <keycap
>space bar</keycap
> and the <keycap
>F2</keycap
> function key at the same time. </para
> </footnote
> (on a Mac keyboard, <keycombo
><keycap
>Option</keycap
> <keycap
>F2</keycap
></keycombo
>). Use <keycombo
><keycap
>Left Alt</keycap
> <keycap
>F1</keycap
></keycombo
> to switch back to the installer itself. </para
><para condition="gtk"
>For the graphical installer see also <xref linkend="gtk-using"/>. </para
><para
>If you cannot switch consoles, there is also an <guimenuitem
>Execute a Shell</guimenuitem
> item on the main menu that can be used to start a shell. You can get to the main menu from most dialogs by using the &BTN-GOBACK; button one or more times. Type <userinput
>exit</userinput
> to close the shell and return to the installer. </para
><para
>At this point you are booted from the RAM disk, and there is a limited set of Unix utilities available for your use. You can see what programs are available with the command <command
>ls /bin /sbin /usr/bin /usr/sbin</command
> and by typing <command
>help</command
>. The shell is a Bourne shell clone called <command
>ash</command
> and has some nice features like autocompletion and history. </para
><para
>To edit and view files, use the text editor <command
>nano</command
>. Log files for the installation system can be found in the <filename
>/var/log</filename
> directory. </para>
<note
><para
>Although you can do basically anything in a shell that the available commands allow you to do, the option to use a shell is really only there in case something goes wrong and for debugging. </para
><para
>Doing things manually from the shell may interfere with the installation process and result in errors or an incomplete installation. In particular, you should always use let the installer activate your swap partition and not do this yourself from a shell. </para
></note>
   </sect3>
<!--   End of file using-d-i/modules/shell.xml -->

<!-- Start of file using-d-i/modules/network-console.xml -->
<!-- $Id: network-console.xml 56141 2008-09-26 10:45:05Z lunar $ -->

   <sect3 id="network-console">
   <title
>Installation Over the Network</title>

<para arch="not-s390"
>One of the more interesting components is <firstterm
>network-console</firstterm
>. It allows you to do a large part of the installation over the network via SSH. The use of the network implies you will have to perform the first steps of the installation from the console, at least to the point of setting up the networking. (Although you can automate that part with <xref linkend="automatic-install"/>.) </para
><para arch="not-s390"
>This component is not loaded into the main installation menu by default, so you have to explicitly ask for it. If you are installing from CD, you need to boot with medium priority or otherwise invoke the main installation menu and choose <guimenuitem
>Load installer components from CD</guimenuitem
> and from the list of additional components select <guimenuitem
>network-console: Continue installation remotely using SSH</guimenuitem
>. Successful load is indicated by a new menu entry called <guimenuitem
>Continue installation remotely using SSH</guimenuitem
>. </para
><para arch="s390"
>For installations on &arch-title;, this is the default method after setting up the network. </para
><para
><phrase arch="not-s390"
>After selecting this new entry, you</phrase
> <phrase arch="s390"
>You</phrase
> will be asked for a new password to be used for connecting to the installation system and for its confirmation. That's all. Now you should see a screen which instructs you to login remotely as the user <emphasis
>installer</emphasis
> with the password you just provided. Another important detail to notice on this screen is the fingerprint of this system. You need to transfer the fingerprint securely to the <quote
>person who will continue the installation remotely</quote
>. </para
><para
>Should you decide to continue with the installation locally, you can always press &enterkey;, which will bring you back to the main menu, where you can select another component. </para
><para
>Now let's switch to the other side of the wire. As a prerequisite, you need to configure your terminal for UTF-8 encoding, because that is what the installation system uses. If you do not, remote installation will be still possible, but you may encounter strange display artefacts like destroyed dialog borders or unreadable non-ascii characters. Establishing a connection with the installation system is as simple as typing: <informalexample
><screen
>
<prompt>$</prompt> <userinput>ssh -l installer <replaceable>install_host</replaceable></userinput>
</screen
></informalexample
> Where <replaceable
>install_host</replaceable
> is either the name or IP address of the computer being installed. Before the actual login the fingerprint of the remote system will be displayed and you will have to confirm that it is correct. </para
><note
><para
>The <command
>ssh</command
> server in the installer uses a default configuration that does not send keep-alive packets. In principle, a connection to the system being installed should be kept open indefinitely. However, in some situations &mdash; depending on your local network setup &mdash; the connection may be lost after some period of inactivity. One common case where this can happen is when there is some form of Network Address Translation (NAT) somewhere between the client and the system being installed. Depending on at which point of the installation the connection was lost, you may or may not be able to resume the installation after reconnecting. </para
><para
>You may be able to avoid the connection being dropped by adding the option <userinput
>-o&nbsp;ServerAliveInterval=<replaceable
>value</replaceable
></userinput
> when starting the <command
>ssh</command
> connection, or by adding that option in your <command
>ssh</command
> configuration file. Note however that in some cases adding this option may also <emphasis
>cause</emphasis
> a connection to be dropped (for example if keep-alive packets are sent during a brief network outage, from which <command
>ssh</command
> would otherwise have recovered), so it should only be used when needed. </para
></note>

<note
><para
>If you install several computers in turn and they happen to have the same IP address or hostname, <command
>ssh</command
> will refuse to connect to such host. The reason is that it will have different fingerprint, which is usually a sign of a spoofing attack. If you are sure this is not the case, you will need to delete the relevant line from <filename
>~/.ssh/known_hosts</filename
><footnote
> <para
> The following command will remove an existing entry for a host: <command
>ssh-keygen -R &lt;<replaceable
>hostname</replaceable
>|<replaceable
>IP&nbsp;address</replaceable
>&gt;</command
>. </para
> </footnote
> and try again. </para
></note
><para
>After the login you will be presented with an initial screen where you have two possibilities called <guimenuitem
>Start menu</guimenuitem
> and <guimenuitem
>Start shell</guimenuitem
>. The former brings you to the main installer menu, where you can continue with the installation as usual. The latter starts a shell from which you can examine and possibly fix the remote system. You should only start one SSH session for the installation menu, but may start multiple sessions for shells. </para
><warning
><para
>After you have started the installation remotely over SSH, you should not go back to the installation session running on the local console. Doing so may corrupt the database that holds the configuration of the new system. This in turn may result in a failed installation or problems with the installed system. </para
></warning>

   </sect3>
<!--   End of file using-d-i/modules/network-console.xml -->
  </sect2>
 </sect1>
<!--   End of file using-d-i/components.xml -->

<!-- Start of file using-d-i/loading-firmware.xml -->
<!-- $Id: loading-firmware.xml 56290 2008-10-05 15:18:02Z fjp $ -->

 <sect1 id="loading-firmware" arch="not-s390">
 <title
>Loading Missing Firmware</title>
<para
>As described in <xref linkend="hardware-firmware"/>, some devices require firmware to be loaded. In most cases the device will not work at all if the firmware is not available; sometimes basic functionality is not impaired if it is missing and the firmware is only needed to enable additional features. </para
><para
>If a device driver requests firmware that is not available, &d-i; will display a dialog offering to load the missing firmware. If this option is selected, &d-i; will scan available devices for either loose firmware files or packages containing firmware. If found, the firmware will be copied to the correct location (<filename
>/lib/firmware</filename
>) and the driver module will be reloaded. </para>
<note
><para
>Which devices are scanned and which file systems are supported depends on the architecture, the installation method and the stage of the installation. Especially during the early stages of the installation, loading the firmware is most likely to succeed from a FAT-formatted floppy disk or USB stick. <phrase arch="x86"
>On i386 and amd64 firmware can also be loaded from an MMC or SD card.</phrase
> </para
></note>
<para
>Note that it is possible to skip loading the firmware if you know the device will also function without it, or if the device is not needed during the installation. </para>
<warning
><para
>Support for loading firmware is still relatively basic and is likely to be improved in future releases of the installer. Currently &d-i; will for example not display any warning if you choose to load missing firmware, but the requested firmware is not found. Please report any issues you encounter by filing an installation report (see <xref linkend="submit-bug"/>). </para
></warning>

  <sect2
><title
>Preparing a medium</title>
<para
>Although in some cases the firmware can also be loaded from a partition on a hard disk, the most common method to load firmware will be from some removable medium such as a floppy disk or a USB stick. The firmware files or packages must be placed in either the root directory or a directory named <filename
>/firmware</filename
> of the file system on the medium. The recommended file system to use is FAT as that is most certain to be supported during the early stages of the installation. </para
><para
>Tarballs containing current packages for the most common firmware are available from: <itemizedlist
> <listitem
><para
> <ulink url="&url-firmware-tarballs;"
></ulink
> </para
></listitem
> </itemizedlist
> Just download the tarball for the correct release and unpack it to the file system on the medium. </para
><para
>If the firmware you need is not included in the tarball, you can also download specific firmware packages from the (non-free section of the) archive. The following overview should list most available firmware packages but is not guaranteed to be complete and may also contain non-firmware packages: <itemizedlist
> <listitem
><para
> <ulink url="&url-firmware-packages;"
></ulink>
</para
></listitem>
</itemizedlist>

</para
><para
>It is also possible to copy individual firmware files to the medium. Loose firmware could be obtained for example from an already installed system or from a hardware vendor. </para>
  </sect2>

  <sect2
><title
>Firmware and the Installed System</title>
<para
>Any firmware loaded during the installation will be copied automatically to the installed system. In most cases this will ensure that the device that requires the firmware will also work correctly after the system is rebooted into the installed system. However, if the installed system runs a different kernel version from the installer there is a slight chance that the firmware cannot be loaded due to version skew. </para
><para
>If the firmware was loaded from a firmware package, &d-i; will also install this package for the installed system and will automatically add the non-free section of the package archive in APT's <filename
>sources.list</filename
>. This has the advantage that the firmware should be updated automatically if a new version becomes available. </para
><para
>If loading the firmware was skipped during the installation, the relevant device will probably not work with the installed system until the firmware (package) is installed manually. </para>
<note
><para
>If the firmware was loaded from loose firmware files, the firmware copied to the installed system will <emphasis
>not</emphasis
> be automatically updated unless the corresponding firmware package (if available) is installed after the installation is completed. </para
></note>
  </sect2>
 </sect1>
<!--   End of file using-d-i/loading-firmware.xml -->

</chapter>

<!--   End of file using-d-i/using-d-i.xml -->
