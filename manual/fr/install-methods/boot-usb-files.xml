<!-- original version: 45616 -->

 <sect1 condition="bootable-usb" id="boot-usb-files">
 <title>Préparation des fichiers pour un amorçage avec une clé USB</title>

<para>

Pour préparer une clé USB, vous avez besoin d'un système GNU/Linux fonctionnel
qui gère les périphériques USB. Vérifiez que le module du noyau
usb-storage est chargé (<userinput>modprobe usb-storage</userinput>) et trouvez
à quel périphérique SCSI la clé USB est affectée (dans l'exemple qui suit, ce sera
<filename>/dev/sda</filename>). Pour pouvoir écrire sur la clé, il vous faudra
enlever la protection contre l'écriture.
</para>
<para>

Notez que la taille de la clé doit être au moins égale à 256&nbsp;Mo. Pour des
tailles inférieures, voyez <xref linkend="usb-copy-flexible"/>.

</para>

  <sect2 id="usb-copy-easy">
  <title>Copie des fichiers &mdash; méthode simple</title>
<para arch="x86">

Le fichier <filename>hd-media/boot.img.gz</filename> contient tous les
fichiers de l'installateur, le noyau et le programme 
<command>SYSLINUX</command> avec son fichier de configuration. Il vous suffit
d'extraire ces fichiers dans votre clé USB&nbsp;:

<informalexample><screen>
# zcat boot.img.gz &gt; /dev/<replaceable>sda</replaceable>
</screen></informalexample>

</para>
<para arch="powerpc">

Le fichier <filename>hd-media/boot.img.gz</filename> contient tous les
fichiers de l'installateur, le noyau et le programme
<command>yaboot</command> avec son fichier de configuration. Créez une 
partition <quote>Apple_Bootstrap</quote> sur la clé avec la commande 
<userinput>C</userinput> de <command>mac-fdisk</command> et mettez l'image
avec&nbsp;:

<informalexample><screen>
# zcat boot.img.gz &gt; /dev/<replaceable>sda2</replaceable>
</screen></informalexample>
</para>
<warning><para>
Bien sûr, toutes les données présentes sur la clé seront détruites. Assurez-vous
d'utiliser le périphérique correspondant à votre clé&nbsp;!
</para>
</warning>
<para>

Montez ensuite la clé (<userinput>mount 
<replaceable arch="x86">/dev/sda</replaceable>
<replaceable arch="powerpc">/dev/sda2</replaceable> /mnt</userinput>),
qui aura maintenant un système de fichiers 
<phrase arch="x86">FAT</phrase>
<phrase arch="powerpc">HFS</phrase>, et copiez une image ISO de type
<quote>netinst</quote> ou <quote>businesscard</quote>.
Consultez <xref linkend="usb-add-iso"/>. Le nom de ce fichier doit se terminer par
<filename>.iso</filename>. Démontez la clé (<userinput>umount /mnt</userinput>)
et voilà, c'est fait&nbsp;!
</para>
</sect2>

  <sect2 id="usb-copy-flexible">
  <title>Copie des fichiers &mdash; méthode détaillée</title>
<para>

Si vous aimez la souplesse d'utilisation ou si vous voulez simplement savoir ce qui se
passe, vous pouvez utiliser la méthode suivante pour mettre les fichiers
sur la clé. 
</para>

&usb-setup-x86.xml;
&usb-setup-powerpc.xml;

</sect2>

<sect2 id="usb-add-iso">
<title>Ajouter une image ISO</title>
<para>

L'installateur recherchera une image ISO Debian sur la clé où prendre les données
nécessaires à l'installation. Il vous faut donc copier une image ISO
(<quote>businesscard</quote>, <quote>netinst</quote> ou même l'image complète) sur la clé.
Le nom de cette image doit se terminer par <filename>.iso</filename>.

</para>
<para>

Si vous voulez faire une installation sur le réseau, sans utiliser d'image
ISO, vous sauterez bien sûr l'étape précédente. De plus vous devrez utiliser
le disque virtuel initial qui se trouve dans le répertoire
<filename>netboot</filename> au lieu de celui qui se trouve dans le répertoire
<filename>hd-media</filename>, car le fichier 
<filename>hd-media/initrd.gz</filename> ne sait pas utiliser le réseau.

</para>
<para>

Quand tout est fait, démontez la clé USB (<userinput>umount /mnt</userinput>) 
et activez la protection contre l'écriture.

</para>
</sect2>

<!-- TODO: doesn't this section belong later? -->
<sect2 arch="x86">
   <title>Amorcer la clé USB</title>
<warning><para>

Si le système refuse de s'amorcer à partir de la clé, il se peut que le
secteur principal d'amorçage de la clé soit défectueux. Corrigez-le avec le
programme <command>install-mbr</command> qui se trouve dans le paquet
<classname>mbr</classname>&nbsp;:

<informalexample><screen>
# install-mbr /dev/<replaceable>sda</replaceable>
</screen></informalexample>

</para></warning>
  </sect2>
 </sect1>
