<?xml version="1.0" encoding="ISO-8859-2"?>
<!-- $Id: boot-usb-files.xml,v 1.1 2004/03/14 15:06:00 mck-guest Exp $ -->
<!-- original version: 1.2 -->

 <sect1 condition="bootable-usb" id="boot-usb-files">
 <title>Pøíprava souborù pro zavedení z USB zaøízení</title>

<para>

Pro pøípravu USB zaøízení budete potøebovat poèítaè s nainstalovaným
GNU/Linuxem a podporou USB. Pokud pou¾íváte jaderný modul usb-storage,
ujistìte se, ¾e je nahraný (<userinput>modprobe
usb-storage</userinput>) a zkuste zjistit, na které zaøízení je
navázána va¹e USB klíèenka (v tomto pøíkladu pou¾íváme
<filename>/dev/sda</filename>). Pokud klíèenka obsahuje ochranu proti
zápisu, vypnìte ji.

</para><para>

USB klíèenka by mìla mít velikost alespoò 128 MB. Men¹í velikosti jsou
podporovány pouze pøi ruèní výrobì podle <xref
linkend="usb-copy-flexible"/>.

</para>

  <sect2 id="usb-copy-easy">
  <title>Kopírování souborù - jednoduchá cesta</title>
<para>

K dispozici máte soubor <filename>hd-media/boot.img.gz</filename>,
který obsahuje v¹echny instalaèní soubory (vèetnì jádra), zavadìè
<command>SYSLINUX</command> a jeho konfiguraèní soubor. Jediné co
musíte udìlat, je rozbalit ho na USB zaøízení:

<informalexample><screen>

gzip -dc boot.img.gz >/dev/<replaceable>sda</replaceable>

</screen></informalexample>

Tímto znièíte ve¹kerá data na zaøízení, tak¾e se radìji dvakrát
pøesvìdète, ¾e pro svou klíèenku pou¾íváte správné jméno zaøízení.

</para><para>

Na klíèence nyní bude jedna velká oblast typu FAT16. Pøipojte ji
(<userinput>mount /dev/sda /mnt</userinput>) a nakopírujte na ni
ISO obraz malého instalaèního CD (netinst). Na názvu obrazu nezále¾í,
ale musí konèit pøíponou <filename>.iso</filename>. Nyní staèí
klíèenku odpojit (<userinput>umount /mnt</userinput>) a je hotovo.

</para>
  </sect2>

  <sect2 id="usb-copy-flexible">
  <title>Kopírování souborù - pru¾ná cesta</title>
<para>

Pokud máte rádi více pru¾nosti, nebo jen chcete zjistit <quote>co se
dìje za oponou</quote>, mù¾ete pou¾ít nástedující metodu, ve které
mj. uká¾eme, jak místo celého USB zaøízení pou¾ít pouze první oblast.

</para><note><para>

Proto¾e má vìt¹ina USB klíèenek pøednastavenou jednu velkou oblast
typu FAT16 pavdìpodovnì nemusíte klíèenku pøeformátovávat. Pokud to
v¹ak musíte provést, pou¾ijte pro vytvoøení této oblasti
<command>cfdisk</command> nebo podobný nástroj pro dìlení disku. Poté
vytvoøte souborobý systém pøíkazem

<informalexample><screen>

mkdosfs /dev/<replaceable>sda1</replaceable>

</screen></informalexample>

Pøíkaz <command>mkdosfs</command> je obsa¾en v balíku
<classname>dosfstools</classname>. Pozornì se pøesvìdèete, ¾e
pou¾íváte správný název zaøízení!

</para></note><para>

Pro zavedení jádra z klíèenky je zapotøebí zavadìèe. Pøesto¾e byste
mohli pou¾ít témìø libovolný zavadìè (napø. <command>LILO</command>),
je zvykem pou¾ívat <command>SYSLINUX</command>, proto¾e pou¾ívá oblast
typu FAT16 a jeho nastavení se provádí úpravou jednoduchého textového
souboru. Díky tomu mù¾ete zavadìè konfigurovat z témìø libovolného
operaèního systému.

</para><para>

Pro instalaci <command>SYSLINUX</command>u na 1. oblast USB klíèenky
musíte mít nainstalované balíky <classname>syslinux</classname> a
<classname>mtools</classname> a daná oblast nesmí být pøipojená. Poté
zadejte pøíkaz

<informalexample><screen>

syslinux /dev/<replaceable>sda1</replaceable>

</screen></informalexample>

èím¾ se na zaèátek oblasti zapí¹e zavádìcí sektor a vytvoøí se soubor
<filename>ldlinux.sys</filename>, který obsahuje hlavní èást zavadìèe.

</para><para>

Pøipojte oblast (<userinput>mount /dev/sda1 /mnt</userinput>)
a nakopírujte na ni následující soubory:

<itemizedlist>
<listitem><para>

<filename>vmlinuz</filename> (jádro)

</para></listitem>
<listitem><para>

<filename>initrd.gz</filename> (obraz ramdisku)

</para></listitem>
<listitem><para>

<filename>syslinux.cfg</filename> (konfiguraèní soubor SYSLINUXu)

</para></listitem>
<listitem><para>

volitelné jaderné moduly

</para></listitem>
</itemizedlist>

Pokud si chcete soubory pøejmenovat, pamatujte, ¾e
<command>SYSLINUX</command> umí pracovat pouze s DOSovými (8.3) názvy
souborù.

</para><para>

Konfiguraèní soubor <filename>syslinux.cfg</filename> by mìl obsahovat
následující dvì øádky:

<informalexample><screen>

default vmlinuz
append initrd=initrd.gz ramdisk_size=8192 root=/dev/rd/0 init=/linuxrc devfs=mount,dall rw

</screen></informalexample>

Nyní je èas nakopírovat na klíèenku ISO obraz instalaèního CD
(businesscard, netinst nebo, pokud se vejde, dokonce celé první
CD). Na názvu obrazu nezále¾í, ale musí konèit pøíponou
<filename>.iso</filename>.

</para><para>

Pokud nechcete pou¾ít ISO obraz a místo toho budete chtít instalovat
ze sítì, pøedchozí krok samozøejmì pøeskoète. Kromì toho budete muset
pou¾ít ramdisk (<filename>initrd.gz</filename>) z adresáøe
<filename>netboot</filename>, proto¾e ramdisk v adresáøi
<filename>hd-media</filename> nebsahuje podporu pro instalaci ze sítì.

</para><para>

Jestli¾e jste hotovi, odpojte klíèenku (<userinput>umount
/mnt</userinput>) a zapnìte ochranu proti zápisu.

</para><warning><para>

Pokud vá¹ systém odmítá zavádìní z klíèenky, mù¾e to být tím, ¾e je na
klíèence neplatný hlavní zavádìcí záznam (MBR). Opravit jej mù¾ete
programem <command>install-mbr</command> z balíku
<classname>mbr</classname>:

<informalexample><screen>

install-mbr /dev/<replaceable>sda</replaceable>

</screen></informalexample>

</para></warning>
  </sect2>
 </sect1>
