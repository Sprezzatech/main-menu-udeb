#! /bin/sh -e

run_parts() {
    partsdir="$1"
    # run-parts is part of debianutils, is it available in d-i? [pere 2002-11-02]
    if /target/bin/run-parts --report "$partsdir" ; then
	:
    else
	echo "error: run-parts failed.  Using shell script loop instead." 1>&2
        # Using this until run-parts is available.
	for script in "$partsdir"/*; do
	    if [ -x "$script" ] ; then
		"$script" || true
	    else
		echo "error: Unable to execute $script" 1>&2
	    fi
	done
    fi
}

run_parts /usr/lib/prebaseconfig.d
