<!-- original version: 22935 -->

 <sect1 id="linux-upgrade">
 <title>Instalar &debian; desde un sistema Unix/Linux</title>

<para>

Esta sección explica como instalar &debian; desde un sistema Unix o
Linux existente, sin usar el instalador basado en ncurses y menús,
como se explica en el resto de este manual. Este COMO de 
«instalación-transversal» se ha sido solicitado por usuarios que están
cambiándose a &debian; desde RedHat, Mandrake y SuSE. En esta sección 
se asume alguna familiaridad con la introducción de órdenes *nix 
y navegación en el sistema de ficheros. En esta sección <prompt>$</prompt>
simboliza una orden a introducirse en el sistema actual del usuario, 
mientras que <prompt>#</prompt> se refiere a una orden introducida en 
el chroot de Debian.

</para><para>

Una vez que tenga el nuevo sistema Debian configurado a su preferencia,
puede migrar los datos existentes de sus usuarios (si fuese el caso) a
éste y continuar funcionando. Por lo tanto esto algo mas que una
instalación de &debian; "sin paralización". Es también una forma
sabia de tratar con hardware que de otra manera no se comporta
amigablemente con los diversos medios de instalación.

</para>

  <sect2>
  <title>Empezando</title>
<para>

Con las herramientas actuales de particionado de *nix, reparticione
el disco duro como necesite, debe crear por lo menos un sistema de
ficheros más una partición de intercambio (swap). Necesita
por lo menos 150MB de espacio disponible para una instalación de
solo consola o por lo menos 300MB si planea instalar X.

</para><para>

Para crear sistemas de ficheros en sus particiones. Por ejemplo, 
para crear un sistema de ficheros ext3 en la partición 
<filename>/dev/hda6</filename> (es nuestra partición raíz de ejemplo):

<informalexample><screen>

 $ mke2fs -j /dev/hda6

</screen></informalexample>

En cambio para crear un sistema de ficheros ext2, omita <userinput>-j</userinput>.

</para><para>

Inicialice y active la partición de intercambio (sustituya el número de 
partición por la partición de intercambio de Debian que usará):

<informalexample><screen>

 $ mkswap /dev/hda5
 $ sync; sync; sync
 $ swapon /dev/hda5

</screen></informalexample>

</para><para>

Monte una partición como <filename>/mnt/debinst</filename> (el punto
de instalación, para ser el sistema de ficheros raíz 
(<filename>/</filename>) en su nuevo sistema). El nombre del punto de 
montaje es estrictamente arbitrario, mas adelante se hace referencia a éste.

<informalexample><screen>

 $ mkdir /mnt/debinst
 $ mount /dev/hda6 /mnt/debinst

</screen></informalexample>

</para>
  </sect2>

  <sect2>
  <title>Instalar <command>debootstrap</command></title>
<para>

La herramienta que usa el instalador de Debian, que es reconocida
como la forma oficial de instalar un sistema base Debian, es 
<command>debootstrap</command>. Este usa <command>wget</command>, ya que
por otro lado solamente depende de <classname>glibc</classname>. Instale
<command>wget</command>, si todavía no lo ha hecho, en su sistema actual,
luego descargue e instale <command>debootstrap</command>.

</para><para>

Si tiene un sistema basado en rpm, puede usar alien para
convertir el .deb en .rpm, o descargar una versión adaptada a rpm desde
<ulink url="http://people.debian.org/~blade/install/debootstrap"></ulink>

</para><para>

O bien, puede usar el siguiente procedimiento para instalarlo manualmente.
Cree un directorio temporal «trabajo» para extraer el .deb en él:

<informalexample><screen>

 $ mkdir trabajo
 $ cd trabajo

</screen></informalexample>
</para><para>

El binario de <command>debootstrap</command> esta ubicado en el archivo de
Debian (asegúrese de elegir el fichero adecuado para su arquitectura).
Descargue el .deb de <command>debootstrap</command> desde el almacén
de paquetes en <ulink url="http://ftp.debian.org/debian/pool/main/d/debootstrap/">
</ulink>, copie el paquete al directorio «trabajo» y extraiga los
ficheros binarios de éste. Necesitará privilegios de superusuario para 
instalar los binarios.

<informalexample><screen>

 $ tar -xf debootstrap_0.X.X_arch.deb
 $ cd /
 $ zcat &#60; /ruta-completa-hasta-trabajo/trabajo/data.tar.gz | tar xv

</screen></informalexample>

</para>
  </sect2>

  <sect2>
  <title>Ejecute <command>debootstrap</command></title>
<para>

<command>debootstrap</command> puede descargar los ficheros necesarios
directamente desde el archivo cuando lo ejecute. Puede sustituir 
<userinput>http.us.debian.org/debian</userinput> por cualquier réplica
del archivo Debian, en la orden de ejemplo a continuación, preferentemente 
una réplica cercana que tenga funciones de red inteligentes. Los servidores 
de réplica están listados en: 
<ulink url="http://www.debian.org/misc/README.mirrors"></ulink>.

</para><para>

Si tiene un CD de la versión &releasename; de &debian; montado en
<filename>/cdrom</filename>, puede sustituirlo con una dirección de fichero
en lugar de la dirección http: <userinput>file:/cdrom/debian/</userinput>

</para><para>

Sustituya <replaceable>ARQ</replaceable> con alguno de los siguientes en
la orden <command>debootstrap</command>: 

<userinput>alpha</userinput>, 
<userinput>arm</userinput>,
<userinput>hppa</userinput>, 
<userinput>i386</userinput>, 
<userinput>ia64</userinput>, 
<userinput>m68k</userinput>,
<userinput>mips</userinput>, 
<userinput>mipsel</userinput>, 
<userinput>powerpc</userinput>, 
<userinput>s390</userinput> o
<userinput>sparc</userinput>.

<informalexample><screen>

 $ /usr/sbin/debootstrap --arch ARQ sarge \
     /mnt/debinst http://http.us.debian.org/debian

</screen></informalexample>

</para>

  </sect2>

  <sect2>
  <title>Configurar el sistema base</title>

<para>

Ahora tiene un sistema Debian real, aunque algo limitado, en
su disco. Haga <command>chroot</command> en él:

<informalexample><screen>

 $ chroot /mnt/debinst /bin/bash

</screen></informalexample>
</para>

   <sect3>
   <title>Montar particiones</title>
<para>

Necesita crear <filename>/etc/fstab</filename>.

<informalexample><screen>

 # editor /etc/fstab

</screen></informalexample>

</para><para>

Este es un ejemplo que puede modificar a sus necesidades:

<informalexample><screen>

# /etc/fstab: información estática de sistema de ficheros.
#
# file system    mount point   type    options                  dump pass
/dev/XXX         /             ext2    defaults                 0    0
/dev/XXX         /boot         ext2    ro,nosuid,nodev          0    2

/dev/XXX         none          swap    sw                       0    0
proc             /proc         proc    defaults                 0    0

/dev/fd0         /mnt/floppy   auto    noauto,rw,sync,user,exec 0    0
/dev/cdrom       /mnt/cdrom    iso9660 noauto,ro,user,exec      0    0

/dev/XXX         /tmp          ext2    rw,nosuid,nodev          0    2
/dev/XXX         /var          ext2    rw,nosuid,nodev          0    2
/dev/XXX         /usr          ext2    rw,nodev                 0    2
/dev/XXX         /home         ext2    rw,nosuid,nodev          0    2

</screen></informalexample>

</para><para>

Utilice <userinput>mount -a</userinput> para montar todos los sistemas de 
ficheros que ha especificado en <filename>/etc/fstab</filename> o
montelos individualmente usando:

<informalexample><screen>

 # mount /ruta  # por ejm.:  mount /usr

</screen></informalexample>

</para><para>

Puede montar el sistema de ficheros proc muchas veces y en ubicaciones
arbitrarias, aunque /proc es habitual. Si no usa 
<userinput>mount -a</userinput>, asegúrese de montar proc antes de 
continuar:

<informalexample><screen>

 # mount -t proc proc /proc

</screen></informalexample>

</para>

   </sect3>

   <sect3>
   <title>Configurar el teclado</title>

<para>

Para configurar el teclado:

<informalexample><screen>

 # dpkg-reconfigure console-data

</screen></informalexample>

</para>
   </sect3>

   <sect3>
   <title>Configurar la red</title>
<para>

Para configurar la red, edite
<filename>/etc/network/interfaces</filename>,
<filename>/etc/resolv.conf</filename> y
<filename>/etc/hostname</filename>.

<informalexample><screen>

 # editor /etc/network/interfaces 

</screen></informalexample>

</para><para>

Aquí hay algunos ejemplos simples que puede encontrar en
<filename>/usr/share/doc/ifupdown/examples</filename>:

<informalexample><screen>
######################################################################
# /etc/network/interfaces -- fichero de configuración para ifup(8), ifdown(8)
# Vea la página de manual de interfaces(5) para información sobre las
# opciones disponibles.
######################################################################

# Siempre necesitamos la interfaz loopback.
#
auto lo
iface lo inet loopback

# Para usar dhcp:
#
# auto eth0
# iface eth0 inet dhcp

# Un ejemplo de configuración de IP estática: (el broadcast y pasarela son
# opcionales)
#
# auto eth0
# iface eth0 inet static
#     address 192.168.0.42
#     network 192.168.0.0
#     netmask 255.255.255.0
#     broadcast 192.168.0.255
#     gateway 192.168.0.1
</screen></informalexample>

</para><para>

Introduzca su/s servidor/es de nombres y directivas de búsqueda en
<filename>/etc/resolv.conf</filename>:

<informalexample><screen>

 # editor /etc/resolv.conf

</screen></informalexample>

</para><para>

Un <filename>/etc/resolv.conf</filename> simple:

<informalexample><screen>

# search hqdom.local\000
# nameserver 10.1.1.36
# nameserver 192.168.9.100

</screen></informalexample>

</para><para>

Ingrese el nombre de máquina de su sistema (de 2 a 63 caracteres):

<informalexample><screen>

 # echo MaquinaDebian &#62; /etc/hostname

</screen></informalexample>

</para><para>

Si tiene múltiples tarjetas de red, debe añadir los nombres de los
módulos de controlador en el fichero <filename>/etc/modules</filename>
en el orden que desee. Luego durante el arranque, cada tarjeta será
asociada con el nombre de interfaz (eth0, eth1, etc.) que espera.

</para>
   </sect3>

   <sect3>
   <title>Configurar zona horaria, usuarios y APT</title>

<para>

Configure su zona horaria, añada un usuario común y elija sus fuentes
<command>apt</command> ejecutando

<informalexample><screen>

 # /usr/sbin/base-config

</screen></informalexample>
</para>
   </sect3>

   <sect3>
   <title>Configurar locales</title>
<para>

Para configurar los valores de locale para usar un idioma diferente al
Inglés, instale el paquete de soporte a locales y configúrelo:

<informalexample><screen>

 # apt-get install locales
 # dpkg-reconfigure locales

</screen></informalexample>

NOTA: Apt debe configurarse antes, esto es durante la fase base-config.
Antes de utilizar locales con juegos de caracteres diferentes a ASCII o
latin1, por favor consulte el COMO de localización apropiado.

</para>
   </sect3>
  </sect2>

  <sect2>
  <title>Instalar un núcleo</title>

<para>

Si intenta arrancar este sistema, probablemente querrá un núcleo Linux
y un gestor de arranque. Identifique los núcleos pre-empaquetados
disponibles con

<informalexample><screen>

 # apt-cache search kernel-image

</screen></informalexample>

</para><para>

Luego instale su elección usando el nombre del paquete.

<informalexample><screen>

 # apt-get install kernel-image-2.X.X-arquitectura-etc

</screen></informalexample>

</para>
  </sect2>

  <sect2>
<title>Configure el gestor de arranque</title>
<para>

Para hacer su sistema &debian; arrancable, configure su gestor de arranque
para cargar el núcleo instalado en su nueva partición raíz. Note que
debootstrap no instala un gestor de arranque, pero puede usar apt-get
dentro de su chroot Debian para hacer esto.

</para><para arch="i386">

Verifique <userinput>info grub</userinput> o 
<userinput>man lilo.conf</userinput> para instrucciones sobre
configurar el gestor de arranque. Si desea mantener el sistema
que utilizó para instalar Debian, simplemente añada una entrada para
la instalación de Debian en su<filename>menu.lst</filename> o
<filename>lilo.conf</filename> actual. También podría copiarlo
al nuevo sistema y editarlo allí. Luego que finalice la edición, ejecute
lilo (recuerde que éste usará el<filename>lilo.conf</filename> relativo al 
sistema desde el cual lo ejecute).

</para><para arch="i386">

Aquí tiene un ejemplo básico de /etc/lilo.conf:

<informalexample><screen>

boot=/dev/hda6
root=/dev/hda6
install=/boot/boot-menu.b
delay=20
lba32
image=/vmlinuz
label=Debian

</screen></informalexample>

</para><para arch="powerpc">

Verifique <userinput>man yaboot.conf</userinput> para instrucciones
sobre configuración del gestor de arranque. Si desea mantener el 
sistema que utilizó para instalar Debian, simplemente añada una entrada
para la instalación de Debian al <filename>yaboot.conf</filename> existente.
También podrá copiarlo al nuevo sistema y editarlo allí. Luego de que
finalice la edición, ejecute ybin (recuerde que éste usará el
<filename>yaboot.conf</filename> relativo al sistema desde el cual lo ejecute).

</para><para arch="powerpc">

Aquí tiene un ejempo básico de <filename>/etc/yaboot.conf</filename>:

<informalexample><screen>

boot=/dev/hda2
device=hd:
partition=6
root=/dev/hda6
magicboot=/usr/lib/yaboot/ofboot
timeout=50
image=/vmlinux
label=Debian

</screen></informalexample>

En algunas máquinas, puede que necesite usar <userinput>ide0:</userinput> 
en lugar de <userinput>hd:</userinput>. 

</para>
  </sect2>
 </sect1>
