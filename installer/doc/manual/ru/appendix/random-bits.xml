<!-- Start of file appendix/random-bits.xml -->
<!-- $Id: random-bits.xml 22661 2004-10-06 15:34:52Z fjpop-guest $ -->

<appendix id="random-bits"
><title
>Разное</title>


<!-- Start of file appendix/example-preseed.xml -->
<!-- $Id: example-preseed.xml 24835 2005-01-09 00:07:40Z pronik-guest $ -->

<sect1 id="example-preseed">
<title
>Пример файла автоматической установки</title>

<para
>Это полностью работающий пример файла автоматической установки. В <xref linkend="automatic-install"/> описано как его использовать. Вы можете убрать комментарии с нужных вам строк перед использованием этого файла. </para>

<note
><para
>Для правильного отображения этого примера в руководстве мы разделили некоторые строки. Это можно определить по символу продолжения строки <quote
>\</quote
> и дополнительному отступу в следующей строке. В рабочем конфигурационном файле эти строки должны быть объединены в <emphasis
>одну строку</emphasis
>. Если вы этого не сделаете, автоматическая установка завершится неудачно с непредсказуемым результатом. </para
></note>

<informalexample
><screen
>#### Modifying syslinux.cfg.

# Edit the syslinux.cfg (or similar) file, and add parameters to the end
# of the append line(s) for the kernel.
#
# You'll at least want to add a parameter telling the installer where to
# get its preseed file from.
# If you're installing from USB media, use this, and put the preseed file
# in the toplevel directory of the USB stick.
#   preseed/file=/hd-media/preseed
# If you're netbooting, use this instead:
#   preseed/url=http://host/path/to/preseed
# If you're remastering a CD, you could use this:
#   preseed/file=/cdrom/preseed
# Be sure to copy this file to the location you specify.
# 
# While you're at it, you may want to throw a debconf/priority=critical in
# there, to avoid most questions even if the preseeding below misses some.
# And you might set the timeout to 1 in syslinux.cfg to avoid needing to hit
# enter to boot the installer.
#
# Language, country, and keyboard selection cannot be preseeded from a file,
# because the questions are asked before the preseed file can be loaded.
# Instead, to avoid these questions, pass some more parameters to the kernel:
#
#    languagechooser/language-name=English
#    countrychooser/shortlist=US
#    console-keymaps-at/keymap=us
#
# Note that the kernel accepts a maximum of 8 command line options and
# 8 environment options (including any options added by default for the
# installer). If these numbers are exceeded, 2.4 kernels will drop any
# excess options and 2.6 kernels will panic.
# Some of the default options, like 'vga=normal' and 'devfs=mount' may be
# safely removed for most installations, which may allow you to add more
# options for preseeding.

#### Shell commands.

# d-i preseeding is inherently not secure. Nothing in the installer checks
# for attempts at buffer overflows or other exploits of the values of a
# preseed file like this one. Only use preseed files from trusted
# locations! To drive that home, and because it's generally useful, here's
# a way to run any shell command you'd like inside the installer,
# automatically.

# This first command is run as early as possible, just after
# preseeding is read.
#d-i preseed/early_command              string \
#    wget http://url/to/my.udeb -O /tmp/my.udeb; udpkg -i /tmp/my.udeb

# This command is run just before the install finishes, but when there is
# still a usable /target directory.
#d-i preseed/late_command               string \
#    for deb in /hd-media/*.deb; do cp $deb /target/tmp; \
#    chroot /target dpkg -i /tmp/$(basename $deb); done

# This command is run just as base-config is starting up.
#base-config base-config/early_command  string echo hi mom

# This command is run after base-config is done, just before the login:
# prompt. This is a good way to install a set of packages you want, or to
# tweak the configuration of the system.
#base-config base-config/late_command   string \
#    apt-get install zsh; chsh -s /bin/zsh

#### Network configuration.

# Of course, this won't work if you're loading your preseed file from the
# network! But it's great if you're booting from CD or USB stick. You can
# also pass network config parameters in on the kernel params if you are
# loading preseed files from the network.

# netcfg will choose an interface that has link if possible. This makes it
# skip displaying a list if there is more than one interface.
d-i  netcfg/choose_interface            select auto

# If you prefer to configure the network manually, here's how:
#d-i netcfg/disable_dhcp                boolean true
#d-i netcfg/get_nameservers             string 192.168.1.1
#d-i netcfg/get_ipaddress               string 192.168.1.42
#d-i netcfg/get_netmask                 string 255.255.255.0
#d-i netcfg/get_gateway                 string 192.168.1.1
#d-i netcfg/confirm_static              boolean true

# Note that any hostname and domain names assigned from dhcp take
# precedence over values set here. However, setting the values still
# prevents the questions from being shown even if values come from dhcp.
d-i  netcfg/get_hostname                string unassigned-hostname
d-i  netcfg/get_domain                  string unassigned-domain

# Disable that annoying WEP key dialog.
d-i  netcfg/wireless_wep                string
# The wacky dhcp hostname that some ISPs use as a password of sorts.
#d-i netcfg/dhcp_hostname               string radish

#### Mirror settings.

d-i  mirror/country                     string enter information manually
d-i  mirror/http/hostname               string http.us.debian.org
d-i  mirror/http/directory              string /debian
d-i  mirror/suite                       string testing
d-i  mirror/http/proxy                  string 

### Partitioning.

# If the system has free space you can choose to only partition that space.
#d-i partman-auto/init_automatically_partition \
#    select Use the largest continuous free space

# Alternatively, you can specify a disk to partition. The device name can
# be given in either devfs or traditional non-devfs format.
# For example, to use the first disk devfs knows of:
d-i  partman-auto/disk                  string /dev/discs/disc0/disc

# You can choose from any of the predefined partitioning recipes:
d-i  partman-auto/choose_recipe         select \
     All files in one partition (recommended for new users)
#d-i partman-auto/choose_recipe         select Desktop machine
#d-i partman-auto/choose_recipe         select Multi-user workstation

# Or provide a recipe of your own...
# The recipe format is documented in the file devel/partman-auto-recipe.txt.
# If you have a way to get a recipe file into the d-i environment, you can
# just point at it.
#d-i partman-auto/expert_recipe_file    string /hd-media/recipe

# If not, you can put an entire recipe in one line. This example creates
# a small /boot partition, suitable swap, and uses the rest of the space
# for the root partition:
#d-i partman-auto/expert_recipe         string boot-root :: \
#    20 50 100 ext3 $primary{ } $bootable{ } method{ format } format{ } \
#    use_filesystem{ } filesystem{ ext3 } mountpoint{ /boot } . \
#    500 10000 1000000000 ext3 method{ format } format{ } \
#    use_filesystem{ } filesystem{ ext3 } mountpoint{ / } . \
#    64 512 300% linux-swap method{ swap } format{ } . 
# For reference, here is that same recipe in a more readable form:
#    boot-root ::
#       40 50 100 ext3
#          $primary{ } $bootable{ }
#          method{ format } format{ }
#          use_filesystem{ } filesystem{ ext3 }
#          mountpoint{ /boot }
#       .
#       500 10000 1000000000 ext3
#          method{ format } format{ }
#          use_filesystem{ } filesystem{ ext3 }
#          mountpoint{ / }
#       .
#       64 512 300% linux-swap
#          method{ swap } format{ }
#       .

# This makes partman automatically partition without confirmation.
d-i partman/confirm_write_new_label     boolean true
d-i partman/choose_partition            select \
    Finish partitioning and write changes to disk
d-i partman/confirm                     boolean true

#### Boot loader installation.

# Grub is the default boot loader (for x86). If you want lilo installed
# instead, uncomment this:
#d-i grub-installer/skip                boolean true

# This is fairly safe to set, it makes grub install automatically to the MBR
# if no other operating system is detected on the machine.
d-i  grub-installer/only_debian         boolean true

# This one makes grub-installer install to the MBR if if finds some other OS
# too, which is less safe as it might not be able to boot that other OS.
d-i  grub-installer/with_other_os       boolean true

# Alternatively, if you want to install to a location other than the mbr,
# uncomment and edit these lines:
#d-i grub-installer/bootdev             string (hd0,0)
#d-i grub-installer/only_debian         boolean false
#d-i grub-installer/with_other_os       boolean false

##### Finishing up the first stage install.

# Avoid that last message about the install being complete.
d-i  prebaseconfig/reboot_in_progress   note 


##### Preseeding base-config.
# XXX: Note that most of this will not work right until base-config 2.40.4
# is available.

# Avoid the introductory message.
base-config  base-config/intro          note

# Avoid the final message.
base-config  base-config/login          note

# If you installed a display manager, but don't want to start it immediately
# after base-config finishes.
#base-config base-config/start-display-manager        boolean false

###### Time zone setup.

# Controls whether or not the hardware clock is set to GMT.
base-config  tzconfig/gmt                             boolean true

# If you told the installer that you're in the United States, then you
# can set the time zone using this variable.
# (Choices are: Eastern, Central, Mountain, Pacific, Alaska, Hawaii,
# Aleutian, Arizona East-Indiana, Indiana-Starke, Michigan, Samoa, other)
base-config  tzconfig/choose_country_zone/US          select Eastern
# If you told it you're in Canada.
# (Choices are: Newfoundland, Atlantic, Eastern, Central,
# East-Saskatchewan, Saskatchewan, Mountain, Pacific, Yukon, other)
base-config  tzconfig/choose_country_zone/CA          select Eastern
# If you told it you're in Brazil. (Choices are: East, West, Acre,
# DeNoronha, other)
base-config  tzconfig/choose_country_zone/BR          select East
# Many countries have only one time zone. If you told the installer you're
# in one of those countries, you can choose its standard time zone via this
# question.
base-config  tzconfig/choose_country_zone_single      boolean true
# This question is asked as a fallback for countries other than those
# listed above, which have more than one time zone. You can preseed one of
# the time zones, or "other".
#base-config tzconfig/choose_country_zone_multiple    select 

###### Account setup.

# To preseed the root password, you have to put it in the clear in this
# file. That is not a very good idea, use caution!
#passwd passwd/root-password            password r00tme
#passwd passwd/root-password-again      password r00tme

# If you want to skip creation of a normal user account.
#passwd passwd/make-user                boolean false

# Alternatively, you can preseed the user's name and login.
#passwd passwd/user-fullname            string Debian User
#passwd passwd/username                 string debian
# And their password, but use caution!
#passwd passwd/user-password            password insecure
#passwd passwd/user-password-again      password insecure

###### Apt setup.

# This question controls what source the second stage installation uses
# for packages. Choices are cdrom, http, ftp, filesystem, edit sources list
# by hand
base-config  apt-setup/uri_type         select http

# If you choose ftp or http, you'll be asked for a country and a mirror.
base-config  apt-setup/country          select enter information manually
base-config  apt-setup/hostname         string http.us.debian.org
base-config  apt-setup/directory        string /debian
# Stop after choosing one mirror.
base-config  apt-setup/another          boolean false

# You can choose to install non-free and contrib software.
#base-config apt-setup/non-free         boolean true
#base-config apt-setup/contrib          boolean true

# Do enable security updates.
base-config  apt-setup/security-updates boolean true

###### Package selection.

# You can choose to install any combination of tasks that are available.
# Available tasks as of this writing include: Desktop environment,
# Web server, Print server, DNS server, File server, Mail server, 
# SQL database, manual package selection. The last of those will run
# aptitude. You can also choose to install no tasks, and force the
# installation of a set of packages in some other way.
# XXX: this will not work until tasksel 2.12 is available
tasksel      tasksel/first   multiselect Desktop environment
#tasksel     tasksel/first   multiselect Web server, Mail server, DNS server

###### Mailer configuration.

# During a normal install, exim asks only two questions. Here's how to
# avoid even those. More complicated preseeding is possible.
exim4-config exim4/dc_eximconfig_configtype \
    select no configuration at this time

# It's a good idea to set this to whatever user account you choose to
# create. Leaving the value blank results in postmaster mail going to
# /var/mail/mail.
exim4-config exim4/dc_postmaster        string 

###### X Configuration.

# Preseeding Debian's X config is possible, but you probably need to know
# some details about the video hardware of the machine, since Debian's X
# configurator does not do fully automatic configuration of everything.

# X can detect the right driver for some cards, but if you're preseeding,
# you override whatever it chooses. Still, vesa will work most places.
#xserver-xfree86 xserver-xfree86/config/device/driver select vesa

# A caveat with mouse autodetection is that if it fails, X will retry it
# over and over. So if it's preseeded to be done, there is a possibility of
# an infinite loop if the mouse is not autodetected.
#xserver-xfree86 xserver-xfree86/autodetect_mouse     boolean true

# Monitor autodetection is recommended.
xserver-xfree86 xserver-xfree86/autodetect_monitor    boolean true
# Uncomment if you have a LCD display.
#xserver-xfree86 xserver-xfree86/config/monitor/lcd   boolean true
# X has three configuration paths for the monitor. Here's how to preseed
# the "medium" path, which is always available. The "simple" path may not
# be available, and the "advanced" path asks too many questions.
xserver-xfree86  xserver-xfree86/config/monitor/selection-method \
    select medium
xserver-xfree86  xserver-xfree86/config/monitor/mode-list \
    select 1024x768 @ 60 Hz

###### Everything else.

# Depending on what software you choose to install, or if things go wrong
# during the installation process, it's possible that other questions may
# be asked. You can preseed those too, of course. To get a list of every
# possible question that could be asked during an install, do an
# installation, and then run these commands:
#   debconf-get-selections --installer > file
#   debconf-get-selections >> file

# If you like, you can include other preseed files into this one.
# Any settings in those files will override pre-existing settings from this
# file. More that one file can be listed, separated by spaces; all will be
# loaded. The included files can have preseed/include directives of their
# own as well. Note that if the filenames are relative, they are taken from
# the same directory as the preseed file that includes them.
#d-i preseed/include                    string x.cfg

# More flexibly, this runs a shell command and if it outputs the names of
# preseed files, includes those files. For example, to switch configs based
# on a particular usb storage device (in this case, a built-in card reader):
#d-i preseed/include_command            string \
#    if $(grep -q "GUID: 0aec3050aec305000001a003" /proc/scsi/usb-storage-*/*); \
#    then echo kraken.cfg; else echo otherusb.cfg; fi
</screen
></informalexample>

</sect1>
<!--   End of file appendix/example-preseed.xml -->

<!-- Start of file appendix/files.xml -->
<!-- $Id: files.xml 24835 2005-01-09 00:07:40Z pronik-guest $ -->


 <sect1 id="linuxdevices"
><title
>Устройства Linux</title>
<para
>В Linux в каталоге <filename
>/dev</filename
> есть различные специальные файлы. Эти файлы называются файлами устройств. В мире Unix доступ к аппаратуре отличен от того как это делают другие операционные системы. Здесь у вас есть специальный файл, который в действительности обслуживается драйвером, осуществляющим доступ к аппаратуре. Файл устройства &mdash; это интерфейс к настоящим системным компонентам. Файлы в <filename
>/dev</filename
> также отличаются от обычных файлов. Ниже перечислены самые важные файлы устройств. </para
><para>

<informaltable
><tgroup cols="2">
<colspec colnum="1" align="center" colwidth="5em"/>
<colspec colnum="2" align="center" colwidth="1*"/>
<tbody>
<row>
  <entry
><filename
>fd0</filename
></entry>
  <entry
>Первый дисковод</entry>
</row
><row>
  <entry
><filename
>fd1</filename
></entry>
  <entry
>Второй дисковод</entry>
</row>
</tbody
></tgroup
></informaltable>

<informaltable
><tgroup cols="2">
<colspec colnum="1" align="center" colwidth="5em"/>
<colspec colnum="2" align="center" colwidth="1*"/>
<tbody>
<row>
  <entry
><filename
>hda</filename
></entry>
  <entry
>Жёсткий диск IDE / CD-ROM на первом порту IDE (мастер)</entry>
</row
><row>
  <entry
><filename
>hdb</filename
></entry>
  <entry
>Жёсткий диск IDE / CD-ROM на первом порту IDE (подчинённый)</entry>
</row
><row>
  <entry
><filename
>hdc</filename
></entry>
  <entry
>Жёсткий диск IDE / CD-ROM на втором порту IDE (мастер)</entry>
</row
><row>
  <entry
><filename
>hdd</filename
></entry>
  <entry
>Жёсткий диск IDE / CD-ROM на втором порту IDE (подчинённый)</entry>
</row
><row>
  <entry
><filename
>hda1</filename
></entry>
  <entry
>Первый раздел на первом жёстком диске IDE</entry>
</row
><row>
  <entry
><filename
>hdd15</filename
></entry>
  <entry
>Пятнадцатый раздел на четвёртом жёстком диске IDE</entry>
</row>
</tbody
></tgroup
></informaltable>

<informaltable
><tgroup cols="2">
<colspec colnum="1" align="center" colwidth="5em"/>
<colspec colnum="2" align="center" colwidth="1*"/>
<tbody>
<row>
  <entry
><filename
>sda</filename
></entry>
  <entry
>Жёсткий диск SCSI с наименьшим SCSI ID (т.е. 0)</entry>
</row
><row>
  <entry
><filename
>sdb</filename
></entry>
  <entry
>Жёсткий диск SCSI со следующим наибольшим SCSI ID (т.е. 1)</entry>
</row
><row>
  <entry
><filename
>sdc</filename
></entry>
  <entry
>Жёсткий диск SCSI со следующим наибольшим SCSI ID (т.е. 2)</entry>
</row
><row>
  <entry
><filename
>sda1</filename
></entry>
  <entry
>Первый раздел на первом жёстком диске SCSI</entry>
</row
><row>
  <entry
><filename
>sdd10</filename
></entry>
  <entry
>Десятый раздел на четвёртом жёстком диске SCSI</entry>
</row>
</tbody
></tgroup
></informaltable>

<informaltable
><tgroup cols="2">
<colspec colnum="1" align="center" colwidth="5em"/>
<colspec colnum="2" align="center" colwidth="1*"/>
<tbody>
<row>
  <entry
><filename
>sr0</filename
></entry>
  <entry
>SCSI CD-ROM с наименьшим SCSI ID</entry>
</row
><row>
  <entry
><filename
>sr1</filename
></entry>
  <entry
>SCSI CD-ROM со следующим наибольшим SCSI ID</entry>
</row>
</tbody
></tgroup
></informaltable>

<informaltable
><tgroup cols="2">
<colspec colnum="1" align="center" colwidth="5em"/>
<colspec colnum="2" align="center" colwidth="1*"/>
<tbody>
<row>
  <entry
><filename
>ttyS0</filename
></entry>
  <entry
>Последовательный порт 0, COM1 под MS-DOS</entry>
</row
><row>
  <entry
><filename
>ttyS1</filename
></entry>
  <entry
>Последовательный порт 1, COM2 под MS-DOS</entry>
</row
><row>
  <entry
><filename
>psaux</filename
></entry>
  <entry
>Устройство мышь PS/2 </entry>
</row
><row>
  <entry
><filename
>gpmdata</filename
></entry>
  <entry
>Псевдо-устройство, повторитель данных от демона GPM (мыши)</entry>
</row>
</tbody
></tgroup
></informaltable>

<informaltable
><tgroup cols="2">
<colspec colnum="1" align="center" colwidth="5em"/>
<colspec colnum="2" align="center" colwidth="1*"/>
<tbody>
<row>
  <entry
><filename
>cdrom</filename
></entry>
  <entry
>Символическая ссылка на привод CD-ROM</entry>
</row
><row>
  <entry
><filename
>mouse</filename
></entry>
  <entry
>Символическая ссылка на файл устройства мыши</entry>
</row>
</tbody
></tgroup
></informaltable>

<informaltable
><tgroup cols="2">
<colspec colnum="1" align="center" colwidth="5em"/>
<colspec colnum="2" align="center" colwidth="1*"/>
<tbody>
<row>
  <entry
><filename
>null</filename
></entry>
  <entry
>Всё, что направлено в этот интерфейс, исчезнет</entry>
</row
><row>
  <entry
><filename
>zero</filename
></entry>
  <entry
>Можно бесконечно читать нули из этого устройства</entry>
</row>
</tbody
></tgroup
></informaltable>

</para>

  <sect2>
<title
>Установка мыши</title>

<para
>Мышь можно использовать одновременно и в консоли Linux (с помощью gpm) и в среде X window. Это возможно, если использовать повторитель gpm, который позволит передачу сигналовX серверу: <informalexample
><screen>
mouse =&gt; /dev/psaux  =&gt; gpm =&gt; /dev/gpmdata -&gt; /dev/mouse =&gt; X
         /dev/ttyS0             (repeater)        (symlink)
         /dev/ttyS1
</screen
></informalexample
> Установите протокол повторителя в raw (в файле <filename
>/etc/gpm.conf</filename
>), а в настройках X изначальный протокол работы мыши(в файле <filename
>/etc/X11/XF86Config</filename
> или <filename
>/etc/X11/XF86Config-4</filename
>). </para
><para
>Такой подход с использованием gpm даже в X имеет преимущество, если мышь отключат по неосторожности. Простой перезапуск gpm командой <informalexample
><screen>
# /etc/init.d/gpm restart
</screen
></informalexample
> подключит мышь в программе заново без перезапуска X. </para
><para
>Если gpm выключен или не установлен по некоторым причинам, убедитесь что X сервер настроен на чтение прямо из устройства мышь, например /dev/psaux. Подробней смотрите 3-Button Mouse mini-Howto в <filename
>/usr/share/doc/HOWTO/en-txt/mini/3-Button-Mouse.gz</filename
>, <userinput
>man gpm</userinput
>, <filename
>/usr/share/doc/gpm/FAQ.gz</filename
> и <ulink url="&url-xfree86;current/mouse.html"
>README.mouse</ulink
>. </para
><para arch="powerpc"
>Для PowerPC в <filename
>/etc/X11/XF86Config</filename
> или <filename
>/etc/X11/XF86Config-4</filename
> установите устройство мышь в <userinput
>"/dev/input/mice"</userinput
>. </para
><para arch="powerpc"
>Современные ядра дают вам возможность эмулировать трехкнопочную мышь, когда у вашей мыши только одна кнопка. Просто добавьте следующие строки в файл <filename
>/etc/sysctl.conf</filename
>. <informalexample
><screen
># эмуляция 3-кнопочной мыши 
# включить эмуляцию
/dev/mac_hid/mouse_button_emulation = 1
# Посылать сингал средней кнопки мышки клавишей F11
/dev/mac_hid/mouse_button2_keycode = 87
# Посылать сингал правой кнопки мышки клавишей F12
/dev/mac_hid/mouse_button3_keycode = 88
# Для других клавиш, используйте showkey, который скажет вам нужный код.
</screen
></informalexample>

</para>
  </sect2>
 </sect1>

 <sect1 id="tasksel-size-list">
 <title
>Дисковое пространство, необходимое для задач</title>
<para
>Для базовой установки на i386, включая все стандартные пакеты, требуется 178МБ дискового пространства. </para
><para
>В следующей таблице содержатся размеры, полученные из aptitude для задач, описанных в tasksel. Заметим, что некоторые пакеты содержатся в нескольких задачах одновременно, поэтому полный размер установки для двух задач вместе может быть меньше, чем полный размер, полученный сложением размеров. </para
><para>

<informaltable
><tgroup cols="4">
<thead>
<row>
  <entry
>Задача</entry>
  <entry
>Размер после установки (МБ)</entry>
  <entry
>Размер загрузки (МБ)</entry>
  <entry
>Требуемое место для установки (МБ)</entry>
</row>
</thead>
<colspec colnum="1" align="center" colwidth="1*"/>
<colspec colnum="2" align="center" colwidth="1*"/>
<colspec colnum="3" align="center" colwidth="1*"/>
<colspec colnum="4" align="center" colwidth="1*"/>
<tbody>
<row>
  <entry
>Рабочий стол</entry>
  <entry
>1537</entry>
  <entry
>521</entry>
  <entry
>2058</entry>
</row>

<row>
  <entry
>Веб сервер</entry>
  <entry
>71</entry>
  <entry
>21</entry>
  <entry
>92</entry>
</row>

<row>
  <entry
>Сервер печати</entry>
  <entry
>240</entry>
  <entry
>83</entry>
  <entry
>323</entry>
</row>

<row>
  <entry
>Почтовый сервер</entry>
  <entry
>41</entry>
  <entry
>12</entry>
  <entry
>53</entry>
</row>

<row>
  <entry
>Файловый сервер</entry>
  <entry
>85</entry>
  <entry
>34</entry>
  <entry
>119</entry>
</row>

<row>
  <entry
>SQL база данных</entry>
  <entry
>108</entry>
  <entry
>33</entry>
  <entry
>141</entry>
</row>

</tbody>
</tgroup
></informaltable>

</para>
 </sect1>
<!--   End of file appendix/files.xml -->

<!-- Start of file appendix/chroot-install.xml -->
<!-- $Id: chroot-install.xml 24677 2005-01-01 23:01:40Z fjpop-guest $ -->

 <sect1 id="linux-upgrade">
 <title
>Установка &debian; из системы Unix/Linux</title>

<para
>В этом разделе объясняется, как установить &debian; из существующей системы Unix или Linux без использования управляемой из меню программы установки, основанной на библиотеке ncurses, как это описывается в остальном руководстве. Это "междистрибутивное" HOWTO попросили пользователи, переходящие на &debian; из Redhat, Mandrake и SUSE. В этом разделе подразумевается наличие некоторого опыта работы с командами *nix и навигации по файловой системе. Здесь <prompt
>$</prompt
> означает команду, вводимую в текущей пользовательской системе, а <prompt
>#</prompt
> относится к команде, вводимой в Debian chroot. </para
><para
>Как только вы получите новую систему Debian, настроенную по вашим предпочтениям, вы можете перенести ваши данные (если они есть) в неё и продолжать работу. Поэтому такая установка &debian; считается "с нулевым временем простоя" (zero downtime). Также это мудрый способ работы с аппаратурой, которая не может нормально работать с разными загрузочными или установочными носителями. </para>

  <sect2>
  <title
>Начинаем</title>
<para
>С помощью имеющейся утилиты работы с разделами диска, переразметьте диск как нужно, создав как минимум одну файловую систему плюс раздел подкачки (swap). Вам потребуется минимум 150 МБ для консольной версии установки или минимум 300 МБ, если вы планируете установить X. </para
><para
>Создание файловых систем на разделах. Например, чтобы создать файловую систему ext3 на разделе <filename
>/dev/hda6</filename
> (это корневой раздел в нашем примере): <informalexample
><screen>
# mke2fs -j /dev/hda6
</screen
></informalexample
> Чтобы создать файловую систему ext2, не указывайте параметр <userinput
>-j</userinput
>. </para
><para
>Инициальзация и активирование подкачки (замените номер раздела на свой): <informalexample
><screen>
# mkswap /dev/hda5
# sync; sync; sync
# swapon /dev/hda5
</screen
></informalexample
> Смонтируйте один раздел как <filename
>/mnt/debinst</filename
> (точка установки, она будет корневой (<filename
>/</filename
>) файловой системой в вашей новой системе). Имя точки монтирования абсолютно произвольное, оно описано позже. <informalexample
><screen
># mkdir /mnt/debinst
# mount /dev/hda6 /mnt/debinst
</screen
></informalexample>

</para>
  </sect2>

  <sect2>
  <title
>Установка <command
>debootstrap</command
></title>
<para
>Инструмент, которым пользуется программа установки Debian и который признан официальным способом установки базовой системы Debian &mdash; <command
>debootstrap</command
>. Он использует <command
>wget</command
>, но зависит только от <classname
>/bin/sh</classname
>. Установите <command
>wget</command
>, если его ещё нет в вашей текущей системе, а затем загрузите и установите <command
>debootstrap</command
>. </para
><para
>Если у вас система, основанная на rpm, вы можете использовать alien для конвертации .deb в .rpm или загрузить rpm версию с <ulink url="http://people.debian.org/~blade/install/debootstrap"
></ulink
> </para
><para
>Или вы можете использовать следующую процедуру установки вручную. Создайте каталог work для распаковки в него .deb: <informalexample
><screen>
# mkdir work
# cd work
</screen
></informalexample
> Бинарный файл <command
>debootstrap</command
> расположен в архиве Debian (убедитесь, что вы выбрали правильный файл, соответствующий вашей архитектуре). Загрузите <command
>debootstrap</command
> .deb из <ulink url="http://ftp.debian.org/debian/pool/main/d/debootstrap/"
>пула</ulink
>, скопируйте пакет в каталог work и извлеките из него бинарные файлы. Вам потребуются привилегии суперпользователя (root) для установки бинарных файлов. <informalexample
><screen
># tar -xf debootstrap_0.X.X_arch.deb
# cd /
# zcat /full-path-to-work/work/data.tar.gz | tar xv
</screen
></informalexample>

</para>
  </sect2>

  <sect2>
  <title
>Запуск <command
>debootstrap</command
></title>
<para
>При запуске, <command
>debootstrap</command
> загружает необходимые файлы прямо из архива. В примере ниже вы можете заменить <userinput
>http.us.debian.org/debian</userinput
> на любой сервер-зеркало архивов Debian, лучше всего использовать из наиболее близкой к вам сети. Список серверов <ulink url="http://www.debian.org/misc/README.mirrors"
></ulink
>. </para
><para
>Если у вас есть компакт-диск с &releasename; &debian;, смонтированный в <filename
>/cdrom</filename
>, вы можете подставить URL типа file вместо http URL: <userinput
>file:/cdrom/debian/</userinput
> </para
><para
>Замените <replaceable
>ARCH</replaceable
> на один из следующих вариантов в команде запуска <command
>debootstrap</command
>: <userinput
>alpha</userinput
>, <userinput
>arm</userinput
>, <userinput
>hppa</userinput
>, <userinput
>i386</userinput
>, <userinput
>ia64</userinput
>, <userinput
>m68k</userinput
>, <userinput
>mips</userinput
>, <userinput
>mipsel</userinput
>, <userinput
>powerpc</userinput
>, <userinput
>s390</userinput
> или <userinput
>sparc</userinput
>. <informalexample
><screen
># /usr/sbin/debootstrap --arch ARCH &releasename; \
     /mnt/debinst http://http.us.debian.org/debian
</screen
></informalexample>

</para>
  </sect2>

  <sect2>
  <title
>Настройка базовой системы</title>
<para
>Теперь у вас на диске есть настоящая, пусть и слабенькая, система Debian. Выполните <command
>Chroot</command
> в неё: <informalexample
><screen
># chroot /mnt/debinst /bin/bash
</screen
></informalexample>

</para>

   <sect3>
   <title
>Монтирование разделов</title>
<para
>Вам нужно создать файл <filename
>/etc/fstab</filename
>. <informalexample
><screen>
# editor /etc/fstab
</screen
></informalexample
> Вот пример, измените его под ваши условия: <informalexample
><screen>
# /etc/fstab: информация о статических файловых системах.
#
# файл. система  точка монтир. тип     параметры                дамп проход
/dev/XXX         /             ext2    defaults                 0    0
/dev/XXX         /boot         ext2    ro,nosuid,nodev          0    2

/dev/XXX         none          swap    sw                       0    0
proc             /proc         proc    defaults                 0    0

/dev/fd0         /mnt/floppy   auto    noauto,rw,sync,user,exec 0    0
/dev/cdrom       /mnt/cdrom    iso9660 noauto,ro,user,exec      0    0

/dev/XXX         /tmp          ext2    rw,nosuid,nodev          0    2
/dev/XXX         /var          ext2    rw,nosuid,nodev          0    2
/dev/XXX         /usr          ext2    rw,nodev                 0    2
/dev/XXX         /home         ext2    rw,nosuid,nodev          0    2
</screen
></informalexample
> Выполните <userinput
>mount -a</userinput
>, чтобы смонтировать все файловые системы, заданные в файле <filename
>/etc/fstab</filename
>, или для монтирования определённой файловой системы выполните: <informalexample
><screen>
# mount /path   # e.g.: mount /usr
</screen
></informalexample
> Вы можете монтировать файловую систему proc несколько раз и в произвольные места, хотя принято в /proc. Если вы не использовали <userinput
>mount -a</userinput
>, то перед тем как продолжить, убедитесь, что proc смонтирована: <informalexample
><screen
># mount -t proc proc /proc
</screen
></informalexample>

</para>
   </sect3>

   <sect3>
   <title
>Настройка клавиатуры</title>
<para
>Для настройки клавиатуры введите: <informalexample
><screen
># dpkg-reconfigure console-data
</screen
></informalexample>

</para>
   </sect3>

   <sect3>
   <title
>Настройка сети</title>
<para
>Для настройки сети, отредактируйте <filename
>/etc/network/interfaces</filename
>, <filename
>/etc/resolv.conf</filename
> и <filename
>/etc/hostname</filename
>. <informalexample
><screen>
# editor /etc/network/interfaces 
</screen
></informalexample
> Здесь приведены некоторые простые примеры из <filename
>/usr/share/doc/ifupdown/examples</filename
>: <informalexample
><screen>
######################################################################
# /etc/network/interfaces -- configuration file for ifup(8), ifdown(8)
# See the interfaces(5) manpage for information on what options are 
# available.
######################################################################

# We always want the loopback interface.
#
auto lo
iface lo inet loopback

# To use dhcp:
#
# auto eth0
# iface eth0 inet dhcp

# An example static IP setup: (broadcast and gateway are optional)
#
# auto eth0
# iface eth0 inet static
#     address 192.168.0.42
#     network 192.168.0.0
#     netmask 255.255.255.0
#     broadcast 192.168.0.255
#     gateway 192.168.0.1
</screen
></informalexample
> Укажите серверы имён и директивы search в <filename
>/etc/resolv.conf</filename
>: <informalexample
><screen>
# editor /etc/resolv.conf
</screen
></informalexample
> Простой <filename
>/etc/resolv.conf</filename
>: <informalexample
><screen>
search hqdom.local\000
nameserver 10.1.1.36
nameserver 192.168.9.100
</screen
></informalexample
> Укажите имя системы (2 - 63 символа): <informalexample
><screen>
# echo DebianHostName &gt; /etc/hostname
</screen
></informalexample
> Если у вас несколько сетевых карт, то вам нужноразместить имена драйверов в файле <filename
>/etc/modules</filename
> в желаемом порядке. Позже при загрузке каждая карта будет связана с именем интерфейса (eth0, eth1, и тд.) как вы и хотели. </para>
   </sect3>

   <sect3>
   <title
>Настройка часового пояса, пользователей и APT</title>
<para
>Выберите часовой пояс, добавьте обычного пользователя и укажите источники <command
>apt</command
>, запустив <informalexample
><screen
># /usr/sbin/base-config new
</screen
></informalexample>

</para>
   </sect3>

   <sect3>
   <title
>Настройка локалей</title>
<para
>Чтобы использовать язык, отличный от английского, нужно настроить локаль. Для этого установите пакет поддержки локалей и настройте его: <informalexample
><screen>
# apt-get install locales
# dpkg-reconfigure locales
</screen
></informalexample
> ЗАМЕЧАНИЕ: Apt должен быть уже настроен, например, во время фазы base-config. Перед использованием локалей с набором символов, отличным от ASCII или latin1, пожалуйста проконсультируйтесь с нужным HOWTO по локализации. </para>
   </sect3>
  </sect2>

  <sect2>
  <title
>Установка ядра</title>
<para
>Если вы намерены загружать эту систему, то вам скорее всего понадобится ядро Linux и системный загрузчик. Определите доступные пакеты с ядрами при помощи <informalexample
><screen>
# apt-cache search kernel-image
</screen
></informalexample
> Затем установите нужное указав его имя пакета. <informalexample
><screen
># apt-get install kernel-image-<replaceable
>2.X.X-arch-etc</replaceable
>
</screen
></informalexample>

</para>
  </sect2>

  <sect2>
<title
>Установка системного загрузчика</title>
<para
>Чтобы сделать систему &debian; загружаемой, настройте ваш системный загрузчик на загрузку установленного ядра с новым корневым разделом. Заметим, что debootstrap не устанавливает системный загрузчик, хотя вы можете использовать apt-get внутри вашего Debian chroot, чтобы сделать это. </para
><para arch="i386"
>Просмотрите в <userinput
>info grub</userinput
> или <userinput
>man lilo.conf</userinput
> об установке системного загрузчика. Если вы оставляете систему, которую использовали для установки Debian, просто добавьте запись для установленной системы Debian в существующий файл grub <filename
>menu.lst</filename
>или <filename
>lilo.conf</filename
>. Также, вы можете скопировать его в новую систему и отредактировать его там. После того как закончите редактирование, вызовите lilo (помните, что он будет использовать <filename
>lilo.conf</filename
>, относящийся к системе, из которой его вызвали). </para
><para arch="i386"
>Вот простой <filename
>/etc/lilo.conf</filename
> в качестве примера: <informalexample
><screen
>boot=/dev/hda6
root=/dev/hda6
install=/boot/boot-menu.b
delay=20
lba32
image=/vmlinuz
label=Debian
</screen
></informalexample>

</para
><para arch="powerpc"
>Просмотрите <userinput
>man yaboot.conf</userinput
> для инструкций об установке системного загрузчика. Если вы оставляете систему, которую использовали для установки Debian, просто добавьте запись для установленной системы Debian в существующий <filename
>yaboot.conf</filename
>. Также вы можете скопировать его в новую систему и отредактировать его там. После того, как закончите редактирование, вызовите ybin (помните, что он будет использовать <filename
>yaboot.conf</filename
>, относящийся к системе, из которой его вызвали). </para
><para arch="powerpc"
>Вот простой пример <filename
>/etc/yaboot.conf</filename
>: <informalexample
><screen>
boot=/dev/hda2
device=hd:
partition=6
root=/dev/hda6
magicboot=/usr/lib/yaboot/ofboot
timeout=50
image=/vmlinux
label=Debian
</screen
></informalexample
> На некоторых машинах вам возможно понадобится использовать <userinput
>ide0:</userinput
> вместо <userinput
>hd:</userinput
>. </para>
  </sect2>
 </sect1>
<!--   End of file appendix/chroot-install.xml -->

</appendix>
<!--   End of file appendix/random-bits.xml -->
