<!-- retain these comments for translator revision tracking -->
<!-- $Id: mdcfg.xml 22953 2004-10-10 11:26:05Z mck-guest $ -->

   <sect3 id="mdcfg">
   <title>Настройка устройства Multidisk (программный RAID)</title>
<para>Если вы имеете более одного жёсткого диска<footnote><para> Если честно, мы можете собратьMD устройство даже из обычных разделов, расположенных на одном физическом жёстком диске, но это не даст никакой выгоды. </para></footnote> в компьютере, то можно воспользоваться<command>mdcfg</command> чтобыувеличить производительнось дисков и/или повысить надёжность данных. В результате получается, так называемое <firstterm>устройство Multidisk </firstterm> (или следующее более известное название <firstterm>программный RAID</firstterm>). </para><para>Основу MD состовляют группы разделов, расположенных на различных дисках и объединённых вместе в <emphasis>логическое</emphasis> устройство. Это устройство может затем быть использовано как обычный раздел (то есть в <command>partman</command> вы можете отформатировать его, назначить ему точку монтирования и т.д.). </para><para>Получаемые преимущества зависят от типа создаваемого MD устройства. В данный момент поддерживаются: <variablelist> <varlistentry> <term>RAID0</term><listitem><para> Нацелен на производительность. RAID0 разбивает все входящие данные на <firstterm>полосы</firstterm> и распределяет их в равной степени по дискам в массиве. Это может увеличить скорость операций чтения/записи, но если один из из дисков сломается, вы потеряете <emphasis>всё</emphasis> (часть информации всё ещё на исправных диске(ах), другая часть <emphasis>хранилась</emphasis> на сломавшемся диске). </para> <para> Обычно, разделы RAID0 используют для редактирования видео. </para></listitem> </varlistentry> <varlistentry> <term>RAID1</term><listitem><para> Используется там, где надёжность превыше всего. Он состоит из нескольких (обычно двух) одинаковых по размеру разделов, и на каждом разделе будут хранится одинаковые данные. В сущности, это означает три вещи. Первая: если один из дисков ломается, вы не теряете эти данные так как они продублированы на оставшихся дисках. Второе: вы можете использовать только часть доступного объёма (более точно, размер самого маленького раздела в RAID). Третье:, нагрузка при чтении файла сбалансированно распределяется по всем всем дискам, что может повысить производительность сервера, например файлового сервера, на котором операций чтения больше чем операций записи. </para><para> Также, вы можете и меть в массиве запасной диск, который включится в работу в случае неисправности одного из дисков. </para></listitem> </varlistentry> <varlistentry> <term>RAID5</term><listitem><para> Хороший компромис между скоростью, надёжностью и избыточностью. RAID5 разделяет все входящие данные на полосы и распределяет их пропорционально на все кроме одно диски ( как и RAID0). В отличие от RAID0, RAID5 также вычисляет <firstterm>контрольную сумму</firstterm>, которую записывает на оставшийся диск. Диск с контрольной суммой не статичен (тогда это был бы RAID4), а периодически изменяется, так что контрольная сумма распределяется по всем дискам. Когда один из дисков ломается, потерянную часть информации можно вычислить из оставшихся данных и её контрольной суммы. RAID5 должен состоять, как минимум из трёх активных разделов. Также, вы можете и меть в массиве запасной диск, который включится в работу в случае неисправности одного из дисков. </para><para> Как видите, RAID5 имеет немного надёжности от RAID1, но достигает этого с меньшей избыточностью. С другой стороны, он немного медленнее на операциях записи чем RAID0, из-за вычислений информации контрольной суммы. </para></listitem> </varlistentry> </variablelist> Итог: <informaltable> <tgroup cols="5">
<thead>
<row>
  <entry>Тип</entry>
  <entry>Минимум устройств</entry>
  <entry>Запасное устройство</entry>
  <entry>Сохранятся ли данные при отказе диска?</entry>
  <entry>Доступное место</entry>
</row>
</thead>

<tbody>
<row>
  <entry>RAID0</entry>
  <entry>2</entry>
  <entry>нет</entry>
  <entry>нет</entry>
  <entry>Размер самого маленького раздела умноженный на число устройств в RAID</entry>
</row>

<row>
  <entry>RAID1</entry>
  <entry>2</entry>
  <entry>необязательно</entry>
  <entry>да</entry>
  <entry>Размер самого маленького раздела в RAID</entry>
</row>

<row>
  <entry>RAID5</entry>
  <entry>3</entry>
  <entry>необязательно</entry>
  <entry>да</entry>
  <entry>Размер самого маленького раздела умноженный на (число устройств в RAID минус 1) </entry>
</row>

</tbody></tgroup></informaltable>

</para><para>Если вы хотите узнать всю правду о программном RAID, посмотрите<ulink url="&url-software-raid-howto;">Software RAID HOWTO</ulink>. </para><para>Чтобы создать MD устройство, вам нужно пометить желаемые разделы как используемые в RAID. (Это делается в <command>partman</command> из меню <guimenu>Настройки раздела</guimenu>, где вы должны выбрать<menuchoice> <guimenu>Использовать как:</guimenu> <guimenuitem>Использовать разделкак устройство RAID</guimenuitem> </menuchoice>.) </para><warning><para>Поддержка MD в программе установки появилась относительно недавно. У вас могут возникнуть проблемы с некоторыми уровнями RAID и в сочетании с некоторыми системными загрузчиками, если вы пытаетесь использовать MD в качестве корневой файловой системы (<filename>/</filename>). Опытные пользователи, возможно, могут обойти некоторые из этих проблем, выполнив некторую настройку или шаги установки вручную из командной строки. </para></warning><para>Далее, вы должны выбрать <guimenuitem>Настройка программного RAID</guimenuitem> из главного меню в меню <command>partman</command>. На первом экране<command>mdcfg</command> просто выберите <guimenuitem>Создать MD устройство</guimenuitem>. Вам будет предложен список поддерживаемых типов MD устройств, из которого вы должны выбрать один (например, RAID1). Дальнейшие действия зависят от типа выбранного MD. </para>

<itemizedlist>
<listitem><para>RAID0 очень прост &mdash; вас предложат список доступных разделов RAID, авашей задачей будет выбор разделов из которых вы хотите сформировать MD. </para></listitem>
<listitem><para>С RAID1 немного сложнее. Во-первых, вас попросят ввести число активных устройств и число запасных устройств, из которых будет формироваться MD. Далее, вам потребуется выбрать из списка доступных разделов RAID те, которые будут активными и затем, те которые будут запасными. Число выбранных разделов должно быть равно числу, введённому несколькими секундами ранее. Не волнуйтесь. Если вы ошибётесь и выберите неверное число разделов, &d-i; не позволит вам продолжить, пока вы не исправите ошибку. </para></listitem>
<listitem><para>Создание RAID5 напоминает процедуру RAID1 за исключением, того что вам нужно использовать как минимум <emphasis>три</emphasis> активных раздела. </para></listitem>
</itemizedlist>

<para>Отлично сосуществуют несколько типов MD одновременно. Например, если вы имеететри 200ГБ жёстких диска выделенных под MD, каждый из которых разбит на два 100ГБ раздела, вы можете объединить первые разделы трёх дисков в RAID0 (быстрый 300ГБ раздел для редактирования видео) и использовать оставшиеся три раздела (2 активных и 1 запасной) для RAID1 (вполне надёжный 100ГБ раздел для <filename>/home</filename>). </para><para>После настройки MD устройств в соответствии с вашими желаниями, вы можете <guimenuitem>Закончить</guimenuitem> <command>mdcfg</command> и вернуться в <command>partman</command>, чтобы создать файловые системы на новых MD устройствах и назначить им обычные атрибуты типа точек монтирования. </para>
   </sect3>
