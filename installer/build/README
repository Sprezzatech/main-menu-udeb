The files in this directory are used to build the Debian installer.
Basically it consists of downloading udebs, unpacking them, applying some
magic (library reduction etc.) and building an image.

Recipe:
 - Install the build-dependencies on the host system
   (run dpkg-checkbuilddeps in the parent installer/ directory).
 - Create your own sources.list.udeb.local, otherwise the build host's
   sources.list is taken as a template for sources.list.udeb.
 - Run "make" to get a list of available targets.
 - Build an image using one of the build_ targets (build_netboot,
   all_build, etc).
 - Look in dest/ for the completed images.
 
Note that this does not create full debian ISO images; that is left to the
debian-cd package. As a shortcut, you can create a mini-ISO image, with
only the netboot initrd on it. make build_netboot will create a
dest/netboot/mini.iso, using isolinux. Any size initrd can be placed on
this ISO, which may be useful for testing.
 
A more detailed overview of how the installer is built:

* 'sources.list.udeb' is used to configure apt to download udebs from a
  mirror. It is autogenerated based on '/etc/apt/sources.list', by the
   Makefile's 'sources.list.udeb' target. Or you can provide your own
   locally modified 'sources.list.udeb.local'.
* The Makefile is configured via the make fragments in the config
  directory. These are organized in a subarch/medium/flavour hierarchy and
  get included by the main Makefile.
* config/local can be added to override anything set in other fragments
  which are local to your system which you want to avoid accidentially
  committing.
* 'pkg-lists' has subdirectories for the different image types that list
  udebs that are put on each image. The pkg-lists/*/common files list
  udebs common to all architectures, and the files named by architecture
  (<arch>.cfg) list udebs specific to an architecture. It is also possible
  to include udebs only on a specific subarchitecture by creating a
  directory for the architecture and putting config files for the
  subarchitecture there (<arch>/<subarch>.cfg).  All of these files can
  have #include lines to include files from pkg-lists. Also,
  ${kernel:Version} in these files is replaced with the kernel version,
  as set in the KERNELIMAGEVERSION variable (plus the KERNEL_FLAVOUR
  variable).
* Anything listed in pkg-lists/local and pkg-lists/*/local is included in
  the image that is built. This is to provide an easy way to add extra
  udebs to a test image.
* Apt is used to download the required udebs. This does *not* include
  libraries; libraries used by udebs must be installed on the build system,
  and so are build-depended on.
* If you have some udebs that are not available on your mirror yet,
  you can drop them in 'localudebs/' and they will be used. 
  HOWEVER, the current way they are used does not make apt aware of the
  files in localudebs when it is installing other udebs. So if you have
  added a package to localudebs to satisfy a dependency of some other udeb
  that is not in localudebs, apt will still fail during the build. The way
  around this for now is to copy any such udebs into localudebs, then apt
  does not have to worry about installing them and everything will work.
* dpkg is used to unpack the udebs into the build directory.
* A customized set of reduced libraries is generated to correspond to the
  udebs that were installed.
* Some boot images have associated "driver" disks. These disks just get
  udebs put on them.
* The final images are put in the dest/ directory.

------------

Notes on the build/config makefile fragments:

Nowe that most of the structure is in place, making new versions of d-i is
mostly a matter of filling in Makefile variables, and new rules for anything
unusual or new. Here are some guidelines on what you need to fill in.

Top level specifies supported subarches, media or flavours supported with 
SUBARCHES_SUPPORTED, MEDIUM_SUPPORTED, or FLAVOUR SUPPORTED - a list of
subarches, media of flavours - each of which is a subdirectory under <arch>.
The names have no special significance.

A typical 'leaf' .cfg file specifies:
KERNELVERSION
KERNEL_FLAVOUR
KERNELNAME
KERNELIMAGEVERSION
and 
TYPE

TYPE is the thing that specifies which pkg-list files are used. 
e.g. $TYPE=cdrom means that pkg-lists/cdrom/local, pkg-lists/cdrom/common and
pkg-lists/cdrom/<arch> are used.

