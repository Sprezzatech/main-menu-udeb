MEDIUM_SUPPORTED = cdrom netboot

# The version of the kernel to use.
KERNELVERSION = 2.4.25-power4
KERNEL_FLAVOUR = di
KERNELNAME = vmlinux
KERNELIMAGEVERSION = $(KERNELVERSION)

# cd content for powerpc, includes yaboot for booting 
# apple powerpc (newworld) computers
cd_content: initrd
	mkdir -p $(CD_IMAGE_TREE)
	mkdir -p $(CD_IMAGE_TREE)/install/powermac

	$(foreach NAME,$(KERNELNAME), \
		cp -f $(TEMP)/$(NAME) $(CD_IMAGE_TREE)/install/powermac/$(TYPE)-linux; )

	cp -f $(INITRD) $(CD_IMAGE_TREE)/install/powermac

	# New-world bootability
	cp -f boot/powerpc/ofboot.b $(CD_IMAGE_TREE)/install/powermac
	cp -f /usr/lib/yaboot/yaboot $(CD_IMAGE_TREE)/install/powermac
	./bootscreen-subst "${MEDIA_TYPE}" "${DEBIAN_VERSION}" "${BUILD_DATE}" \
		< boot/powerpc/boot.msg > $(CD_IMAGE_TREE)/install/powermac/boot.msg
	cp -f boot/powerpc/$(TYPE)-yaboot.conf $(CD_IMAGE_TREE)/install/powermac/yaboot.conf

# creates a bootable cd image for powerpc
cd_image: cd_content
	mkisofs -r -T --netatalk -hfs -probe -map boot/powerpc/hfs.map -part -no-desktop -hfs-bless $(CD_IMAGE_TREE)/install/powermac -hfs-volid Debian-Installer/PPC -o $(DEST)/$(TYPE).iso $(CD_IMAGE_TREE)

arch_boot_screens:

arch_boot: arch_boot_initrd

