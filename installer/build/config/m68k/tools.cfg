#
# Populate the tools directory
#

MANIFEST-ATARI-BOOTARGS = "m68k atari bootstrap settings"
MANIFEST-ATARI-BOOTSTRA = "m68k atari bootstrap program"
MANIFEST-ATARI-RAWWRITE = "m68k atari floppy writing program"

MANIFEST-AMIGA-BOOT =     "m68k amiga bootstrap support programs"
MANIFEST-AMIGA-AMIBOOT =  "m68k amiga bootstrap program"

MANIFEST-MAC-PENGUIN =    "m68k mac bootstrap from MacOS"
MANIFEST-MAC-PENGHFS =    "m68k mac bootstrap from MacOS on floppy"

#
# atari tools
#

$(TEMP)/bootstra.prg: /usr/share/atari-bootstrap/ataboot.ttp.gz
	gzip -cd $< > $@

$(SOME_DEST)/tools/atari/bootstra.prg: $(TEMP)/bootstra.prg
	install -m 644 -D $< $@
	update-manifest $@ $(MANIFEST-ATARI-BOOTSTRA)

$(SOME_DEST)/tools/atari/bootargs: boot/m68k/atari-bootargs-cdrom 
	# fix kernel in bootargs
	#sed -e "s,linux,`basename $(TEMP_KERNEL)`," $< > $(TEMP)/bootargs
	#install -m 644 -D $(TEMP)/bootargs $@
	install -m 644 -D $< $@
	update-manifest $@ $(MANIFEST-ATARI-BOOTARGS)

$(SOME_DEST)/tools/atari/rawwrite.ttp: /usr/share/atari-bootstrap/rawwrite.ttp.gz 
	gzip -cd $< > $@
	update-manifest $@ $(MANIFEST-ATARI-RAWWRITE)

ATARITOOLS = $(SOME_DEST)/tools/atari/bootstra.prg $(SOME_DEST)/tools/atari/bootargs $(SOME_DEST)/tools/atari/rawwrite.ttp

#
# amiga tools
#

# get the directory of scripts, amiga.info is a directory icon, so 
# copy it up one for the amiga directory and two for the tools directory.
$(SOME_DEST)/tools/amiga/StartInstall: boot/m68k/amiga/StartInstall
	install -m 644 -D $< $@
	cp boot/m68k/amiga/* $(SOME_DEST)/tools/amiga
	chmod 644 $(SOME_DEST)/tools/amiga/*
	mv $(SOME_DEST)/tools/amiga/amiga.info $(SOME_DEST)/tools
	cp $(SOME_DEST)/tools/amiga.info $(SOME_DEST)/tools.info
	update-manifest tools/amiga $(MANIFEST-AMIGA-BOOT)

AMIGATOOLS = $(SOME_DEST)/tools/amiga/StartInstall 

# support for the future amiboot package
ifeq (0,$(shell test -f /usr/share/amiboot/amiboot.gz && echo 0))
$(TEMP)/amiboot: /usr/share/amiboot/amiboot.gz
	gzip -cd $< > $@

$(SOME_DEST)/tools/amiga/amiboot: $(TEMP)/amiboot
	install -m 755 -D $< $@
	update-manifest $@ $(MANIFEST-AMIGA-AMIBOOT)

AMIGATOOLS += $(SOME_DEST)/tools/amiga/amiboot
endif

#
# mac tools
#

# support for the future penguin package
ifeq (0,$(shell test -d /usr/share/penguin && echo 0))
$(SOME_DEST)/tools/mac/penguin.hfs: /usr/share/penguin/penguin.hfs
	install -m 644 -D $< $@
	update-manifest $@ $(MANIFEST-MAC-PENGHFS)

$(SOME_DEST)/tools/mac/Penguin-19.hqx: /usr/share/penguin/Penguin-19.hqx /usr/share/penguin/Penguin\ Colors.hqx
	install -m 644 -D $^ $@
	update-manifest $@ $(MANIFEST-MAC-PENGUIN)

MACTOOLS += $(SOME_DEST)/tools/mac/penguin.hfs $(SOME_DEST)/tools/mac/Penguin-19.hqx
endif


TOOLS = $(ATARITOOLS ) $(AMIGATOOLS) $(MACTOOLS)

