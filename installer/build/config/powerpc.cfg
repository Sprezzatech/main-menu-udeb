SUBARCH_SUPPORTED = powerpc power3 power4 powerpc-small apus

KERNELMAJOR = 2.4

EXTRALIBS = /lib/libnss_dns* /lib/libresolv*

# create the kernels with builtin initrd.
arch_boot_initrd:
	if [ ! -d $(TEMP_POWERPC_INITRD) ]; then	 \
		mkdir $(TEMP_POWERPC_INITRD);		\
	fi
	powerpc-builtin-initrd.sh	\
		$(TEMP_KERNEL)		\
		$(TEMP)/System.map	\
		$(TEMP_INITRD)		\
		$(TEMP_POWERPC_INITRD)	\
		$(DEST)			\
		$(KERNELIMAGEVERSION)	\
		$(POWERPCIMAGETYPES)

# cd content for powerpc, includes yaboot for booting 
# apple powerpc (newworld) computers
cd_content_common:
	mkdir -p $(TEMP_CD_TREE)
	mkdir -p $(TEMP_CD_TREE)/install/powermac

	cp $(TEMP_KERNEL) $(TEMP_CD_TREE)/install/powermac/$(TYPE)-linux
	ln -f $(TEMP_INITRD) $(TEMP_CD_TREE)/install/powermac/$(TYPE)-initrd.gz

	# New-world bootability
	cp -f boot/powerpc/ofboot.b $(TEMP_CD_TREE)/install/powermac
	cp -f /usr/lib/yaboot/yaboot $(TEMP_CD_TREE)/install/powermac
	./bootscreen-subst "${MEDIA_TYPE}" "${DEBIAN_VERSION}" "${BUILD_DATE}" \
		< boot/powerpc/boot.msg > $(TEMP_CD_TREE)/install/powermac/boot.msg
	./ramdisk-size-subst $(TEMP_INITRD) \
		< boot/powerpc/$(TYPE)-yaboot.conf > $(TEMP_CD_TREE)/install/powermac/yaboot.conf

# creates a bootable cd image for powerpc
arch_miniiso_common: cd_content_common
	mkisofs -r -T --netatalk -hfs -probe -map boot/powerpc/hfs.map -part -no-desktop -hfs-bless $(TEMP_CD_TREE)/install/powermac -hfs-volid Debian-Installer/PPC -o $(TEMP_MINIISO) $(TEMP_CD_TREE)
