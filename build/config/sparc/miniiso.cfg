KERNELIMAGEVERSION = 2.4.24-sparc32 2.4.24-sparc64
KERNEL_FLAVOUR = di
KERNELVERSION = $(foreach ver,${KERNELIMAGEVERSION},$(ver))
KERNELNAME = $(foreach ver,${KERNELVERSION},vmlinuz-$(ver))
 
MEDIA_TYPE = CD-ROM
 
TYPE = netboot

TARGET = $(TEMP_BOOT) $(MINIISO)
EXTRANAME = cdrom-
 
MANIFEST-MINIISO = "tiny bootable CD image for pure network install"
 
.PHONY: arch_miniiso arch_boot_screens arch_boot
arch_miniiso:
	-rm -rf $(TEMP_CD_TREE)/*
	install -m 644 -D $(BASE_TMP)miniiso/initrd.gz $(TEMP_CD_TREE)/boot/initrd.gz
	install -m 644 -D $(BASE_TMP)miniiso/vmlinuz*32 $(TEMP_CD_TREE)/boot/vmlinuz-sparc32
	install -m 644 -D $(BASE_TMP)miniiso/vmlinuz*64 $(TEMP_CD_TREE)/boot/vmlinuz-sparc64
	install -m 644 /boot/isofs.b $(TEMP_CD_TREE)/boot
	install -m 644 /boot/second.b $(TEMP_CD_TREE)/boot
	install -m 644 $(TEMP_BOOT_SCREENS)/debian.txt $(TEMP_CD_TREE)/boot
	install -m 644 boot/sparc/silo.conf $(TEMP_CD_TREE)/boot
 
	mkisofs -r -J -o $(TEMP_MINIISO) -G $(TEMP_CD_TREE)/boot/isofs.b -B ... $(TEMP_CD_TREE)

arch_boot_screens:
	-rm -f $(TEMP_BOOT_SCREENS)/*
	mkdir -p $(TEMP_BOOT_SCREENS)
	cat boot/sparc/debian.txt | ./bootscreen-subst "$(MEDIA_TYPE)" "$(DEBIAN_VERSION)" "$(BUILD_DATE)" > $(TEMP_BOOT_SCREENS)/debian.txt

arch_boot:
