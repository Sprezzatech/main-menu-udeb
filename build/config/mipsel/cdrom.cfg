MEDIUM_SUPPORTED = cdrom

# The version of the kernel to use.
# FIXME:
# linux-kernel-di does not yet generate uniquely named kernel files.
#KERNELVERSION = 2.4.19-r3k-kn02 2.4.19-r4k-kn04
KERNELVERSION = 2.4.19-r4k-kn04
KERNEL_FLAVOUR = di
KERNELIMAGEVERSION = $(KERNELVERSION)
#KERNELNAME = $(foreach ver,$(KERNELVERSION),vmlinux-$(ver))
KERNELNAME = vmlinux

MEDIA_TYPE = CD-ROM

# No files in DEST.
TARGET = $(INITRD) $(KERNEL)

MANIFEST-KERNEL = "kernel for use with delo to build a CD"
MANIFEST-INITRD = "initrd for use with delo to build a CD"
MANIFEST-MINIISO = "mini CD image for test purposes"

.PHONY: arch_miniiso
arch_miniiso:
	-rm -f $(TEMP_CD_TREE)/*
	install -m 644 -D /boot/delo.2nd $(TEMP_CD_TREE)/boot/delo.2nd
	install -d $(TEMP_CD_TREE)/boot $(TEMP_CD_TREE)/etc
	install -m 644 $(TEMP_INITRD) $(TEMP_KERNEL) $(TEMP_CD_TREE)/boot
	install -m 644 boot/mips/delo.conf $(TEMP_CD_TREE)/etc
	mkisofs -r -J -o $(TEMP_MINIISO) $(TEMP_CD_TREE)
	delo -r $(TEMP_CD_TREE) -d
